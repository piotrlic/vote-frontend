!function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)t.d(r,i,function(t){return e[t]}.bind(null,i));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s="Pq/i")}({"4Mou":function(e,t,n){"use strict";function r(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function i(){return i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i.apply(this,arguments)}function s(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}function o(e,...t){Wt.logLevel<=Ut.a.ERROR&&Wt.error(`Auth (${Ft.SDK_VERSION}): ${e}`,...t)}function a(e,...t){throw h(e,...t)}function c(e,...t){return h(e,...t)}function u(e,t,n){const r=i(i({},Kt()),{[t]:n});return new jt.b("auth","Firebase",r).create(t,{appName:e.name})}function l(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&a(e,"argument-error"),u(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function h(e,...t){if("string"!=typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return $t.create(e,...t)}function d(e,t,...n){if(!e)throw h(t,...n)}function f(e){const t="INTERNAL ASSERTION FAILED: "+e;throw o(t),new Error(t)}function p(e,t){e||f(t)}function g(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function m(){return"http:"===_()||"https:"===_()}function _(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function y(e,t){p(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}function v(e,t){return e.tenantId&&!t.tenantId?i(i({},t),{tenantId:e.tenantId}):t}async function w(e,t,n,r,s={}){return b(e,s,(async()=>{let s={},o={};r&&("GET"===t?o=r:s={body:JSON.stringify(r)});const a=Object(jt.Q)(i({key:e.config.apiKey},o)).slice(1),c=await e._getAdditionalHeaders();return c["Content-Type"]="application/json",e.languageCode&&(c["X-Firebase-Locale"]=e.languageCode),Ht.fetch()(T(e,e.config.apiHost,n,a),i({method:t,headers:c,referrerPolicy:"no-referrer"},s))}))}async function b(e,t,n){e._canInitEmulator=!1;const r=i(i({},Qt),t);try{const t=new Xt(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw E(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw E(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw E(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw E(e,"user-disabled",s);const c=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw u(e,c,o);a(e,c)}}catch(t){if(t instanceof jt.c)throw t;a(e,"network-request-failed",{message:String(t)})}}async function I(e,t,n,r,i={}){const s=await w(e,t,n,r,i);return"mfaPendingCredential"in s&&a(e,"multi-factor-auth-required",{_serverResponse:s}),s}function T(e,t,n,r){const i=`${t}${n}?${r}`;return e.config.emulator?y(e.config,i):`${e.config.apiScheme}://${i}`}function E(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=c(e,t,r);return i.customData._tokenResponse=n,i}function k(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function C(e){return 1e3*Number(e)}function S(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return o("JWT malformed, contained fewer than 3 sections"),null;try{const e=Object(jt.i)(n);return e?JSON.parse(e):(o("Failed to decode base64 JWT payload"),null)}catch(e){return o("Caught error parsing JWT payload as JSON",null==e?void 0:e.toString()),null}}async function O(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof jt.c&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}async function A(e){var t;const n=e.auth,s=await e.getIdToken(),o=await O(e,async function(e,t){return w(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:s}));d(null==o?void 0:o.users.length,n,"internal-error");const a=o.users[0];e._notifyReloadListener(a);const c=(null===(t=a.providerUserInfo)||void 0===t?void 0:t.length)?a.providerUserInfo.map((e=>{var{providerId:t}=e,n=r(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[];const u=(l=c,[...e.providerData.filter((e=>!l.some((t=>t.providerId===e.providerId)))),...l]);var l;const h=!!e.isAnonymous&&!(e.email&&a.passwordHash||(null==u?void 0:u.length));i(e,{uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:u,metadata:new Zt(a.createdAt,a.lastLoginAt),isAnonymous:h})}function N(e,t){d("string"==typeof e||void 0===e,"internal-error",{appName:t})}function P(e){p(e instanceof Function,"Expected a class definition");let t=nn.get(e);return t?(p(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,nn.set(e,t),t)}function R(e,t,n){return`firebase:${e}:${t}:${n}`}function D(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(j(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(x(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(U(t))return"Blackberry";if(V(t))return"Webos";if(M(t))return"Safari";if((t.includes("chrome/")||L(t))&&!t.includes("edge/"))return"Chrome";if(F(t))return"Android";{const t=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===(null==t?void 0:t.length))return t[1]}return"Other"}function x(e=Object(jt.A)()){return/firefox\//i.test(e)}function M(e=Object(jt.A)()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function L(e=Object(jt.A)()){return/crios\//i.test(e)}function j(e=Object(jt.A)()){return/iemobile/i.test(e)}function F(e=Object(jt.A)()){return/android/i.test(e)}function U(e=Object(jt.A)()){return/blackberry/i.test(e)}function V(e=Object(jt.A)()){return/webos/i.test(e)}function q(e=Object(jt.A)()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function B(e=Object(jt.A)()){return q(e)||F(e)||V(e)||U(e)||/windows phone/i.test(e)||j(e)}function z(e,t=[]){let n;switch(e){case"Browser":n=D(Object(jt.A)());break;case"Worker":n=`${D(Object(jt.A)())}-${e}`;break;default:n=e}const r=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ft.SDK_VERSION}/${r}`}async function K(e,t){return w(e,"GET","/v2/recaptchaConfig",v(e,t))}function $(e){return void 0!==e&&void 0!==e.getResponse}function W(e){return void 0!==e&&void 0!==e.enterprise}function G(e){return new Promise(((t,n)=>{const r=document.createElement("script");var i,s;r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=c("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",(null!==(s=null===(i=document.getElementsByTagName("head"))||void 0===i?void 0:i[0])&&void 0!==s?s:document).appendChild(r)}))}function H(e){return`__${e}${Math.floor(1e6*Math.random())}`}async function Q(e,t,n,r=!1){const s=new cn(e);let o;try{o=await s.verify(n)}catch(e){o=await s.verify(n,!0)}const a=i({},t);return i(a,r?{captchaResp:o}:{captchaResponse:o}),i(a,{clientType:"CLIENT_TYPE_WEB"}),i(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}function Y(e){return Object(jt.z)(e)}function X(e,t,n){const r=Y(e);d(r._canInitEmulator,r,"emulator-config-failed"),d(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null==n?void 0:n.disableWarnings),s=J(t),{host:o,port:a}=function(e){const t=J(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:Z(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:Z(t)}}}(t);r.config.emulator={url:`${s}//${o}${null===a?"":`:${a}`}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function J(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Z(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}async function ee(e,t){return w(e,"POST","/v1/accounts:resetPassword",v(e,t))}async function te(e,t){return w(e,"POST","/v1/accounts:update",t)}async function ne(e,t){return I(e,"POST","/v1/accounts:signInWithPassword",v(e,t))}async function re(e,t){return w(e,"POST","/v1/accounts:sendOobCode",v(e,t))}async function ie(e,t){return re(e,t)}async function se(e,t){return re(e,t)}async function oe(e,t){return I(e,"POST","/v1/accounts:signInWithIdp",v(e,t))}async function ae(e,t){return I(e,"POST","/v1/accounts:signUp",v(e,t))}function ce(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}async function ue(e){var t;const n=Y(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new On({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await ae(n,{returnSecureToken:!0}),i=await On._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(i.user),i}function le(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw An._fromErrorAndOperation(e,n,t,r);throw n}))}function he(e){return new Set(e.map((({providerId:e})=>e)).filter((e=>!!e)))}async function de(e,t){const n=Object(jt.z)(e);await pe(!0,n,t);const{providerUserInfo:r}=await async function(e,t){return w(e,"POST","/v1/accounts:update",t)}(n.auth,{idToken:await n.getIdToken(),deleteProvider:[t]}),i=he(r||[]);return n.providerData=n.providerData.filter((e=>i.has(e.providerId))),i.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function fe(e,t,n=!1){const r=await O(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return On._forOperation(e,"link",r)}async function pe(e,t,n){await A(t);const r=!1===e?"provider-already-linked":"no-such-provider";d(he(t.providerData).has(n)===e,t.auth,r)}async function ge(e,t,n=!1){const{auth:r}=e,i="reauthenticate";try{const s=await O(e,le(r,i,t,e),n);d(s.idToken,r,"internal-error");const o=S(s.idToken);d(o,r,"internal-error");const{sub:a}=o;return d(e.uid===a,r,"user-mismatch"),On._forOperation(e,i,s)}catch(e){throw"auth/user-not-found"===(null==e?void 0:e.code)&&a(r,"user-mismatch"),e}}async function me(e,t,n=!1){const r="signIn",i=await le(e,r,t),s=await On._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}async function _e(e,t){return me(Y(e),t)}async function ye(e,t){const n=Object(jt.z)(e);return await pe(!1,n,t.providerId),fe(n,t)}async function ve(e,t){return ge(Object(jt.z)(e),t)}async function we(e,t){const n=Y(e),r=await async function(e,t){return I(e,"POST","/v1/accounts:signInWithCustomToken",v(e,t))}(n,{token:t,returnSecureToken:!0}),i=await On._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(i.user),i}function be(e,t,n){var r;d((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),d(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(d(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(d(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}async function Ie(e,t,n){var r;const i=Y(e),s={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};if(null===(r=i._getRecaptchaConfig())||void 0===r?void 0:r.emailPasswordEnabled){const e=await Q(i,s,"getOobCode",!0);n&&be(i,e,n),await ie(i,e)}else n&&be(i,s,n),await ie(i,s).catch((async e=>{if("auth/missing-recaptcha-token"!==e.code)return Promise.reject(e);{console.log("Password resets are protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the password reset flow.");const e=await Q(i,s,"getOobCode",!0);n&&be(i,e,n),await ie(i,e)}}))}async function Te(e,t,n){await ee(Object(jt.z)(e),{oobCode:t,newPassword:n})}async function Ee(e,t){await async function(e,t){return w(e,"POST","/v1/accounts:update",v(e,t))}(Object(jt.z)(e),{oobCode:t})}async function ke(e,t){const n=Object(jt.z)(e),r=await ee(n,{oobCode:t}),i=r.requestType;switch(d(i,n,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":d(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":d(r.mfaInfo,n,"internal-error");default:d(r.email,n,"internal-error")}let s=null;return r.mfaInfo&&(s=Nn._fromServerResponse(Y(n),r.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.newEmail:r.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}async function Ce(e,t){const{data:n}=await ke(Object(jt.z)(e),t);return n.email}async function Se(e,t,n){var r;const i=Y(e),s={returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"};let o;if(null===(r=i._getRecaptchaConfig())||void 0===r?void 0:r.emailPasswordEnabled){const e=await Q(i,s,"signUpPassword");o=ae(i,e)}else o=ae(i,s).catch((async e=>{if("auth/missing-recaptcha-token"===e.code){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");const e=await Q(i,s,"signUpPassword");return ae(i,e)}return Promise.reject(e)}));const a=await o.catch((e=>Promise.reject(e))),c=await On._fromIdTokenResponse(i,"signIn",a);return await i._updateCurrentUser(c.user),c}function Oe(e,t,n){return _e(Object(jt.z)(e),yn.credential(t,n))}async function Ae(e,t,n){function r(e,t){d(t.handleCodeInApp,s,"argument-error"),t&&be(s,e,t)}var i;const s=Y(e),o={requestType:"EMAIL_SIGNIN",email:t,clientType:"CLIENT_TYPE_WEB"};if(null===(i=s._getRecaptchaConfig())||void 0===i?void 0:i.emailPasswordEnabled){const e=await Q(s,o,"getOobCode",!0);r(e,n),await se(s,e)}else r(o,n),await se(s,o).catch((async e=>{if("auth/missing-recaptcha-token"!==e.code)return Promise.reject(e);{console.log("Email link sign-in is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const e=await Q(s,o,"getOobCode",!0);r(e,n),await se(s,e)}}))}function Ne(e,t){const n=_n.parseLink(t);return"EMAIL_SIGNIN"===(null==n?void 0:n.operation)}async function Pe(e,t,n){const r=Object(jt.z)(e),i=yn.credentialWithLink(t,n||g());return d(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),_e(r,i)}async function Re(e,t){const n={identifier:t,continueUri:m()?g():"http://localhost"},{signinMethods:r}=await async function(e,t){return w(e,"POST","/v1/accounts:createAuthUri",v(e,t))}(Object(jt.z)(e),n);return r||[]}async function De(e,t){const n=Object(jt.z)(e),r={requestType:"VERIFY_EMAIL",idToken:await e.getIdToken()};t&&be(n.auth,r,t);const{email:i}=await async function(e,t){return re(e,t)}(n.auth,r);i!==e.email&&await e.reload()}async function xe(e,t,n){const r=Object(jt.z)(e),i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await e.getIdToken(),newEmail:t};n&&be(r.auth,i,n);const{email:s}=await async function(e,t){return re(e,t)}(r.auth,i);s!==e.email&&await e.reload()}async function Me(e,{displayName:t,photoURL:n}){if(void 0===t&&void 0===n)return;const r=Object(jt.z)(e),i={idToken:await r.getIdToken(),displayName:t,photoUrl:n,returnSecureToken:!0},s=await O(r,async function(e,t){return w(e,"POST","/v1/accounts:update",t)}(r.auth,i));r.displayName=s.displayName||null,r.photoURL=s.photoUrl||null;const o=r.providerData.find((({providerId:e})=>"password"===e));o&&(o.displayName=r.displayName,o.photoURL=r.photoURL),await r._updateTokensIfNecessary(s)}function Le(e,t){return Fe(Object(jt.z)(e),t,null)}function je(e,t){return Fe(Object(jt.z)(e),null,t)}async function Fe(e,t,n){const{auth:r}=e,i={idToken:await e.getIdToken(),returnSecureToken:!0};t&&(i.email=t),n&&(i.password=n);const s=await O(e,te(r,i));await e._updateTokensIfNecessary(s,!0)}function Ue(e){const{user:t,_tokenResponse:n}=e;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:function(e){var t,n;if(!e)return null;const{providerId:r}=e,i=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},s=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!r&&(null==e?void 0:e.idToken)){const r=null===(n=null===(t=S(e.idToken))||void 0===t?void 0:t.firebase)||void 0===n?void 0:n.sign_in_provider;if(r)return new Dn(s,"anonymous"!==r&&"custom"!==r?r:null)}if(!r)return null;switch(r){case"facebook.com":return new Mn(s,i);case"github.com":return new Ln(s,i);case"google.com":return new jn(s,i);case"twitter.com":return new Fn(s,i,e.screenName||null);case"custom":case"anonymous":return new Dn(s,null);default:return new Dn(s,r,i)}}(n)}function Ve(e,t){var n;const r=Object(jt.z)(e),i=t;return d(t.customData.operationType,r,"argument-error"),d(null===(n=i.customData._serverResponse)||void 0===n?void 0:n.mfaPendingCredential,r,"argument-error"),Vn._fromError(r,i)}function qe(e){const t=Object(jt.z)(e);return Bn.has(t)||Bn.set(t,qn._fromUser(t)),Bn.get(t)}function Be(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}function ze(){return window}function Ke(){return void 0!==ze().WorkerGlobalScope&&"function"==typeof ze().importScripts}function $e(e,t){return e.transaction([Jn],t?"readwrite":"readonly").objectStore(Jn)}function We(){const e=indexedDB.open(Xn,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(Jn,{keyPath:Zn})}catch(e){n(e)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(Jn)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Xn);return new er(e).toPromise()}(),t(await We()))}))}))}async function Ge(e,t,n){const r=$e(e,!0).put({[Zn]:t,value:n});return new er(r).toPromise()}function He(e,t){const n=$e(e,!0).delete(t);return new er(n).toPromise()}async function Qe(e,t,n){const r=Y(e),i=await Je(r,t,Object(jt.z)(n));return new fr(i,(e=>_e(r,e)))}async function Ye(e,t,n){const r=Object(jt.z)(e);await pe(!1,r,"phone");const i=await Je(r.auth,t,Object(jt.z)(n));return new fr(i,(e=>ye(r,e)))}async function Xe(e,t,n){const r=Object(jt.z)(e),i=await Je(r.auth,t,Object(jt.z)(n));return new fr(i,(e=>ve(r,e)))}async function Je(e,t,n){var r;const i=await n.verify();try{let s;if(d("string"==typeof i,e,"argument-error"),d(n.type===lr,e,"argument-error"),s="string"==typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){d("enroll"===t.type,e,"internal-error");const n=await function(e,t){return w(e,"POST","/v2/accounts/mfaEnrollment:start",v(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}});return n.phoneSessionInfo.sessionInfo}{d("signin"===t.type,e,"internal-error");const n=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;d(n,e,"missing-multi-factor-info");const o=await function(e,t){return w(e,"POST","/v2/accounts/mfaSignIn:start",v(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return w(e,"POST","/v1/accounts:sendVerificationCode",v(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:i});return t}}finally{n._reset()}}async function Ze(e,t){await fe(Object(jt.z)(e),t)}function et(e,t){return t?P(t):(d(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}function tt(e){return me(e.auth,new gr(e),e.bypassAuthState)}function nt(e){const{auth:t,user:n}=e;return d(n,t,"internal-error"),ge(n,new gr(e),e.bypassAuthState)}async function rt(e){const{auth:t,user:n}=e;return d(n,t,"internal-error"),fe(n,new gr(e),e.bypassAuthState)}async function it(e,t,n){const r=Y(e);l(e,t,vn);const i=et(r,n);return new yr(r,"signInViaPopup",t,i).executeNotNull()}async function st(e,t,n){const r=Object(jt.z)(e);l(r.auth,t,vn);const i=et(r.auth,n);return new yr(r.auth,"reauthViaPopup",t,i,r).executeNotNull()}async function ot(e,t,n){const r=Object(jt.z)(e);l(r.auth,t,vn);const i=et(r.auth,n);return new yr(r.auth,"linkViaPopup",t,i,r).executeNotNull()}async function at(e,t){return ut(e)._set(lt(t),"true")}function ct(e,t){wr.set(e._key(),t)}function ut(e){return P(e._redirectPersistence)}function lt(e){return R(vr,e.config.apiKey,e.name)}function ht(e,t,n){return async function(e,t,n){const r=Y(e);l(e,t,vn),await r._initializationPromise;const i=et(r,n);return await at(i,r),i._openRedirect(r,t,"signInViaRedirect")}(e,t,n)}function dt(e,t,n){return async function(e,t,n){const r=Object(jt.z)(e);l(r.auth,t,vn),await r.auth._initializationPromise;const i=et(r.auth,n);await at(i,r.auth);const s=await mt(r);return i._openRedirect(r.auth,t,"reauthViaRedirect",s)}(e,t,n)}function ft(e,t,n){return async function(e,t,n){const r=Object(jt.z)(e);l(r.auth,t,vn),await r.auth._initializationPromise;const i=et(r.auth,n);await pe(!1,r,t.providerId),await at(i,r.auth);const s=await mt(r);return i._openRedirect(r.auth,t,"linkViaRedirect",s)}(e,t,n)}async function pt(e,t){return await Y(e)._initializationPromise,gt(e,t,!1)}async function gt(e,t,n=!1){const r=Y(e),i=et(r,t),s=new br(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}async function mt(e){const t=Be(`${e.uid}:::`);return e._redirectEventId=t,await e.auth._setRedirectUser(e),await e.auth._persistUserIfCurrent(e),t}function _t(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function yt({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}async function vt(e,t={}){return w(e,"GET","/v1/projects",t)}function wt(e){const t=g(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!Er.test(n))return!1;if(Tr.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}function bt(){const e=ze().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}function It(e){return Cr=Cr||function(e){return new Promise(((t,n)=>{function r(){bt(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{bt(),n(c(e,"network-request-failed"))},timeout:kr.get()})}var i,s,o;if(null===(s=null===(i=ze().gapi)||void 0===i?void 0:i.iframes)||void 0===s?void 0:s.Iframe)t(gapi.iframes.getContext());else{if(!(null===(o=ze().gapi)||void 0===o?void 0:o.load)){const t=H("iframefcb");return ze()[t]=()=>{gapi.load?r():n(c(e,"network-request-failed"))},G(`https://apis.google.com/js/api.js?onload=${t}`).catch((e=>n(e)))}r()}})).catch((e=>{throw Cr=null,e}))}(e),Cr}function Tt(e){const t=e.config;d(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?y(t,Ar):`https://${e.config.authDomain}/${Or}`,r={apiKey:t.apiKey,appName:e.name,v:Ft.SDK_VERSION},i=Pr.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Object(jt.Q)(r).slice(1)}`}function Et(e,t,n,r=500,s=600){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u=i(i({},Rr),{width:r.toString(),height:s.toString(),top:o,left:a}),l=Object(jt.A)().toLowerCase();n&&(c=L(l)?"_blank":n),x(l)&&(t=t||"http://localhost",u.scrollbars="yes");const h=Object.entries(u).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(function(e=Object(jt.A)()){var t;return q(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(l)&&"_self"!==c)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",c),new Dr(null);const f=window.open(t||"",c,h);d(f,e,"popup-blocked");try{f.focus()}catch(e){}return new Dr(f)}async function kt(e,t,n,r,i,s){d(e.config.authDomain,e,"auth-domain-config-required"),d(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Ft.SDK_VERSION,eventId:i};if(t instanceof vn){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",Object(jt.E)(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof wn){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const e of Object.keys(a))void 0===a[e]&&delete a[e];const c=await e._getAppCheckToken(),u=c?`#${Lr}=${encodeURIComponent(c)}`:"";return`${function({config:e}){if(!e.emulator)return`https://${e.authDomain}/${xr}`;return y(e,Mr)}(e)}?${Object(jt.Q)(a).slice(1)}${u}`}function Ct(){return window}async function St(e,t,n){var r;const{BuildInfo:i}=Ct();p(t.sessionId,"AuthEvent did not contain a session ID");const s=await async function(e){const t=function(e){if(p(/[0-9a-zA-Z]+/.test(e),"Can only convert alpha-numeric strings"),"undefined"!=typeof TextEncoder)return(new TextEncoder).encode(e);const t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let t=0;t<e.length;t++)n[t]=e.charCodeAt(t);return n}(e),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map((e=>e.toString(16).padStart(2,"0"))).join("")}(t.sessionId),o={};return q()?o.ibi=i.packageName:F()?o.apn=i.packageName:a(e,"operation-not-supported-in-this-environment"),i.displayName&&(o.appDisplayName=i.displayName),o.sessionId=s,kt(e,n,t.type,void 0,null!==(r=t.eventId)&&void 0!==r?r:void 0,o)}function Ot(e){const{cordova:t}=Ct();return new Promise((n=>{t.plugins.browsertab.isAvailable((r=>{let i=null;r?t.plugins.browsertab.openUrl(e):i=t.InAppBrowser.open(e,function(e=Object(jt.A)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(e)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(e)}()?"_blank":"_system","location=yes"),n(i)}))}))}async function At(e){const t=await Rt()._get(Dt(e));return t&&await Rt()._remove(Dt(e)),t}function Nt(e,t){var n,r;const i=function(e){const t=xt(e),n=t.link?decodeURIComponent(t.link):void 0,r=xt(n).link,i=t.deep_link_id?decodeURIComponent(t.deep_link_id):void 0;return xt(i).link||i||r||n||e}(t);if(i.includes("/__/auth/callback")){const t=xt(i),s=t.firebaseError?function(e){try{return JSON.parse(e)}catch(e){return null}}(decodeURIComponent(t.firebaseError)):null,o=null===(r=null===(n=null==s?void 0:s.code)||void 0===n?void 0:n.split("auth/"))||void 0===r?void 0:r[1],a=o?c(o):null;return a?{type:e.type,eventId:e.eventId,tenantId:e.tenantId,error:a,urlResponse:null,sessionId:null,postBody:null}:{type:e.type,eventId:e.eventId,tenantId:e.tenantId,sessionId:e.sessionId,urlResponse:i,postBody:null}}return null}function Pt(){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<Wr;n++){const n=Math.floor(62*Math.random());e.push(t.charAt(n))}return e.join("")}function Rt(){return P(Wn)}function Dt(e){return R("authEvent",e.config.apiKey,e.name)}function xt(e){if(!(null==e?void 0:e.includes("?")))return{};const[t,...n]=e.split("?");return Object(jt.R)(n.join("?"))}function Mt(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:c("no-auth-event")}}function Lt(e,t){Y(e)._logFramework(t)}n.d(t,"a",(function(){return Bt})),n.d(t,"b",(function(){return dn})),n.d(t,"c",(function(){return yn})),n.d(t,"d",(function(){return In})),n.d(t,"e",(function(){return En})),n.d(t,"f",(function(){return Tn})),n.d(t,"g",(function(){return pn})),n.d(t,"h",(function(){return bn})),n.d(t,"i",(function(){return pr})),n.d(t,"j",(function(){return qr})),n.d(t,"k",(function(){return qt})),n.d(t,"l",(function(){return dr})),n.d(t,"m",(function(){return kn})),n.d(t,"n",(function(){return Cn})),n.d(t,"o",(function(){return Sn})),n.d(t,"p",(function(){return d})),n.d(t,"q",(function(){return Y})),n.d(t,"r",(function(){return a})),n.d(t,"s",(function(){return Be})),n.d(t,"t",(function(){return P})),n.d(t,"u",(function(){return gt})),n.d(t,"v",(function(){return ct})),n.d(t,"w",(function(){return R})),n.d(t,"y",(function(){return Ee})),n.d(t,"z",(function(){return Wn})),n.d(t,"A",(function(){return Fr})),n.d(t,"B",(function(){return Hn})),n.d(t,"C",(function(){return ke})),n.d(t,"D",(function(){return Te})),n.d(t,"E",(function(){return X})),n.d(t,"G",(function(){return Se})),n.d(t,"H",(function(){return zt})),n.d(t,"I",(function(){return Re})),n.d(t,"J",(function(){return Ue})),n.d(t,"K",(function(){return Ve})),n.d(t,"L",(function(){return pt})),n.d(t,"M",(function(){return sn})),n.d(t,"N",(function(){return nr})),n.d(t,"O",(function(){return Ne})),n.d(t,"P",(function(){return ye})),n.d(t,"Q",(function(){return Ye})),n.d(t,"R",(function(){return ot})),n.d(t,"S",(function(){return ft})),n.d(t,"T",(function(){return qe})),n.d(t,"U",(function(){return ve})),n.d(t,"V",(function(){return Xe})),n.d(t,"W",(function(){return st})),n.d(t,"X",(function(){return dt})),n.d(t,"Y",(function(){return De})),n.d(t,"Z",(function(){return Ie})),n.d(t,"ab",(function(){return Ae})),n.d(t,"bb",(function(){return ue})),n.d(t,"cb",(function(){return _e})),n.d(t,"db",(function(){return we})),n.d(t,"eb",(function(){return Oe})),n.d(t,"fb",(function(){return Pe})),n.d(t,"gb",(function(){return Qe})),n.d(t,"hb",(function(){return it})),n.d(t,"ib",(function(){return ht})),n.d(t,"jb",(function(){return de})),n.d(t,"kb",(function(){return Le})),n.d(t,"lb",(function(){return je})),n.d(t,"mb",(function(){return Ze})),n.d(t,"nb",(function(){return Me})),n.d(t,"ob",(function(){return xe})),n.d(t,"pb",(function(){return Ce})),n.d(t,"x",(function(){return Lt})),n.d(t,"F",(function(){return Hr}));var jt=n("8HXZ"),Ft=n("xsHj"),Ut=("function"==typeof SuppressedError&&SuppressedError,n("li6C")),Vt=n("SgqZ");const qt={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},Bt={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"},zt=function(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend."}},Kt=s,$t=new jt.b("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Wt=new Ut.b("@firebase/auth");class Gt{constructor(e,t){this.shortDelay=e,this.longDelay=t,p(t>e,"Short delay should be less than long delay!"),this.isMobile=Object(jt.H)()||Object(jt.K)()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(m()||Object(jt.D)()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}class Ht{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void f("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void f("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void f("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Qt={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Yt=new Gt(3e4,6e4);class Xt{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(c(this.auth,"network-request-failed"))),Yt.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}class Jt{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){var t=this;if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout((async function(){await t.iteration()}),n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null==e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class Zt{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=k(this.lastLoginAt),this.creationTime=k(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}class en{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){d(e.idToken,"internal-error"),d(void 0!==e.idToken,"internal-error"),d(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){const t=S(e);return d(t,"internal-error"),d(void 0!==t.exp,"internal-error"),d(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return d(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await b(e,{},(async()=>{const n=Object(jt.Q)({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=T(e,r,"/v1/token",`key=${i}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Ht.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new en;return n&&(d("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(d("string"==typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(d("number"==typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return i(new en,this.toJSON())}_performRefresh(){return f("not implemented")}}class tn{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,s=r(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Jt(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Zt(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await O(this,this.stsTokenManager.getToken(this.auth,e));return d(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=Object(jt.z)(e),r=await n.getIdToken(t),i=S(r);d(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"==typeof i.firebase?i.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:k(C(i.auth_time)),issuedAtTime:k(C(i.iat)),expirationTime:k(C(i.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=Object(jt.z)(e);await A(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(d(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>i({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new tn(i(i({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){d(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await A(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await O(this,async function(e,t){return w(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return i(i({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>i({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,s,o,a,c,u,l;const h=null!==(n=t.displayName)&&void 0!==n?n:void 0,f=null!==(r=t.email)&&void 0!==r?r:void 0,p=null!==(s=t.phoneNumber)&&void 0!==s?s:void 0,g=null!==(o=t.photoURL)&&void 0!==o?o:void 0,m=null!==(a=t.tenantId)&&void 0!==a?a:void 0,_=null!==(c=t._redirectEventId)&&void 0!==c?c:void 0,y=null!==(u=t.createdAt)&&void 0!==u?u:void 0,v=null!==(l=t.lastLoginAt)&&void 0!==l?l:void 0,{uid:w,emailVerified:b,isAnonymous:I,providerData:T,stsTokenManager:E}=t;d(w&&E,e,"internal-error");const k=en.fromJSON(this.name,E);d("string"==typeof w,e,"internal-error"),N(h,e.name),N(f,e.name),d("boolean"==typeof b,e,"internal-error"),d("boolean"==typeof I,e,"internal-error"),N(p,e.name),N(g,e.name),N(m,e.name),N(_,e.name),N(y,e.name),N(v,e.name);const C=new tn({uid:w,auth:e,email:f,emailVerified:b,displayName:h,isAnonymous:I,photoURL:g,phoneNumber:p,tenantId:m,stsTokenManager:k,createdAt:y,lastLoginAt:v});return T&&Array.isArray(T)&&(C.providerData=T.map((e=>i({},e)))),_&&(C._redirectEventId=_),C}static async _fromIdTokenResponse(e,t,n=!1){const r=new en;r.updateFromServerResponse(t);const i=new tn({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await A(i),i}}const nn=new Map;class rn{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}rn.type="NONE";const sn=rn;class on{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=R(this.userKey,r.apiKey,i),this.fullPersistenceKey=R("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?tn._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new on(P(sn),e,n);const r=(await Promise.all(t.map((async function(e){if(await e._isAvailable())return e})))).filter((e=>e));let i=r[0]||P(sn);const s=R(n,e.config.apiKey,e.name);let o=null;for(const n of t)try{const t=await n._get(s);if(t){const r=tn._fromJSON(e,t);n!==i&&(o=r),i=n;break}}catch(e){}const a=r.filter((e=>e._shouldAllowMigration));return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(t.map((async function(e){if(e!==i)try{await e._remove(s)}catch(e){}}))),new on(i,e,n)):new on(i,e,n)}}class an{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some((e=>"EMAIL_PASSWORD_PROVIDER"===e.provider&&"OFF"!==e.enforcementState))}}class cn{constructor(e){this.type="recaptcha-enterprise",this.auth=Y(e)}async verify(e="verify",t=!1){function n(t,n,r){const i=window.grecaptcha;W(i)?i.enterprise.ready((()=>{i.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n("NO_RECAPTCHA")}))})):r(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async function(t,n){K(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((r=>{if(void 0!==r.recaptchaKey){const n=new an(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((i=>{if(!t&&W(window.grecaptcha))n(i,e,r);else{if("undefined"==typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));G("https://www.google.com/recaptcha/enterprise.js?render="+i).then((()=>{n(i,e,r)})).catch((e=>{r(e)}))}})).catch((e=>{r(e)}))}))}}class un{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(e){r(e)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(e){t.reverse();for(const e of t)try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==e?void 0:e.message})}}}class ln{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new hn(this),this.idTokenSubscription=new hn(this),this.beforeStateQueue=new un(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=$t,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){var n=this;return t&&(this._popupRedirectResolver=P(t)),this._initializationPromise=this.queue((async function(){var r,i;if(!n._deleted&&(n.persistenceManager=await on.create(n,e),!n._deleted)){if(null===(r=n._popupRedirectResolver)||void 0===r?void 0:r._shouldInitProactively)try{await n._popupRedirectResolver._initialize(n)}catch(e){}await n.initializeCurrentUser(t),n.lastNotifiedUid=(null===(i=n.currentUser)||void 0===i?void 0:i.uid)||null,n._deleted||(n._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUser(e){var t;const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null==r?void 0:r._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==s||!(null==o?void 0:o.user)||(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(e){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(e)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return d(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await A(e)}catch(e){if("auth/network-request-failed"!==(null==e?void 0:e.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?Object(jt.z)(e):null;return t&&d(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){var n=this;if(!this._deleted)return e&&d(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async function(){await n.directlySetCurrentUser(e),n.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){var t=this;return this.queue((async function(){await t.assertedPersistence.setPersistence(P(e))}))}async initializeRecaptchaConfig(){const e=await K(this,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),t=new an(e);if(null==this.tenantId?this._agentRecaptchaConfig=t:this._tenantRecaptchaConfigs[this.tenantId]=t,t.emailPasswordEnabled){new cn(this).verify()}}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new jt.b("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&P(e)||this._popupRedirectResolver;d(t,this,"argument-error"),this.redirectPersistenceManager=await on.create(this,[P(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async function(){})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){var t=this;if(e===this.currentUser)return this.queue((async function(){return t.directlySetCurrentUser(e)}))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"==typeof t?t:t.next.bind(t),s=this._isInitialized?Promise.resolve():this._initializationPromise;return d(s,this,"internal-error"),s.then((()=>i(this.currentUser))),"function"==typeof t?e.addObserver(t,n,r):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return d(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=z(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null==t?void 0:t.error)&&function(e,...t){Wt.logLevel<=Ut.a.WARN&&Wt.warn(`Auth (${Ft.SDK_VERSION}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token}}class hn{constructor(e){this.auth=e,this.observer=null,this.addObserver=Object(jt.o)((e=>this.observer=e))}get next(){return d(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}class dn{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return f("not implemented")}_getIdTokenResponse(e){return f("not implemented")}_linkToIdToken(e,t){return f("not implemented")}_getReauthenticationResolver(e){return f("not implemented")}}class fn extends dn{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new fn(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new fn(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){var t;switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};if(null===(t=e._getRecaptchaConfig())||void 0===t?void 0:t.emailPasswordEnabled){const t=await Q(e,n,"signInWithPassword");return ne(e,t)}return ne(e,n).catch((async function(t){if("auth/missing-recaptcha-token"===t.code){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const t=await Q(e,n,"signInWithPassword");return ne(e,t)}return Promise.reject(t)}));case"emailLink":return async function(e,t){return I(e,"POST","/v1/accounts:signInWithEmailLink",v(e,t))}(e,{email:this._email,oobCode:this._password});default:a(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return te(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return I(e,"POST","/v1/accounts:signInWithEmailLink",v(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:a(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}class pn extends dn{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new pn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):a("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,s=r(t,["providerId","signInMethod"]);if(!n||!i)return null;const o=new pn(n,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){return oe(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,oe(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,oe(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Object(jt.Q)(t)}return e}}const gn={USER_NOT_FOUND:"user-not-found"};class mn extends dn{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new mn({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new mn({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return I(e,"POST","/v1/accounts:signInWithPhoneNumber",v(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await I(e,"POST","/v1/accounts:signInWithPhoneNumber",v(e,t));if(n.temporaryProof)throw E(e,"account-exists-with-different-credential",n);return n}(e,i({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return I(e,"POST","/v1/accounts:signInWithPhoneNumber",v(e,i(i({},t),{operation:"REAUTH"})),gn)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new mn({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class _n{constructor(e){var t,n,r,i,s,o;const a=Object(jt.R)(Object(jt.t)(e)),c=null!==(t=a.apiKey)&&void 0!==t?t:null,u=null!==(n=a.oobCode)&&void 0!==n?n:null,l=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=a.mode)&&void 0!==r?r:null);d(c&&u&&l,"argument-error"),this.apiKey=c,this.operation=l,this.code=u,this.continueUrl=null!==(i=a.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=Object(jt.R)(Object(jt.t)(e)).link,n=t?Object(jt.R)(Object(jt.t)(t)).deep_link_id:null,r=Object(jt.R)(Object(jt.t)(e)).deep_link_id;return(r?Object(jt.R)(Object(jt.t)(r)).link:null)||r||n||t||e}(e);try{return new _n(t)}catch(e){return null}}}class yn{constructor(){this.providerId=yn.PROVIDER_ID}static credential(e,t){return fn._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=_n.parseLink(t);return d(n,"argument-error"),fn._fromEmailAndCode(e,n.code,n.tenantId)}}yn.PROVIDER_ID="password",yn.EMAIL_PASSWORD_SIGN_IN_METHOD="password",yn.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class vn{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class wn extends vn{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class bn extends wn{static credentialFromJSON(e){const t="string"==typeof e?JSON.parse(e):e;return d("providerId"in t&&"signInMethod"in t,"argument-error"),pn._fromParams(t)}credential(e){return this._credential(i(i({},e),{nonce:e.rawNonce}))}_credential(e){return d(e.idToken||e.accessToken,"argument-error"),pn._fromParams(i(i({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return bn.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return bn.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n,oauthTokenSecret:r,pendingToken:i,nonce:s,providerId:o}=e;if(!(n||r||t||i))return null;if(!o)return null;try{return new bn(o)._credential({idToken:t,accessToken:n,nonce:s,pendingToken:i})}catch(e){return null}}}class In extends wn{constructor(){super("facebook.com")}static credential(e){return pn._fromParams({providerId:In.PROVIDER_ID,signInMethod:In.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return In.credentialFromTaggedObject(e)}static credentialFromError(e){return In.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return In.credential(e.oauthAccessToken)}catch(e){return null}}}In.FACEBOOK_SIGN_IN_METHOD="facebook.com",In.PROVIDER_ID="facebook.com";class Tn extends wn{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return pn._fromParams({providerId:Tn.PROVIDER_ID,signInMethod:Tn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Tn.credentialFromTaggedObject(e)}static credentialFromError(e){return Tn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Tn.credential(t,n)}catch(e){return null}}}Tn.GOOGLE_SIGN_IN_METHOD="google.com",Tn.PROVIDER_ID="google.com";class En extends wn{constructor(){super("github.com")}static credential(e){return pn._fromParams({providerId:En.PROVIDER_ID,signInMethod:En.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return En.credentialFromTaggedObject(e)}static credentialFromError(e){return En.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return En.credential(e.oauthAccessToken)}catch(e){return null}}}En.GITHUB_SIGN_IN_METHOD="github.com",En.PROVIDER_ID="github.com";class kn extends dn{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){return oe(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,oe(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,oe(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r,pendingToken:i}=t;return n&&r&&i&&n===r?new kn(n,i):null}static _create(e,t){return new kn(e,t)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class Cn extends vn{constructor(e){d(e.startsWith("saml."),"argument-error"),super(e)}static credentialFromResult(e){return Cn.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Cn.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=kn.fromJSON(e);return d(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:n}=e;if(!t||!n)return null;try{return kn._create(n,t)}catch(e){return null}}}class Sn extends wn{constructor(){super("twitter.com")}static credential(e,t){return pn._fromParams({providerId:Sn.PROVIDER_ID,signInMethod:Sn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Sn.credentialFromTaggedObject(e)}static credentialFromError(e){return Sn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Sn.credential(t,n)}catch(e){return null}}}Sn.TWITTER_SIGN_IN_METHOD="twitter.com",Sn.PROVIDER_ID="twitter.com";class On{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const i=await tn._fromIdTokenResponse(e,n,r),s=ce(n);return new On({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=ce(n);return new On({user:e,providerId:r,_tokenResponse:n,operationType:t})}}class An extends jt.c{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,An.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new An(e,t,n,r)}}class Nn{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?Pn._fromServerResponse(e,t):"totpInfo"in t?Rn._fromServerResponse(e,t):a(e,"internal-error")}}class Pn extends Nn{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new Pn(t)}}class Rn extends Nn{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new Rn(t)}}class Dn{constructor(e,t,n={}){this.isNewUser=e,this.providerId=t,this.profile=n}}class xn extends Dn{constructor(e,t,n,r){super(e,t,n),this.username=r}}class Mn extends Dn{constructor(e,t){super(e,"facebook.com",t)}}class Ln extends xn{constructor(e,t){super(e,"github.com",t,"string"==typeof(null==t?void 0:t.login)?null==t?void 0:t.login:null)}}class jn extends Dn{constructor(e,t){super(e,"google.com",t)}}class Fn extends xn{constructor(e,t,n){super(e,"twitter.com",t,n)}}class Un{constructor(e,t,n){this.type=e,this.credential=t,this.user=n}static _fromIdtoken(e,t){return new Un("enroll",e,t)}static _fromMfaPendingCredential(e){return new Un("signin",e)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,n;if(null==e?void 0:e.multiFactorSession){if(null===(t=e.multiFactorSession)||void 0===t?void 0:t.pendingCredential)return Un._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(null===(n=e.multiFactorSession)||void 0===n?void 0:n.idToken)return Un._fromIdtoken(e.multiFactorSession.idToken)}return null}}class Vn{constructor(e,t,n){this.session=e,this.hints=t,this.signInResolver=n}static _fromError(e,t){const n=Y(e),r=t.customData._serverResponse,s=(r.mfaInfo||[]).map((e=>Nn._fromServerResponse(n,e)));d(r.mfaPendingCredential,n,"internal-error");const o=Un._fromMfaPendingCredential(r.mfaPendingCredential);return new Vn(o,s,(async function(e){const s=await e._process(n,o);delete r.mfaInfo,delete r.mfaPendingCredential;const c=i(i({},r),{idToken:s.idToken,refreshToken:s.refreshToken});switch(t.operationType){case"signIn":const e=await On._fromIdTokenResponse(n,t.operationType,c);return await n._updateCurrentUser(e.user),e;case"reauthenticate":return d(t.user,n,"internal-error"),On._forOperation(t.user,t.operationType,c);default:a(n,"internal-error")}}))}async resolveSignIn(e){return this.signInResolver(e)}}class qn{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload((t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map((t=>Nn._fromServerResponse(e.auth,t))))}))}static _fromUser(e){return new qn(e)}async getSession(){return Un._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const n=e,r=await this.getSession(),i=await O(this.user,n._process(this.user.auth,r,t));return await this.user._updateTokensIfNecessary(i),this.user.reload()}async unenroll(e){const t="string"==typeof e?e:e.uid,n=await this.user.getIdToken();try{const e=await O(this.user,(r=this.user.auth,i={idToken:n,mfaEnrollmentId:t},w(r,"POST","/v2/accounts/mfaEnrollment:withdraw",v(r,i))));this.enrolledFactors=this.enrolledFactors.filter((({uid:e})=>e!==t)),await this.user._updateTokensIfNecessary(e),await this.user.reload()}catch(e){throw e}var r,i}}const Bn=new WeakMap,zn="__sak";class Kn{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(zn,"1"),this.storage.removeItem(zn),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class $n extends Kn{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=Object(jt.A)();return M(e)||q(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=B(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const r=this.storage.getItem(n);if(e.newValue!==r)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);Object(jt.F)()&&10===document.documentMode&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}$n.type="LOCAL";const Wn=$n;class Gn extends Kn{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Gn.type="SESSION";const Hn=Gn;class Qn{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new Qn(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null==s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map((async function(e){return e(t.origin,i)})),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Qn.receivers=[];class Yn{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise(((o,a)=>{const c=Be("",20);r.port1.start();const u=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(u),i=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(u),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}const Xn="firebaseLocalStorageDb",Jn="firebaseLocalStorage",Zn="fbase_key";class er{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}class tr{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await We()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ke()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){var e=this;this.receiver=Qn._getInstance(Ke()?self:null),this.receiver._subscribe("keyChanged",(async function(t,n){return{keyProcessed:(await e._poll()).includes(n.key)}})),this.receiver._subscribe("ping",(async function(){return["keyChanged"]}))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Yn(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){var t;if(this.sender&&this.activeServiceWorker&&((null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await We();return await Ge(e,zn,"1"),await He(e,zn),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){var n=this;return this._withPendingWrite((async function(){return await n._withRetries((n=>Ge(n,e,t))),n.localCache[e]=t,n.notifyServiceWorker(e)}))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=$e(e,!1).get(t),r=await new er(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){var t=this;return this._withPendingWrite((async function(){return await t._withRetries((t=>He(t,e))),delete t.localCache[e],t.notifyServiceWorker(e)}))}async _poll(){const e=await this._withRetries((e=>{const t=$e(e,!1).getAll();return new er(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){var e=this;this.stopPolling(),this.pollTimer=setInterval((async function(){return e._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}tr.type="LOCAL";const nr=tr,rr=1e12;class ir{constructor(e){this.auth=e,this.counter=rr,this._widgets=new Map}render(e,t){const n=this.counter;return this._widgets.set(n,new sr(e,this.auth.name,t||{})),this.counter++,n}reset(e){var t;const n=e||rr;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}getResponse(e){var t;return(null===(t=this._widgets.get(e||rr))||void 0===t?void 0:t.getResponse())||""}async execute(e){var t;return null===(t=this._widgets.get(e||rr))||void 0===t||t.execute(),""}}class sr{constructor(e,t,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const r="string"==typeof e?document.getElementById(e):e;d(r,"argument-error",{appName:t}),this.container=r,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout((()=>{this.responseToken=function(e){const t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<e;r++)t.push(n.charAt(Math.floor(62*Math.random())));return t.join("")}(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch(e){}this.timerId=window.setTimeout((()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch(e){}this.isVisible&&this.execute()}),6e4)}),500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const or=H("rcb"),ar=new Gt(3e4,6e4);class cr{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(null===(e=ze().grecaptcha)||void 0===e?void 0:e.render)}load(e,t=""){return d(function(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}(t),e,"argument-error"),this.shouldResolveImmediately(t)&&$(ze().grecaptcha)?Promise.resolve(ze().grecaptcha):new Promise(((n,r)=>{const i=ze().setTimeout((()=>{r(c(e,"network-request-failed"))}),ar.get());ze()[or]=()=>{ze().clearTimeout(i),delete ze()[or];const s=ze().grecaptcha;if(!s||!$(s))return void r(c(e,"internal-error"));const o=s.render;s.render=(e,t)=>{const n=o(e,t);return this.counter++,n},this.hostLanguage=t,n(s)};G(`https://www.google.com/recaptcha/api.js??${Object(jt.Q)({onload:or,render:"explicit",hl:t})}`).catch((()=>{clearTimeout(i),r(c(e,"internal-error"))}))}))}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(null===(t=ze().grecaptcha)||void 0===t?void 0:t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class ur{async load(e){return new ir(e)}clearedOneInstance(){}}const lr="recaptcha",hr={theme:"light",type:"image"};class dr{constructor(e,t,n=i({},hr)){this.parameters=n,this.type=lr,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Y(e),this.isInvisible="invisible"===this.parameters.size,d("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");const r="string"==typeof t?document.getElementById(t):t;d(r,this.auth,"argument-error"),this.container=r,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new ur:new cr,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),n=t.getResponse(e);return n||new Promise((n=>{const r=e=>{e&&(this.tokenChangeListeners.delete(r),n(e))};this.tokenChangeListeners.add(r),this.isInvisible&&t.execute(e)}))}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch((e=>{throw this.renderPromise=null,e}))),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach((e=>{this.container.removeChild(e)}))}validateStartingState(){d(!this.parameters.sitekey,this.auth,"argument-error"),d(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),d("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach((e=>e(t))),"function"==typeof e)e(t);else if("string"==typeof e){const n=ze()[e];"function"==typeof n&&n(t)}}}assertNotDestroyed(){d(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){d(m()&&!Ke(),this.auth,"internal-error"),await function(){let e=null;return new Promise((t=>{"complete"!==document.readyState?(e=()=>t(),window.addEventListener("load",e)):t()})).catch((t=>{throw e&&window.removeEventListener("load",e),t}))}(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await async function(e){return(await w(e,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}(this.auth);d(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return d(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class fr{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=mn._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}class pr{constructor(e){this.providerId=pr.PROVIDER_ID,this.auth=Y(e)}verifyPhoneNumber(e,t){return Je(this.auth,e,Object(jt.z)(t))}static credential(e,t){return mn._fromVerification(e,t)}static credentialFromResult(e){return pr.credentialFromTaggedObject(e)}static credentialFromError(e){return pr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?mn._fromTokenResponse(t,n):null}}pr.PROVIDER_ID="phone",pr.PHONE_SIGN_IN_METHOD="phone";class gr extends dn{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return oe(e,this._buildIdpRequest())}_linkToIdToken(e,t){return oe(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return oe(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}class mr{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){var e=this;return new Promise((async function(t,n){e.pendingPromise={resolve:t,reject:n};try{e.eventManager=await e.resolver._initialize(e.auth),await e.onExecution(),e.eventManager.registerConsumer(e)}catch(t){e.reject(t)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return tt;case"linkViaPopup":case"linkViaRedirect":return rt;case"reauthViaPopup":case"reauthViaRedirect":return nt;default:a(this.auth,"internal-error")}}resolve(e){p(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){p(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const _r=new Gt(2e3,1e4);class yr extends mr{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,yr.currentPopupAction&&yr.currentPopupAction.cancel(),yr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return d(e,this.auth,"internal-error"),e}async onExecution(){p(1===this.filter.length,"Popup operations only handle one event");const e=Be();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(c(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(c(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,yr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;this.pollId=(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?window.setTimeout((()=>{this.pollId=null,this.reject(c(this.auth,"popup-closed-by-user"))}),8e3):window.setTimeout(e,_r.get())};e()}}yr.currentPopupAction=null;const vr="pendingRedirect",wr=new Map;class br extends mr{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=wr.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=lt(t),r=ut(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}wr.set(this.auth._key(),e)}return this.bypassAuthState||wr.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}class Ir{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return yt(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!yt(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(c(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(_t(e))}saveEventToCache(e){this.cachedEventUids.add(_t(e)),this.lastProcessedEventTime=Date.now()}}const Tr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Er=/^https?/,kr=new Gt(3e4,6e4);let Cr=null;const Sr=new Gt(5e3,15e3),Or="__/auth/iframe",Ar="emulator/auth/iframe",Nr={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Pr=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]),Rr={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Dr{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}const xr="__/auth/handler",Mr="emulator/auth/handler",Lr=encodeURIComponent("fac"),jr="webStorageSupport";const Fr=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Hn,this._completeRedirectFn=gt,this._overrideRedirectResult=ct}async _openPopup(e,t,n,r){var i;p(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return Et(e,await kt(e,t,n,g(),r),Be())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){ze().location.href=e}(await kt(e,t,n,g(),r)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(p(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await async function(e){const t=await It(e),n=ze().gapi;return d(n,e,"internal-error"),t.open({where:document.body,url:Tt(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Nr,dontclear:!0},(t=>new Promise((async(n,r)=>{function i(){ze().clearTimeout(o),n(t)}await t.restyle({setHideOnLeave:!1});const s=c(e,"network-request-failed"),o=ze().setTimeout((()=>{r(s)}),Sr.get());t.ping(i).then(i,(()=>{r(s)}))}))))}(e),n=new Ir(e);return t.register("authEvent",(t=>{d(null==t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(jr,{type:jr},(n=>{var r;const i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r[jr];void 0!==i&&t(!!i),a(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){if(e.config.emulator)return;const{authorizedDomains:t}=await vt(e);for(const e of t)try{if(wt(e))return}catch(e){}a(e,"unauthorized-domain")}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return B()||M()||q()}};class Ur{constructor(e){this.factorId=e}_process(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return f("unexpected MultiFactorSessionType")}}}class Vr extends Ur{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Vr(e)}_finalizeEnroll(e,t,n){return function(e,t){return w(e,"POST","/v2/accounts/mfaEnrollment:finalize",v(e,t))}(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return function(e,t){return w(e,"POST","/v2/accounts/mfaSignIn:finalize",v(e,t))}(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class qr{constructor(){}static assertion(e){return Vr._fromCredential(e)}}qr.FACTOR_ID="phone";var Br="@firebase/auth",zr="1.1.0";class Kr{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){d(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}Object(jt.x)("authIdTokenMaxAge");var $r;$r="Browser",Object(Ft._registerComponent)(new Vt.a("auth",((e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=n.options;d(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:s,authDomain:o,clientPlatform:$r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:z($r)},c=new ln(n,r,i,a);return function(e,t){const n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(P);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(c,t),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e=>{e.getProvider("auth-internal").initialize()}))),Object(Ft._registerComponent)(new Vt.a("auth-internal",(e=>(e=>new Kr(e))(Y(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),Object(Ft.registerVersion)(Br,zr,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}($r)),Object(Ft.registerVersion)(Br,zr,"esm2017");const Wr=20;class Gr extends Ir{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise((e=>{this.resolveInialized=e}))}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach((t=>t(e))),super.onEvent(e)}async initialized(){await this.initPromise}}const Hr=class{constructor(){this._redirectPersistence=Hn,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=gt,this._overrideRedirectResult=ct}async _initialize(e){const t=e._key();let n=this.eventManagers.get(t);return n||(n=new Gr(e),this.eventManagers.set(t,n),this.attachCallbackListeners(e,n)),n}_openPopup(e){a(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,n,r){!function(e){var t,n,r,i,s,o,a,c,u,l;const h=Ct();d("function"==typeof(null===(t=null==h?void 0:h.universalLinks)||void 0===t?void 0:t.subscribe),e,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),d(void 0!==(null===(n=null==h?void 0:h.BuildInfo)||void 0===n?void 0:n.packageName),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),d("function"==typeof(null===(s=null===(i=null===(r=null==h?void 0:h.cordova)||void 0===r?void 0:r.plugins)||void 0===i?void 0:i.browsertab)||void 0===s?void 0:s.openUrl),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),d("function"==typeof(null===(c=null===(a=null===(o=null==h?void 0:h.cordova)||void 0===o?void 0:o.plugins)||void 0===a?void 0:a.browsertab)||void 0===c?void 0:c.isAvailable),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),d("function"==typeof(null===(l=null===(u=null==h?void 0:h.cordova)||void 0===u?void 0:u.InAppBrowser)||void 0===l?void 0:l.open),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(e);const i=await this._initialize(e);await i.initialized(),i.resetRedirect(),wr.clear(),await this._originValidation(e);const s=function(e,t,n=null){return{type:t,eventId:n,urlResponse:null,sessionId:Pt(),postBody:null,tenantId:e.tenantId,error:c(e,"no-auth-event")}}(e,n,r);await function(e,t){return Rt()._set(Dt(e),t)}(e,s);const o=await St(e,s,t);return async function(e,t,n){const{cordova:r}=Ct();let i=()=>{};try{await new Promise(((s,o)=>{function a(){var e;s();const t=null===(e=r.plugins.browsertab)||void 0===e?void 0:e.close;"function"==typeof t&&t(),"function"==typeof(null==n?void 0:n.close)&&n.close()}function u(){h||(h=window.setTimeout((()=>{o(c(e,"redirect-cancelled-by-user"))}),2e3))}function l(){"visible"===(null===document||void 0===document?void 0:document.visibilityState)&&u()}let h=null;t.addPassiveListener(a),document.addEventListener("resume",u,!1),F()&&document.addEventListener("visibilitychange",l,!1),i=()=>{t.removePassiveListener(a),document.removeEventListener("resume",u,!1),document.removeEventListener("visibilitychange",l,!1),h&&window.clearTimeout(h)}}))}finally{i()}}(e,i,await Ot(o))}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){const{BuildInfo:t}=Ct(),n={};q()?n.iosBundleId=t.packageName:F()?n.androidPackageName=t.packageName:a(e,"operation-not-supported-in-this-environment"),await vt(e,n)}(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:n,handleOpenURL:r,BuildInfo:i}=Ct(),s=setTimeout((async function(){await At(e),t.onEvent(Mt())}),500),o=async function(n){clearTimeout(s);const r=await At(e);let i=null;r&&(null==n?void 0:n.url)&&(i=Nt(r,n.url)),t.onEvent(i||Mt())};void 0!==n&&"function"==typeof n.subscribe&&n.subscribe(null,o);const a=r,c=`${i.packageName.toLowerCase()}://`;Ct().handleOpenURL=async function(e){if(e.toLowerCase().startsWith(c)&&o({url:e}),"function"==typeof a)try{a(e)}catch(e){console.error(e)}}}}},"83Vu":function(e,t,n){"use strict";(function(e,r){var i=n("gBRc");t.a=()=>e(r,null,e(i.a,{path:""}))}).call(this,n("hosL").h,n("hosL").Fragment)},"8HXZ":function(e,t,n){"use strict";(function(e){function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function i(e){return s(void 0,e)}function s(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=s(e[n],t[n]));return e}function o(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==e)return e;throw new Error("Unable to locate global object.")}function a(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",i=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=r({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[$(JSON.stringify({alg:"none",type:"JWT"})),$(JSON.stringify(o)),""].join(".")}function c(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function u(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(c())}function l(){var t;const n=null===(t=G())||void 0===t?void 0:t.forceEnvironment;if("node"===n)return!0;if("browser"===n)return!1;try{return"[object process]"===Object.prototype.toString.call(e.process)}catch(e){return!1}}function h(){return"object"==typeof self&&self.self===self}function d(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function f(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function p(){const e=c();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function g(){return!0===F.NODE_CLIENT||!0===F.NODE_ADMIN}function m(){return!l()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function _(){try{return"object"==typeof indexedDB}catch(e){return!1}}function y(){return new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))}function v(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}function w(e){return JSON.parse(e)}function b(e){return JSON.stringify(e)}function I(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function T(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function E(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function k(e,t,n){const r={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function C(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(S(n)&&S(s)){if(!C(n,s))return!1}else if(n!==s)return!1}for(const e of r)if(!n.includes(e))return!1;return!0}function S(e){return null!==e&&"object"==typeof e}function O(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function A(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function N(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}function P(e,t){const n=new ae(e,t);return n.subscribe.bind(n)}function R(){}function D(e,t){return`${e} failed: ${t} argument `}function x(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(D(e,t)+"must be a valid function.")}function M(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(D(e,t)+"must be a valid context object.")}function L(e,t=de,n=fe){const r=t*Math.pow(n,e),i=Math.round(ge*r*(Math.random()-.5)*2);return Math.min(pe,r+i)}function j(e){return e&&e._delegate?e._delegate:e}n.d(t,"a",(function(){return J})),n.d(t,"b",(function(){return ee})),n.d(t,"c",(function(){return Z})),n.d(t,"d",(function(){return oe})),n.d(t,"e",(function(){return v})),n.d(t,"f",(function(){return U})),n.d(t,"g",(function(){return V})),n.d(t,"h",(function(){return B})),n.d(t,"i",(function(){return W})),n.d(t,"j",(function(){return K})),n.d(t,"k",(function(){return $})),n.d(t,"l",(function(){return L})),n.d(t,"m",(function(){return I})),n.d(t,"n",(function(){return a})),n.d(t,"o",(function(){return P})),n.d(t,"p",(function(){return i})),n.d(t,"q",(function(){return C})),n.d(t,"r",(function(){return s})),n.d(t,"s",(function(){return D})),n.d(t,"t",(function(){return N})),n.d(t,"u",(function(){return Y})),n.d(t,"v",(function(){return H})),n.d(t,"w",(function(){return Q})),n.d(t,"x",(function(){return X})),n.d(t,"y",(function(){return o})),n.d(t,"z",(function(){return j})),n.d(t,"A",(function(){return c})),n.d(t,"B",(function(){return se})),n.d(t,"C",(function(){return h})),n.d(t,"D",(function(){return d})),n.d(t,"E",(function(){return E})),n.d(t,"F",(function(){return p})),n.d(t,"G",(function(){return _})),n.d(t,"H",(function(){return u})),n.d(t,"I",(function(){return l})),n.d(t,"J",(function(){return g})),n.d(t,"K",(function(){return f})),n.d(t,"L",(function(){return m})),n.d(t,"M",(function(){return ie})),n.d(t,"N",(function(){return re})),n.d(t,"O",(function(){return w})),n.d(t,"P",(function(){return k})),n.d(t,"Q",(function(){return O})),n.d(t,"R",(function(){return A})),n.d(t,"S",(function(){return T})),n.d(t,"T",(function(){return le})),n.d(t,"U",(function(){return ue})),n.d(t,"V",(function(){return b})),n.d(t,"W",(function(){return he})),n.d(t,"X",(function(){return ce})),n.d(t,"Y",(function(){return x})),n.d(t,"Z",(function(){return M})),n.d(t,"ab",(function(){return y}));const F={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},U=function(e,t){if(!e)throw V(t)},V=function(e){return new Error("Firebase Database ("+F.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},q=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},B={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){const i=e[t],s=t+1<e.length,o=s?e[t+1]:0,a=t+2<e.length,c=a?e[t+2]:0;let u=(15&o)<<2|c>>6,l=63&c;a||(l=64,s||(u=64)),r.push(n[i>>2],n[(3&i)<<4|o>>4],n[u],n[l])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(q(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){const i=n[e.charAt(t++)],s=t<e.length?n[e.charAt(t)]:0;++t;const o=t<e.length?n[e.charAt(t)]:64;++t;const a=t<e.length?n[e.charAt(t)]:64;if(++t,null==i||null==s||null==o||null==a)throw new z;if(r.push(i<<2|s>>4),64!==o){if(r.push(s<<4&240|o>>2),64!==a){r.push(o<<6&192|a)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class z extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const K=function(e){const t=q(e);return B.encodeByteArray(t,!0)},$=function(e){return K(e).replace(/\./g,"")},W=function(e){try{return B.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null},G=()=>{try{return o().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const e=process.env.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}const t=e&&W(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},H=e=>{var t,n;return null===(n=null===(t=G())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},Q=e=>{const t=H(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},Y=()=>{var e;return null===(e=G())||void 0===e?void 0:e.config},X=e=>{var t;return null===(t=G())||void 0===t?void 0:t[`_${e}`]};class J{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}class Z extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,Z.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ee.prototype.create)}}class ee{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],s=i?function(e,t){return e.replace(te,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error";return new Z(r,`${this.serviceName}: ${s} (${r}).`,n)}}const te=/\{\$([^}]+)}/g,ne=function(e){let t={},n={},r={},i="";try{const s=e.split(".");t=w(W(s[0])||""),n=w(W(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}},re=function(e){const t=ne(e).claims;return"object"==typeof t&&t.hasOwnProperty("iat")?t.iat:null},ie=function(e){const t=ne(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")},se=function(e){const t=ne(e).claims;return"object"==typeof t&&!0===t.admin};class oe{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"==typeof e)for(let r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let e=16;e<80;e++){const t=n[e-3]^n[e-8]^n[e-14]^n[e-16];n[e]=4294967295&(t<<1|t>>>31)}let r,i,s=this.chain_[0],o=this.chain_[1],a=this.chain_[2],c=this.chain_[3],u=this.chain_[4];for(let e=0;e<80;e++){e<40?e<20?(r=c^o&(a^c),i=1518500249):(r=o^a^c,i=1859775393):e<60?(r=o&a|c&(o|a),i=2400959708):(r=o^a^c,i=3395469782);const t=(s<<5|s>>>27)+r+u+i+n[e]&4294967295;u=c,c=a,a=4294967295&(o<<30|o>>>2),o=s,s=t}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+u&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let r=0;const i=this.buf_;let s=this.inbuf_;for(;r<t;){if(0===s)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[s]=e.charCodeAt(r),++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}else for(;r<t;)if(i[s]=e[r],++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}this.inbuf_=s,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let t=0;t<5;t++)for(let r=24;r>=0;r-=8)e[n]=this.chain_[t]>>r&255,++n;return e}}class ae{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"==typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=R),void 0===r.error&&(r.error=R),void 0===r.complete&&(r.complete=R);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}const ce=function(e,t,n,r){let i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i){throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")}},ue=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);if(i>=55296&&i<=56319){const t=i-55296;r++,U(r<e.length,"Surrogate pair missing trail surrogate.");i=65536+(t<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},le=function(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t},he=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},de=1e3,fe=2,pe=144e5,ge=.5}).call(this,n("pCvA"))},"8WOM":function(e,t,n){"use strict";(function(e,r){var i=n("l8WD"),s=n("Dans"),o=n("gUA9"),a=n("qDtm").a.firestore.Timestamp;t.a=()=>{const[t,n]=Object(i.b)(0),[c,u]=Object(i.b)(!1),l=t>0,h=e=>{n(e.target.id)};Object(i.a)((()=>{c&&(u(!1),document.getElementById("confirm_btn").className="confirm_btn_disabled")}),[c]);return e(r,null,e("div",{className:"stars"},Array.from({length:5},((n,r)=>e("div",r<t?{id:`${r+1}`,className:"vote_item_enabled",onClick:h}:{id:`${r+1}`,className:"vote_item_disabled",onClick:h})))),e("button",{id:"confirm_btn",className:l?"confirm_btn":"confirm_btn_disabled",onClick:l?async()=>{await Object(s.a)(Object(s.b)(o.a,"votes"),{vote:t,creationDate:a.now()}),document.getElementById("confirm_btn").className="btn_clicked",u(!0),n(0)}:void 0}))}}).call(this,n("hosL").h,n("hosL").Fragment)},Dans:function(e,t,n){"use strict";var r=n("zaJb");n.d(t,"a",(function(){return r.u})),n.d(t,"b",(function(){return r.y})),n.d(t,"c",(function(){return r.S}))},Ldkf:function(e,t,n){"use strict";(function(e){function r(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function i(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function s(e,t,n){return e.call.apply(e.bind,arguments)}function o(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function a(e,t,n){return(a=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?s:o).apply(null,arguments)}function c(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function u(e,t){function n(){}n.prototype=t.prototype,e.$=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.ac=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function l(){this.s=this.s,this.o=this.o}function h(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function d(e,t){for(let t=1;t<arguments.length;t++){const n=arguments[t];if(r(n)){const t=e.length||0,r=n.length||0;e.length=t+r;for(let i=0;i<r;i++)e[t+i]=n[i]}else e.push(n)}}function f(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}function p(e){return/^[\s\xa0]*$/.test(e)}function g(){var e=nn.navigator;return e&&(e=e.userAgent)?e:""}function m(e){return-1!=g().indexOf(e)}function _(e){return _[" "](e),e}function y(){var e=nn.document;return e?e.documentMode:void 0}function v(e,t){if(f.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(gn){e:{try{_(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:In[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&v.$.h.call(this)}}function w(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.la=i,this.key=++En,this.fa=this.ia=!1}function b(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function I(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function T(e){const t={};for(const n in e)t[n]=e[n];return t}function E(e,t){let n,r;for(let t=1;t<arguments.length;t++){for(n in r=arguments[t],r)e[n]=r[n];for(let t=0;t<kn.length;t++)n=kn[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function k(e){this.src=e,this.g={},this.h=0}function C(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=on(i,t);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(b(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function S(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.fa&&s.listener==t&&s.capture==!!n&&s.la==r)return i}return-1}function O(e,t,n,r,s){if(r&&r.once)return N(e,t,n,r,s);if(Array.isArray(t)){for(var o=0;o<t.length;o++)O(e,t[o],n,r,s);return null}return n=L(n),e&&e[Tn]?e.O(t,n,i(r)?!!r.capture:!!r,s):A(e,t,n,!1,r,s)}function A(e,t,n,r,s,o){if(!t)throw Error("Invalid event type");var a=i(s)?!!s.capture:!!s,c=M(e);if(c||(e[Cn]=c=new k(e)),(n=c.add(t,n,r,a,o)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=x;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)an||(s=a),void 0===s&&(s=!1),e.addEventListener(t.toString(),r,s);else if(e.attachEvent)e.attachEvent(D(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function N(e,t,n,r,s){if(Array.isArray(t)){for(var o=0;o<t.length;o++)N(e,t[o],n,r,s);return null}return n=L(n),e&&e[Tn]?e.P(t,n,i(r)?!!r.capture:!!r,s):A(e,t,n,!0,r,s)}function P(e,t,n,r,s){if(Array.isArray(t))for(var o=0;o<t.length;o++)P(e,t[o],n,r,s);else r=i(r)?!!r.capture:!!r,n=L(n),e&&e[Tn]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=S(o=e.g[t],n,r,s))&&(b(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete e.g[t],e.h--)))):e&&(e=M(e))&&(t=e.g[t.toString()],e=-1,t&&(e=S(t,n,r,s)),(n=-1<e?t[e]:null)&&R(n))}function R(e){if("number"!=typeof e&&e&&!e.fa){var t=e.src;if(t&&t[Tn])C(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(D(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=M(t))?(C(n,e),0==n.h&&(n.src=null,t[Cn]=null)):b(e)}}}function D(e){return e in Sn?Sn[e]:Sn[e]="on"+e}function x(e,t){if(e.fa)e=!0;else{t=new v(t,this);var n=e.listener,r=e.la||e.src;e.ia&&R(e),e=n.call(r,t)}return e}function M(e){return(e=e[Cn])instanceof k?e:null}function L(e){return"function"==typeof e?e:(e[On]||(e[On]=function(t){return e.handleEvent(t)}),e[On])}function j(){l.call(this),this.i=new k(this),this.S=this,this.J=null}function F(e,t){var n,r=e.J;if(r)for(n=[];r;r=r.J)n.push(r);if(e=e.S,r=t.type||t,"string"==typeof t)t=new f(t,e);else if(t instanceof f)t.target=t.target||e;else{var i=t;E(t=new f(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=U(o,r,!0,t)&&i}if(i=U(o=t.g=e,r,!0,t)&&i,i=U(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=U(o=t.g=n[s],r,!1,t)&&i}function U(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&C(e.i,o),i=!1!==a.call(c,r)&&i}}return i&&!r.defaultPrevented}function V(){var e=xn;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}function q(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function B(e){nn.setTimeout((()=>{throw e}),0)}function z(e,t){j.call(this),this.h=e||1,this.g=t||nn,this.j=a(this.qb,this),this.l=Date.now()}function K(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}function $(e,t,n){if("function"==typeof e)n&&(e=a(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=a(e.handleEvent,e)}return 2147483647<Number(t)?-1:nn.setTimeout(e,t||0)}function W(e){e.g=$((()=>{e.g=null,e.i&&(e.i=!1,W(e))}),e.j);const t=e.h;e.h=null,e.m.apply(null,t)}function G(e){l.call(this),this.h=e,this.g={}}function H(e,t,n,r){Array.isArray(n)||(n&&(Fn[0]=n.toString()),n=Fn);for(var i=0;i<n.length;i++){var s=O(t,n[i],r||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function Q(e){I(e.g,(function(e,t){this.g.hasOwnProperty(t)&&R(e)}),e),e.g={}}function Y(){this.g=!0}function X(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return An(n)}catch(e){return t}}(e,n)+(r?" "+r:"")}))}function J(){return Vn=Vn||new j}function Z(e){f.call(this,Un.Ta,e)}function ee(){const e=J();F(e,new Z(e))}function te(e,t){f.call(this,Un.STAT_EVENT,e),this.stat=t}function ne(e){const t=J();F(t,new te(t,e))}function re(e,t){f.call(this,Un.Ua,e),this.size=t}function ie(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return nn.setTimeout((function(){e()}),t)}function se(){}function oe(e){return e.h||(e.h=e.i())}function ae(){}function ce(){f.call(this,"d")}function ue(){f.call(this,"c")}function le(){}function he(e,t,n,r){this.l=e,this.j=t,this.m=n,this.W=r||1,this.U=new G(this),this.P=$n,this.V=new z(e=pn?125:void 0),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new de}function de(){this.i=null,this.g="",this.h=!1}function fe(e,t,n){e.L=1,e.v=Pe(Ce(t)),e.s=n,e.S=!0,pe(e,null)}function pe(e,t){e.G=Date.now(),ye(e),e.A=Ce(e.v);var n=e.A,r=e.W;Array.isArray(r)||(r=[String(r)]),Ue(n.i,"t",r),e.C=0,n=e.l.J,e.h=new de,e.g=Pt(e.l,n?t:null,!e.s),0<e.O&&(e.M=new jn(a(e.Pa,e,e.g),e.O)),H(e.U,e.g,"readystatechange",e.nb),t=e.I?T(e.I):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.A,e.u,e.s,t)):(e.u="GET",e.g.ha(e.A,e.u,null,t)),ee(),function(e,t,n,r,i,s){e.info((function(){if(e.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+u+"&":o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.W,e.s)}function ge(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.l.Ha)}function me(e,t,n){let r,i=!0;for(;!e.J&&e.C<n.length;){if(r=_e(e,n),r==Gn){4==t&&(e.o=4,ne(14),i=!1),X(e.j,e.m,null,"[Incomplete Response]");break}if(r==Wn){e.o=4,ne(15),X(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}X(e.j,e.m,r,null),Te(e,r)}ge(e)&&r!=Gn&&r!=Wn&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,ne(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.ba&&(e.ba=!0,(t=e.l).g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Tt(t),t.M=!0,ne(11))):(X(e.j,e.m,n,"[Invalid Chunked Response]"),Ie(e),be(e))}function _e(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Gn:(n=Number(t.substring(n,r)),isNaN(n)?Wn:(r+=1)+n>t.length?Gn:(t=t.slice(r,r+n),e.C=r+n,t))}function ye(e){e.Y=Date.now()+e.P,ve(e,e.P)}function ve(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=ie(a(e.lb,e),t)}function we(e){e.B&&(nn.clearTimeout(e.B),e.B=null)}function be(e){0==e.l.H||e.J||Ct(e.l,e)}function Ie(e){we(e);var t=e.M;t&&"function"==typeof t.sa&&t.sa(),e.M=null,K(e.V),Q(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function Te(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||Ke(n.i,e)))if(!e.K&&Ke(n.i,e)&&3==n.H){try{var r=n.Ja.g.parse(t)}catch(e){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<e.G))break e;kt(n),gt(n)}It(n),ne(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&0==n.A&&!n.v&&(n.v=ie(a(n.ib,n),6e3));if(1>=ze(n.i)&&n.oa){try{n.oa()}catch(e){}n.oa=void 0}}else Ot(n,11)}else if((e.K||n.g==e)&&kt(n),!p(t))for(i=n.Ja.g.parse(t),t=0;t<i.length;t++){let a=i[t];if(n.V=a[0],a=a[1],2==n.H)if("c"==a[0]){n.K=a[1],n.pa=a[2];const t=a[3];null!=t&&(n.ra=t,n.l.info("VER="+n.ra));const i=a[4];null!=i&&(n.Ga=i,n.l.info("SVER="+n.Ga));const l=a[5];null!=l&&"number"==typeof l&&0<l&&(n.L=r=1.5*l,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.i;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&($e(s,s.h),s.h=null))}if(r.F){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.Da=e,Ne(r.I,r.F,e))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-e.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=e;if((r=n).wa=Nt(r,r.J?r.pa:null,r.Y),o.K){We(r.i,o);var c=o,u=r.L;u&&c.setTimeout(u),c.B&&(we(c),ye(c)),r.g=o}else bt(r);0<n.j.length&&_t(n)}else"stop"!=a[0]&&"close"!=a[0]||Ot(n,7);else 3==n.H&&("stop"==a[0]||"close"==a[0]?"stop"==a[0]?Ot(n,7):pt(n):"noop"!=a[0]&&n.h&&n.h.Aa(a),n.A=0)}ee()}catch(e){}}function Ee(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(r(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.ta&&"function"==typeof e.ta)return e.ta();if(!e.Z||"function"!=typeof e.Z){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(r(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),i=function(e){if(e.Z&&"function"==typeof e.Z)return e.Z();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(r(e)){for(var t=[],n=e.length,i=0;i<n;i++)t.push(e[i]);return t}for(i in t=[],n=0,e)t[n++]=e[i];return t}(e),s=i.length,o=0;o<s;o++)t.call(void 0,i[o],n&&n[o],e)}function ke(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof ke){this.h=e.h,Se(this,e.j),this.s=e.s,this.g=e.g,Oe(this,e.m),this.l=e.l;var t=e.i,n=new Me;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),Ae(this,n),this.o=e.o}else e&&(t=String(e).match(Hn))?(this.h=!1,Se(this,t[1]||"",!0),this.s=Re(t[2]||""),this.g=Re(t[3]||"",!0),Oe(this,t[4]),this.l=Re(t[5]||"",!0),Ae(this,t[6]||"",!0),this.o=Re(t[7]||"")):(this.h=!1,this.i=new Me(null,this.h))}function Ce(e){return new ke(e)}function Se(e,t,n){e.j=n?Re(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Oe(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Ae(e,t,n){t instanceof Me?(e.i=t,function(e,t){t&&!e.j&&(Le(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(je(this,t),Ue(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=De(t,Jn)),e.i=new Me(t,e.h))}function Ne(e,t,n){e.i.set(t,n)}function Pe(e){return Ne(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Re(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function De(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,xe),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function xe(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}function Me(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Le(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function je(e,t){Le(e),t=Ve(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Fe(e,t){return Le(e),t=Ve(e,t),e.g.has(t)}function Ue(e,t,n){je(e,t),0<n.length&&(e.i=null,e.g.set(Ve(e,t),h(n)),e.h+=n.length)}function Ve(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function qe(e){this.l=e||er,nn.PerformanceNavigationTiming?e=0<(e=nn.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(nn.g&&nn.g.Ka&&nn.g.Ka()&&nn.g.Ka().ec),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Be(e){return!!e.h||!!e.g&&e.g.size>=e.j}function ze(e){return e.h?1:e.g?e.g.size:0}function Ke(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function $e(e,t){e.g?e.g.add(t):e.h=t}function We(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function Ge(e){if(null!=e.h)return e.i.concat(e.h.F);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.F);return t}return h(e.i)}function He(){this.g=new tr}function Qe(e,t,n){const r=n||"";try{Ee(e,(function(e,n){let s=e;i(e)&&(s=An(e)),t.push(r+n+"="+encodeURIComponent(s))}))}catch(e){throw t.push(r+"type="+encodeURIComponent("_badmap")),e}}function Ye(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(e){}}function Xe(e){this.l=e.fc||null,this.j=e.ob||!1}function Je(e,t){j.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=nr,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}function Ze(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}function et(e){e.readyState=4,e.l=null,e.j=null,e.A=null,tt(e)}function tt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function nt(e){j.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=ir,this.L=this.M=!1}function rt(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,it(e),ot(e)}function it(e){e.F||(e.F=!0,F(e,"complete"),F(e,"error"))}function st(e){if(e.h&&void 0!==tn&&(!e.C[1]||4!=ct(e)||2!=e.da()))if(e.v&&4==ct(e))$(e.La,0,e);else if(F(e,"readystatechange"),4==ct(e)){e.h=!1;try{const o=e.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===o){var i=String(e.I).match(Hn)[1]||null;!i&&nn.self&&nn.self.location&&(i=nn.self.location.protocol.slice(0,-1)),r=!sr.test(i?i.toLowerCase():"")}n=r}if(n)F(e,"complete"),F(e,"success");else{e.m=6;try{var s=2<ct(e)?e.g.statusText:""}catch(e){s=""}e.j=s+" ["+e.da()+"]",it(e)}}finally{ot(e)}}}function ot(e,t){if(e.g){at(e);const n=e.g,r=e.C[0]?()=>{}:null;e.g=null,e.C=null,t||F(e,"ready");try{n.onreadystatechange=r}catch(e){}}}function at(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(nn.clearTimeout(e.A),e.A=null)}function ct(e){return e.g?e.g.readyState:0}function ut(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case ir:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function lt(e){let t="";return I(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function ht(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=lt(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):Ne(e,t,n))}function dt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function ft(e){this.Ga=0,this.j=[],this.l=new Y,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=dt("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=dt("baseRetryDelayMs",5e3,e),this.hb=dt("retryDelaySeedMs",1e4,e),this.eb=dt("forwardChannelMaxRetries",2,e),this.xa=dt("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.dc||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new qe(e&&e.concurrentRequestLimit),this.Ja=new He,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function pt(e){if(mt(e),3==e.H){var t=e.W++,n=Ce(e.I);if(Ne(n,"SID",e.K),Ne(n,"RID",t),Ne(n,"TYPE","terminate"),vt(e,n),(t=new he(e,e.l,t)).L=2,t.v=Pe(Ce(n)),n=!1,nn.navigator&&nn.navigator.sendBeacon)try{n=nn.navigator.sendBeacon(t.v.toString(),"")}catch(e){}!n&&nn.Image&&((new Image).src=t.v,n=!0),n||(t.g=Pt(t.l,null),t.g.ha(t.v)),t.G=Date.now(),ye(t)}At(e)}function gt(e){e.g&&(Tt(e),e.g.cancel(),e.g=null)}function mt(e){gt(e),e.u&&(nn.clearTimeout(e.u),e.u=null),kt(e),e.i.cancel(),e.m&&("number"==typeof e.m&&nn.clearTimeout(e.m),e.m=null)}function _t(e){if(!Be(e.i)&&!e.m){e.m=!0;var t=e.Na;Rn||Mn(),Dn||(Rn(),Dn=!0),xn.add(t,e),e.C=0}}function yt(e,t){var n;n=t?t.m:e.W++;const r=Ce(e.I);Ne(r,"SID",e.K),Ne(r,"RID",n),Ne(r,"AID",e.V),vt(e,r),e.o&&e.s&&ht(r,e.o,e.s),n=new he(e,e.l,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.j=t.F.concat(e.j)),t=wt(e,n,1e3),n.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),$e(e.i,n),fe(n,r,t)}function vt(e,t){e.na&&I(e.na,(function(e,n){Ne(t,n,e)})),e.h&&Ee({},(function(e,n){Ne(t,n,e)}))}function wt(e,t,n){n=Math.min(e.j.length,n);var r=e.h?a(e.h.Va,e.h,e):null;e:{var i=e.j;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<n;o++){let n=i[o].g;const a=i[o].map;if(n-=t,0>n)t=Math.max(0,i[o].g-100),s=!1;else try{Qe(a,e,"req"+n+"_")}catch(e){r&&r(a)}}if(s){r=e.join("&");break e}}}return e=e.j.splice(0,n),t.F=e,r}function bt(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;Rn||Mn(),Dn||(Rn(),Dn=!0),xn.add(t,e),e.A=0}}function It(e){return!(e.g||e.u||3<=e.A)&&(e.ba++,e.u=ie(a(e.Ma,e),St(e,e.A)),e.A++,!0)}function Tt(e){null!=e.B&&(nn.clearTimeout(e.B),e.B=null)}function Et(e){e.g=new he(e,e.l,"rpc",e.ba),null===e.o&&(e.g.I=e.s),e.g.O=0;var t=Ce(e.wa);Ne(t,"RID","rpc"),Ne(t,"SID",e.K),Ne(t,"AID",e.V),Ne(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&Ne(t,"TO",e.qa),Ne(t,"TYPE","xmlhttp"),vt(e,t),e.o&&e.s&&ht(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var n=e.g;e=e.pa,n.L=1,n.v=Pe(Ce(t)),n.s=null,n.S=!0,pe(n,e)}function kt(e){null!=e.v&&(nn.clearTimeout(e.v),e.v=null)}function Ct(e,t){var n=null;if(e.g==t){kt(e),Tt(e),e.g=null;var r=2}else{if(!Ke(e.i,t))return;n=t.F,We(e.i,t),r=1}if(0!=e.H)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.G;var i=e.C;F(r=J(),new re(r,n)),_t(e)}else bt(e);else if(3==(i=t.o)||0==i&&0<t.ca||!(1==r&&function(e,t){return!(ze(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.j=t.F.concat(e.j),0):1==e.H||2==e.H||e.C>=(e.cb?0:e.eb)||(e.m=ie(a(e.Na,e,t),St(e,e.C)),e.C++,0)))}(e,t)||2==r&&It(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:Ot(e,5);break;case 4:Ot(e,10);break;case 3:Ot(e,6);break;default:Ot(e,2)}}function St(e,t){let n=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(n*=2),n*t}function Ot(e,t){if(e.l.info("Error code "+t),2==t){var n=null;e.h&&(n=null);var r=a(e.pb,e);n||(n=new ke("//www.google.com/images/cleardot.gif"),nn.location&&"http"==nn.location.protocol||Se(n,"https"),Pe(n)),function(e,t){const n=new Y;if(nn.Image){const r=new Image;r.onload=c(Ye,n,r,"TestLoadImage: loaded",!0,t),r.onerror=c(Ye,n,r,"TestLoadImage: error",!1,t),r.onabort=c(Ye,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=c(Ye,n,r,"TestLoadImage: timeout",!1,t),nn.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else ne(2);e.H=0,e.h&&e.h.za(t),At(e),mt(e)}function At(e){if(e.H=0,e.ma=[],e.h){const t=Ge(e.i);0==t.length&&0==e.j.length||(d(e.ma,t),d(e.ma,e.j),e.i.i.length=0,h(e.j),e.j.length=0),e.h.ya()}}function Nt(e,t,n){var r=n instanceof ke?Ce(n):new ke(n);if(""!=r.g)t&&(r.g=t+"."+r.g),Oe(r,r.m);else{var i=nn.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var s=new ke(null);r&&Se(s,r),t&&(s.g=t),i&&Oe(s,i),n&&(s.l=n),r=s}return t=e.Da,(n=e.F)&&t&&Ne(r,n,t),Ne(r,"VER",e.ra),vt(e,r),r}function Pt(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new nt(n&&e.Ha&&!e.va?new Xe({ob:!0}):e.va)).Oa(e.J),t}function Rt(){}function Dt(){if(dn&&!(10<=Number(bn)))throw Error("Environmental error: no available transport.")}function xt(e,t){j.call(this),this.g=new ft(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!p(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!p(t)&&(this.g.F=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new jt(this)}function Mt(e){ce.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function Lt(){ue.call(this),this.status=1}function jt(e){this.g=e}function Ft(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function Ut(e,t,n){n||(n=0);var r=Array(16);if("string"==typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;var s=e.g[3],o=(t=e.g[0])+(s^(n=e.g[1])&((i=e.g[2])^s))+r[0]+3614090360&4294967295;o=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=n+(o<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(t=n+((o=t+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(t^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function Vt(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}function qt(e){return-128<=e&&128>e?function(e,t){var n=ar;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new Vt([0|e],0>e?-1:0)})):new Vt([0|e],0>e?-1:0)}function Bt(e){if(isNaN(e)||!isFinite(e))return ur;if(0>e)return $t(Bt(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=cr;return new Vt(t,0)}function zt(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function Kt(e){return-1==e.h}function $t(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new Vt(n,~e.h).add(lr)}function Wt(e,t){return e.add($t(t))}function Gt(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function Ht(e,t){this.g=e,this.h=t}function Qt(e,t){if(zt(t))throw Error("division by zero");if(zt(e))return new Ht(ur,ur);if(Kt(e))return t=Qt($t(e),t),new Ht($t(t.g),$t(t.h));if(Kt(t))return t=Qt(e,$t(t)),new Ht($t(t.g),t.h);if(30<e.g.length){if(Kt(e)||Kt(t))throw Error("slowDivide_ only works with positive integers.");for(var n=lr,r=t;0>=r.X(e);)n=Yt(n),r=Yt(r);var i=Xt(n,1),s=Xt(r,1);for(r=Xt(r,2),n=Xt(n,2);!zt(r);){var o=s.add(r);0>=o.X(e)&&(i=i.add(n),s=o),r=Xt(r,1),n=Xt(n,1)}return t=Wt(e,i.R(t)),new Ht(i,t)}for(i=ur;0<=e.X(t);){for(n=Math.max(1,Math.floor(e.ea()/t.ea())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),o=(s=Bt(n)).R(t);Kt(o)||0<o.X(e);)o=(s=Bt(n-=r)).R(t);zt(s)&&(s=lr),i=i.add(s),e=Wt(e,o)}return new Ht(i,e)}function Yt(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.D(r)<<1|e.D(r-1)>>>31;return new Vt(n,e.h)}function Xt(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,i=[],s=0;s<r;s++)i[s]=0<t?e.D(s+n)>>>t|e.D(s+n+1)<<32-t:e.D(s+n);return new Vt(i,e.h)}n.d(t,"a",(function(){return pr})),n.d(t,"b",(function(){return mr})),n.d(t,"c",(function(){return gr})),n.d(t,"d",(function(){return yr})),n.d(t,"e",(function(){return Ir})),n.d(t,"f",(function(){return br})),n.d(t,"g",(function(){return _r})),n.d(t,"h",(function(){return vr})),n.d(t,"i",(function(){return wr})),n.d(t,"j",(function(){return dr})),n.d(t,"k",(function(){return fr}));var Jt,Zt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},en={},tn=tn||{},nn=Zt||self,rn="closure_uid_"+(1e9*Math.random()>>>0),sn=0;l.prototype.s=!1,l.prototype.sa=function(){var e;!this.s&&(this.s=!0,this.N(),0)&&(e=this,Object.prototype.hasOwnProperty.call(e,rn)&&e[rn]||(e[rn]=++sn))},l.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const on=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};f.prototype.h=function(){this.defaultPrevented=!0};var an=function(){if(!nn.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{nn.addEventListener("test",(()=>{}),t),nn.removeEventListener("test",(()=>{}),t)}catch(e){}return e}();_[" "]=function(){};var cn,un,ln,hn=m("Opera"),dn=m("Trident")||m("MSIE"),fn=m("Edge"),pn=fn||dn,gn=m("Gecko")&&!(-1!=g().toLowerCase().indexOf("webkit")&&!m("Edge"))&&!(m("Trident")||m("MSIE"))&&!m("Edge"),mn=-1!=g().toLowerCase().indexOf("webkit")&&!m("Edge");e:{var _n="",yn=(un=g(),gn?/rv:([^\);]+)(\)|;)/.exec(un):fn?/Edge\/([\d\.]+)/.exec(un):dn?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(un):mn?/WebKit\/(\S+)/.exec(un):hn?/(?:Version)[ \/]?(\S+)/.exec(un):void 0);if(yn&&(_n=yn?yn[1]:""),dn){var vn=y();if(null!=vn&&vn>parseFloat(_n)){cn=String(vn);break e}}cn=_n}if(nn.document&&dn){var wn=y();ln=wn||(parseInt(cn,10)||void 0)}else ln=void 0;var bn=ln;u(v,f);var In={2:"touch",3:"pen",4:"mouse"};v.prototype.h=function(){v.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var Tn="closure_listenable_"+(1e6*Math.random()|0),En=0;const kn="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");k.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=S(e,t,r,i);return-1<o?(t=e[o],n||(t.ia=!1)):((t=new w(t,this.src,s,!!r,i)).ia=n,e.push(t)),t};var Cn="closure_lm_"+(1e6*Math.random()|0),Sn={},On="__closure_events_fn_"+(1e9*Math.random()>>>0);u(j,l),j.prototype[Tn]=!0,j.prototype.removeEventListener=function(e,t,n,r){P(this,e,t,n,r)},j.prototype.N=function(){if(j.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)b(n[r]);delete t.g[e],t.h--}}this.J=null},j.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},j.prototype.P=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var An=nn.JSON.stringify;var Nn=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new Pn),(e=>e.reset()));class Pn{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let Rn,Dn=!1,xn=new class{constructor(){this.h=this.g=null}add(e,t){const n=Nn.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},Mn=()=>{const e=nn.Promise.resolve(void 0);Rn=()=>{e.then(Ln)}};var Ln=()=>{for(var e;e=V();){try{e.h.call(e.g)}catch(e){B(e)}var t=Nn;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Dn=!1};u(z,j),(Jt=z.prototype).ga=!1,Jt.T=null,Jt.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),F(this,"tick"),this.ga&&(K(this),this.start()))}},Jt.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Jt.N=function(){z.$.N.call(this),K(this),delete this.g};class jn extends l{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:W(this)}N(){super.N(),this.g&&(nn.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}u(G,l);var Fn=[];G.prototype.N=function(){G.$.N.call(this),Q(this)},G.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Y.prototype.Ea=function(){this.g=!1},Y.prototype.info=function(){};var Un={},Vn=null;Un.Ta="serverreachability",u(Z,f),Un.STAT_EVENT="statevent",u(te,f),Un.Ua="timingevent",u(re,f);var qn={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Bn={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};se.prototype.h=null;var zn,Kn={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};u(ce,f),u(ue,f),u(le,se),le.prototype.g=function(){return new XMLHttpRequest},le.prototype.i=function(){return{}},zn=new le;var $n=45e3,Wn={},Gn={};(Jt=he.prototype).setTimeout=function(e){this.P=e},Jt.nb=function(e){e=e.target;const t=this.M;t&&3==ct(e)?t.l():this.Pa(e)},Jt.Pa=function(e){try{if(e==this.g)e:{const l=ct(this.g);var t=this.g.Ia();this.g.da();if(!(3>l)&&(3!=l||pn||this.g&&(this.h.h||this.g.ja()||ut(this.g)))){this.J||4!=l||7==t||ee(),we(this);var n=this.g.da();this.ca=n;t:if(ge(this)){var r=ut(this.g);e="";var i=r.length,s=4==ct(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Ie(this),be(this);var o="";break t}this.h.i=new nn.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:s&&t==i-1});r.splice(0,i),this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function(e,t,n,r,i,s,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o}))}(this.j,this.u,this.A,this.m,this.W,l,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(a)){var u=a;break t}}u=null}if(!(n=u)){this.i=!1,this.o=3,ne(12),Ie(this),be(this);break e}X(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Te(this,n)}this.S?(me(this,l,o),pn&&this.i&&3==l&&(H(this.U,this.V,"tick",this.mb),this.V.start())):(X(this.j,this.m,o,null),Te(this,o)),4==l&&Ie(this),this.i&&!this.J&&(4==l?Ct(this.l,this):(this.i=!1,ye(this)))}else(function(e){const t={};e=(e.g&&2<=ct(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(p(e[r]))continue;var n=q(e[r]);const i=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const s=t[i]||[];t[i]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.o=3,ne(12)):(this.o=0,ne(13)),Ie(this),be(this)}}}catch(e){}},Jt.mb=function(){if(this.g){var e=ct(this.g),t=this.g.ja();this.C<t.length&&(we(this),me(this,e,t),this.i&&4!=e&&ye(this))}},Jt.cancel=function(){this.J=!0,Ie(this)},Jt.lb=function(){this.B=null;const e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.L&&(ee(),ne(17)),Ie(this),this.o=2,be(this)):ve(this,this.Y-e)};var Hn=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");ke.prototype.toString=function(){var e=[],t=this.j;t&&e.push(De(t,Qn,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(De(t,Qn,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(De(n,"/"==n.charAt(0)?Xn:Yn,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",De(n,Zn)),e.join("")};var Qn=/[#\/\?@]/g,Yn=/[#\?:]/g,Xn=/[#\?]/g,Jn=/[#\?@]/g,Zn=/#/g;(Jt=Me.prototype).add=function(e,t){Le(this),this.i=null,e=Ve(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},Jt.forEach=function(e,t){Le(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},Jt.ta=function(){Le(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const i=e[r];for(let e=0;e<i.length;e++)n.push(t[r])}return n},Jt.Z=function(e){Le(this);let t=[];if("string"==typeof e)Fe(this,e)&&(t=t.concat(this.g.get(Ve(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},Jt.set=function(e,t){return Le(this),this.i=null,Fe(this,e=Ve(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},Jt.get=function(e,t){return e&&0<(e=this.Z(e)).length?String(e[0]):t},Jt.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),e.push(i)}}return this.i=e.join("&")};var er=10;qe.prototype.cancel=function(){if(this.i=Ge(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var tr=class{stringify(e){return nn.JSON.stringify(e,void 0)}parse(e){return nn.JSON.parse(e,void 0)}};u(Xe,se),Xe.prototype.g=function(){return new Je(this.l,this.j)},Xe.prototype.i=function(e){return function(){return e}}({}),u(Je,j);var nr=0;(Jt=Je.prototype).open=function(e,t){if(this.readyState!=nr)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,tt(this)},Jt.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||nn).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))},Jt.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,et(this)),this.readyState=nr},Jt.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,tt(this)),this.g&&(this.readyState=3,tt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==nn.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Ze(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))},Jt.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?et(this):tt(this),3==this.readyState&&Ze(this)}},Jt.Za=function(e){this.g&&(this.response=this.responseText=e,et(this))},Jt.Ya=function(e){this.g&&(this.response=e,et(this))},Jt.ka=function(){this.g&&et(this)},Jt.setRequestHeader=function(e,t){this.v.append(e,t)},Jt.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},Jt.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)e.push((n=n.value)[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Je.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var rr=nn.JSON.parse;u(nt,j);var ir="",sr=/^https?$/i,or=["POST","PUT"];(Jt=nt.prototype).Oa=function(e){this.M=e},Jt.ha=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():zn.g(),this.C=oe(this.u?this.u:zn),this.g.onreadystatechange=a(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(e){return void rt(this,e)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),i=nn.FormData&&e instanceof nn.FormData,!(0<=on(or,t))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[e,t]of n)this.g.setRequestHeader(e,t);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{at(this),0<this.B&&((this.L=function(e){return dn&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=a(this.ua,this)):this.A=$(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(e){rt(this,e)}},Jt.ua=function(){void 0!==tn&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,F(this,"timeout"),this.abort(8))},Jt.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,F(this,"complete"),F(this,"abort"),ot(this))},Jt.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),ot(this,!0)),nt.$.N.call(this)},Jt.La=function(){this.s||(this.G||this.v||this.l?st(this):this.kb())},Jt.kb=function(){st(this)},Jt.isActive=function(){return!!this.g},Jt.da=function(){try{return 2<ct(this)?this.g.status:-1}catch(e){return-1}},Jt.ja=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},Jt.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),rr(t)}},Jt.Ia=function(){return this.m},Jt.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(Jt=ft.prototype).ra=8,Jt.H=1,Jt.Na=function(e){if(this.m)if(this.m=null,1==this.H){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;const i=new he(this,this.l,e);let s=this.s;if(this.U&&(s?(s=T(s),E(s,this.U)):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)e:{for(var t=0,n=0;n<this.j.length;n++){var r=this.j[n];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.j.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=wt(this,i,t),Ne(n=Ce(this.I),"RID",e),Ne(n,"CVER",22),this.F&&Ne(n,"X-HTTP-Session-Id",this.F),vt(this,n),s&&(this.O?t="headers="+encodeURIComponent(String(lt(s)))+"&"+t:this.o&&ht(n,this.o,s)),$e(this.i,i),this.bb&&Ne(n,"TYPE","init"),this.P?(Ne(n,"$req",t),Ne(n,"SID","null"),i.aa=!0,fe(i,n,null)):fe(i,n,t),this.H=2}}else 3==this.H&&(e?yt(this,e):0==this.j.length||Be(this.i)||yt(this))},Jt.Ma=function(){if(this.u=null,Et(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=ie(a(this.jb,this),e)}},Jt.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,ne(10),gt(this),Et(this))},Jt.ib=function(){null!=this.v&&(this.v=null,gt(this),It(this),ne(19))},Jt.pb=function(e){e?(this.l.info("Successfully pinged google.com"),ne(2)):(this.l.info("Failed to ping google.com"),ne(1))},Jt.isActive=function(){return!!this.h&&this.h.isActive(this)},(Jt=Rt.prototype).Ba=function(){},Jt.Aa=function(){},Jt.za=function(){},Jt.ya=function(){},Jt.isActive=function(){return!0},Jt.Va=function(){},Dt.prototype.g=function(e,t){return new xt(e,t)},u(xt,j),xt.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;ne(0),e.Y=t,e.na=n||{},e.G=e.aa,e.I=Nt(e,null,e.Y),_t(e)},xt.prototype.close=function(){pt(this.g)},xt.prototype.u=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=An(e),e=n);t.j.push(new class{constructor(e,t){this.g=e,this.map=t}}(t.fb++,e)),3==t.H&&_t(t)},xt.prototype.N=function(){this.g.h=null,delete this.j,pt(this.g),delete this.g,xt.$.N.call(this)},u(Mt,ce),u(Lt,ue),u(jt,Rt),jt.prototype.Ba=function(){F(this.g,"a")},jt.prototype.Aa=function(e){F(this.g,new Mt(e))},jt.prototype.za=function(){F(this.g,new Lt)},jt.prototype.ya=function(){F(this.g,"b")},u(Ft,(function(){this.blockSize=-1})),Ft.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Ft.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=this.m,i=this.h,s=0;s<t;){if(0==i)for(;s<=n;)Ut(this,e,s),s+=this.blockSize;if("string"==typeof e){for(;s<t;)if(r[i++]=e.charCodeAt(s++),i==this.blockSize){Ut(this,r),i=0;break}}else for(;s<t;)if(r[i++]=e[s++],i==this.blockSize){Ut(this,r),i=0;break}}this.h=i,this.i+=t},Ft.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var ar={},cr=4294967296,ur=qt(0),lr=qt(1),hr=qt(16777216);(Jt=Vt.prototype).ea=function(){if(Kt(this))return-$t(this).ea();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.D(n);e+=(0<=r?r:cr+r)*t,t*=cr}return e},Jt.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(zt(this))return"0";if(Kt(this))return"-"+$t(this).toString(e);for(var t=Bt(Math.pow(e,6)),n=this,r="";;){var i=Qt(n,t).g,s=((0<(n=Wt(n,i.R(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(zt(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},Jt.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},Jt.X=function(e){return Kt(e=Wt(this,e))?-1:zt(e)?0:1},Jt.abs=function(){return Kt(this)?$t(this):this},Jt.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,i=0;i<=t;i++){var s=r+(65535&this.D(i))+(65535&e.D(i)),o=(s>>>16)+(this.D(i)>>>16)+(e.D(i)>>>16);r=o>>>16,n[i]=(o&=65535)<<16|(s&=65535)}return new Vt(n,-2147483648&n[n.length-1]?-1:0)},Jt.R=function(e){if(zt(this)||zt(e))return ur;if(Kt(this))return Kt(e)?$t(this).R($t(e)):$t($t(this).R(e));if(Kt(e))return $t(this.R($t(e)));if(0>this.X(hr)&&0>e.X(hr))return Bt(this.ea()*e.ea());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<e.g.length;i++){var s=this.D(r)>>>16,o=65535&this.D(r),a=e.D(i)>>>16,c=65535&e.D(i);n[2*r+2*i]+=o*c,Gt(n,2*r+2*i),n[2*r+2*i+1]+=s*c,Gt(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,Gt(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,Gt(n,2*r+2*i+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new Vt(n,0)},Jt.gb=function(e){return Qt(this,e).h},Jt.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)&e.D(r);return new Vt(n,this.h&e.h)},Jt.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)|e.D(r);return new Vt(n,this.h|e.h)},Jt.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)^e.D(r);return new Vt(n,this.h^e.h)},Dt.prototype.createWebChannel=Dt.prototype.g,xt.prototype.send=xt.prototype.u,xt.prototype.open=xt.prototype.m,xt.prototype.close=xt.prototype.close,qn.NO_ERROR=0,qn.TIMEOUT=8,qn.HTTP_ERROR=6,Bn.COMPLETE="complete",ae.EventType=Kn,Kn.OPEN="a",Kn.CLOSE="b",Kn.ERROR="c",Kn.MESSAGE="d",j.prototype.listen=j.prototype.O,nt.prototype.listenOnce=nt.prototype.P,nt.prototype.getLastError=nt.prototype.Sa,nt.prototype.getLastErrorCode=nt.prototype.Ia,nt.prototype.getStatus=nt.prototype.da,nt.prototype.getResponseJson=nt.prototype.Wa,nt.prototype.getResponseText=nt.prototype.ja,nt.prototype.send=nt.prototype.ha,nt.prototype.setWithCredentials=nt.prototype.Oa,Ft.prototype.digest=Ft.prototype.l,Ft.prototype.reset=Ft.prototype.reset,Ft.prototype.update=Ft.prototype.j,Vt.prototype.add=Vt.prototype.add,Vt.prototype.multiply=Vt.prototype.R,Vt.prototype.modulo=Vt.prototype.gb,Vt.prototype.compare=Vt.prototype.X,Vt.prototype.toNumber=Vt.prototype.ea,Vt.prototype.toString=Vt.prototype.toString,Vt.prototype.getBits=Vt.prototype.D,Vt.fromNumber=Bt,Vt.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return $t(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=Bt(Math.pow(n,8)),i=ur,s=0;s<t.length;s+=8){var o=Math.min(8,t.length-s),a=parseInt(t.substring(s,s+o),n);8>o?(o=Bt(Math.pow(n,o)),i=i.R(o).add(Bt(a))):i=(i=i.R(r)).add(Bt(a))}return i};var dr=en.createWebChannelTransport=function(){return new Dt},fr=en.getStatEventTarget=function(){return J()},pr=en.ErrorCode=qn,gr=en.EventType=Bn,mr=en.Event=Un,_r=en.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},yr=en.FetchXmlHttpFactory=Xe,vr=en.WebChannel=ae,wr=en.XhrIo=nt,br=en.Md5=Ft,Ir=en.Integer=Vt}).call(this,n("pCvA"))},"Pq/i":function(e,t,n){"use strict";n.r(t);var r=n("hosL");const{h:i,render:s,hydrate:o}=r,a=e=>e&&e.default?e.default:e,c=e=>"/"===e[e.length-1]?e:e+"/";if("serviceWorker"in navigator&&navigator.serviceWorker.register(c(n.p)+"sw-esm.js"),"function"==typeof a(n("QfWi"))){let e=document.getElementById("preact_root")||document.body.firstElementChild,t=()=>{let t=a(n("QfWi")),r={};const o=document.querySelector('[type="__PREACT_CLI_DATA__"]');o&&(r=JSON.parse(decodeURI(o.innerHTML)).preRenderData||r);const u={preRenderData:r};r.url&&c(r.url);s(i(t,{CLI_DATA:u}),document.body,e)};0,t()}},QfWi:function(e,t,n){"use strict";n.r(t);var r=n("83Vu");t.default=r.a},SgqZ:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o}));var r=n("8HXZ");class i{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const s="[DEFAULT]";class o{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new r.a;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:s})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e=s){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e=s){return this.instances.has(e)}getOptions(e=s){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(e)&&t.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===s?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var r;return n||null}normalizeInstanceIdentifier(e=s){return this.component?this.component.multipleInstances?e:s:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class a{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new o(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}},YfkF:function(e,t,n){"use strict";function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}n.d(t,"a",(function(){return d}));var i=n("8HXZ"),s=n("SgqZ"),o=n("xsHj"),a=n("li6C");class c{constructor(e,t){this._delegate=e,this.firebase=t,Object(o._addComponent)(e,new s.a("app-compat",(()=>this),"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise((e=>{this._delegate.checkDestroyed(),e()})).then((()=>(this.firebase.INTERNAL.removeApp(this.name),Object(o.deleteApp)(this._delegate))))}_getService(e,t=o._DEFAULT_ENTRY_NAME){var n;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e,t=o._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Object(o._addComponent)(this._delegate,e)}_addOrOverwriteComponent(e){Object(o._addOrOverwriteComponent)(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const u=new i.b("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),l=function e(){const t=function(e){function t(e){if(e=e||o._DEFAULT_ENTRY_NAME,!Object(i.m)(n,e))throw u.create("no-app",{appName:e});return n[e]}const n={},r={__esModule:!0,initializeApp:function(t,s={}){const a=o.initializeApp(t,s);if(Object(i.m)(n,a.name))return n[a.name];const c=new e(a,r);return n[a.name]=c,c},app:t,registerVersion:o.registerVersion,setLogLevel:o.setLogLevel,onLog:o.onLog,apps:null,SDK_VERSION:o.SDK_VERSION,INTERNAL:{registerComponent:function(n){const s=n.name,a=s.replace("-compat","");if(o._registerComponent(n)&&"PUBLIC"===n.type){const o=(e=t())=>{if("function"!=typeof e[a])throw u.create("invalid-app-argument",{appName:s});return e[a]()};void 0!==n.serviceProps&&Object(i.r)(o,n.serviceProps),r[a]=o,e.prototype[a]=function(...e){return this._getService.bind(this,s).apply(this,n.multipleInstances?e:[])}}return"PUBLIC"===n.type?r[a]:null},removeApp:function(e){delete n[e]},useAsService:function(e,t){return"serverAuth"===t?null:t},modularAPIs:o}};return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(n).map((e=>n[e]))}}),t.App=e,r}(c);return t.INTERNAL=r(r({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){Object(i.r)(t,e)},createSubscribe:i.o,ErrorFactory:i.b,deepExtend:i.r}),t}(),h=new a.b("@firebase/app-compat");if(Object(i.C)()&&void 0!==self.firebase){h.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const e=self.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&h.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const d=l;var f;Object(o.registerVersion)("@firebase/app-compat","0.2.15",f)},gBRc:function(e,t,n){"use strict";(function(e){function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}var i=n("8WOM");t.a=t=>{r({},(function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(t),t));return e("div",{id:"app"},e("div",{class:"vote_panel"},e("div",{class:"title"},"Oceń smak"),e(i.a,null)))}}).call(this,n("hosL").h)},gUA9:function(e,t,n){"use strict";var r=n("xsHj");Object(r.registerVersion)("firebase","10.1.0","app");var i=n("Dans");const s=Object(r.initializeApp)({apiKey:"AIzaSyAmLTb6IpHcyJhHZe67o5PWwA7VqibKAk8",authDomain:"foodtrack-5b0cc.firebaseapp.com",projectId:"foodtrack-5b0cc",storageBucket:"foodtrack-5b0cc.appspot.com",messagingSenderId:"894812303321",appId:"1:894812303321:web:1cdb32f1e03fbff682f3c8",measurementId:"G-C0ZPGQRBV3"}),o=Object(i.c)(s);t.a=o},hosL:function(e,t,n){"use strict";function r(e,t){for(var n in t)e[n]=t[n];return e}function i(e){var t=e.parentNode;t&&t.removeChild(e)}function s(e,t,n){var r,i,s,a={};for(s in t)"key"==s?r=t[s]:"ref"==s?i=t[s]:a[s]=t[s];if(arguments.length>2&&(a.children=arguments.length>3?D.call(arguments,2):n),"function"==typeof e&&null!=e.defaultProps)for(s in e.defaultProps)void 0===a[s]&&(a[s]=e.defaultProps[s]);return o(e,a,r,i,null)}function o(e,t,n,r,i){var s={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==i?++M:i};return null==i&&null!=x.vnode&&x.vnode(s),s}function a(){return{current:null}}function c(e){return e.children}function u(e,t){this.props=e,this.context=t}function l(e,t){if(null==t)return e.__?l(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?l(e):null}function h(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return h(e)}}function d(e){(!e.__d&&(e.__d=!0)&&j.push(e)&&!f.__r++||F!==x.debounceRendering)&&((F=x.debounceRendering)||U)(f)}function f(){var e,t,n,i,s,o,a,c,u;for(j.sort(V);e=j.shift();)e.__d&&(t=j.length,i=void 0,s=void 0,o=void 0,c=(a=(n=e).__v).__e,(u=n.__P)&&(i=[],s=[],(o=r({},a)).__v=a.__v+1,T(u,a,o,n.__n,void 0!==u.ownerSVGElement,null!=a.__h?[c]:null,i,null==c?l(a):c,a.__h,s),E(i,a,s),a.__e!=c&&h(a)),j.length>t&&j.sort(V));f.__r=0}function p(e,t,n,r,i,s,a,u,l,h,d){var f,p,m,v,w,b,I,E,k,O,A=0,N=r&&r.__k||z,P=N.length,R=P,D=t.length;for(n.__k=[],f=0;f<D;f++)null!=(v=n.__k[f]=null==(v=t[f])||"boolean"==typeof v||"function"==typeof v?null:"string"==typeof v||"number"==typeof v||"bigint"==typeof v?o(null,v,null,null,v):$(v)?o(c,{children:v},null,null,null):v.__b>0?o(v.type,v.props,v.key,v.ref?v.ref:null,v.__v):v)&&(v.__=n,v.__b=n.__b+1,-1===(E=y(v,N,I=f+A,R))?m=B:(m=N[E]||B,N[E]=void 0,R--),T(e,v,m,i,s,a,u,l,h,d),w=v.__e,(p=v.ref)&&m.ref!=p&&(m.ref&&C(m.ref,null,v),d.push(p,v.__c||w,v)),null!=w&&(null==b&&(b=w),O=!(k=m===B||null===m.__v)&&E===I,k?-1==E&&A--:E!==I&&(E===I+1?(A++,O=!0):E>I?R>D-I?(A+=E-I,O=!0):A--:A=E<I&&E==I-1?E-I:0),I=f+A,O=O||E==f&&!k,"function"!=typeof v.type||E===I&&m.__k!==v.__k?"function"==typeof v.type||O?void 0!==v.__d?(l=v.__d,v.__d=void 0):l=w.nextSibling:l=_(e,w,l):l=g(v,l,e),"function"==typeof n.type&&(n.__d=l)));for(n.__e=b,f=P;f--;)null!=N[f]&&("function"==typeof n.type&&null!=N[f].__e&&N[f].__e==n.__d&&(n.__d=N[f].__e.nextSibling),S(N[f],N[f]))}function g(e,t,n){for(var r,i=e.__k,s=0;i&&s<i.length;s++)(r=i[s])&&(r.__=e,t="function"==typeof r.type?g(r,t,n):_(n,r.__e,t));return t}function m(e,t){return t=t||[],null==e||"boolean"==typeof e||($(e)?e.some((function(e){m(e,t)})):t.push(e)),t}function _(e,t,n){return null==n||n.parentNode!==e?e.insertBefore(t,null):t==n&&null!=t.parentNode||e.insertBefore(t,n),t.nextSibling}function y(e,t,n,r){var i=e.key,s=e.type,o=n-1,a=n+1,c=t[n];if(null===c||c&&i==c.key&&s===c.type)return n;if(r>(null!=c?1:0))for(;o>=0||a<t.length;){if(o>=0){if((c=t[o])&&i==c.key&&s===c.type)return o;o--}if(a<t.length){if((c=t[a])&&i==c.key&&s===c.type)return a;a++}}return-1}function v(e,t,n){"-"===t[0]?e.setProperty(t,null==n?"":n):e[t]=null==n?"":"number"!=typeof n||K.test(t)?n:n+"px"}function w(e,t,n,r,i){var s;e:if("style"===t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof r&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||v(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||v(e.style,t,n[t])}else if("o"===t[0]&&"n"===t[1])s=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+s]=n,n?r||e.addEventListener(t,s?I:b,s):e.removeEventListener(t,s?I:b,s);else if("dangerouslySetInnerHTML"!==t){if(i)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!==t&&"height"!==t&&"href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&"rowSpan"!==t&&"colSpan"!==t&&t in e)try{e[t]=null==n?"":n;break e}catch(e){}"function"==typeof n||(null==n||!1===n&&"-"!==t[4]?e.removeAttribute(t):e.setAttribute(t,n))}}function b(e){return this.l[e.type+!1](x.event?x.event(e):e)}function I(e){return this.l[e.type+!0](x.event?x.event(e):e)}function T(e,t,n,i,s,o,a,l,h,d){var f,g,m,_,y,v,w,b,I,T,E,C,S,A,N,P=t.type;if(void 0!==t.constructor)return null;null!=n.__h&&(h=n.__h,l=t.__e=n.__e,t.__h=null,o=[l]),(f=x.__b)&&f(t);try{e:if("function"==typeof P){if(b=t.props,I=(f=P.contextType)&&i[f.__c],T=f?I?I.props.value:f.__:i,n.__c?w=(g=t.__c=n.__c).__=g.__E:("prototype"in P&&P.prototype.render?t.__c=g=new P(b,T):(t.__c=g=new u(b,T),g.constructor=P,g.render=O),I&&I.sub(g),g.props=b,g.state||(g.state={}),g.context=T,g.__n=i,m=g.__d=!0,g.__h=[],g._sb=[]),null==g.__s&&(g.__s=g.state),null!=P.getDerivedStateFromProps&&(g.__s==g.state&&(g.__s=r({},g.__s)),r(g.__s,P.getDerivedStateFromProps(b,g.__s))),_=g.props,y=g.state,g.__v=t,m)null==P.getDerivedStateFromProps&&null!=g.componentWillMount&&g.componentWillMount(),null!=g.componentDidMount&&g.__h.push(g.componentDidMount);else{if(null==P.getDerivedStateFromProps&&b!==_&&null!=g.componentWillReceiveProps&&g.componentWillReceiveProps(b,T),!g.__e&&(null!=g.shouldComponentUpdate&&!1===g.shouldComponentUpdate(b,g.__s,T)||t.__v===n.__v)){for(t.__v!==n.__v&&(g.props=b,g.state=g.__s,g.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.forEach((function(e){e&&(e.__=t)})),E=0;E<g._sb.length;E++)g.__h.push(g._sb[E]);g._sb=[],g.__h.length&&a.push(g);break e}null!=g.componentWillUpdate&&g.componentWillUpdate(b,g.__s,T),null!=g.componentDidUpdate&&g.__h.push((function(){g.componentDidUpdate(_,y,v)}))}if(g.context=T,g.props=b,g.__P=e,g.__e=!1,C=x.__r,S=0,"prototype"in P&&P.prototype.render){for(g.state=g.__s,g.__d=!1,C&&C(t),f=g.render(g.props,g.state,g.context),A=0;A<g._sb.length;A++)g.__h.push(g._sb[A]);g._sb=[]}else do{g.__d=!1,C&&C(t),f=g.render(g.props,g.state,g.context),g.state=g.__s}while(g.__d&&++S<25);g.state=g.__s,null!=g.getChildContext&&(i=r(r({},i),g.getChildContext())),m||null==g.getSnapshotBeforeUpdate||(v=g.getSnapshotBeforeUpdate(_,y)),p(e,$(N=null!=f&&f.type===c&&null==f.key?f.props.children:f)?N:[N],t,n,i,s,o,a,l,h,d),g.base=t.__e,t.__h=null,g.__h.length&&a.push(g),w&&(g.__E=g.__=null)}else null==o&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=k(n.__e,t,n,i,s,o,a,h,d);(f=x.diffed)&&f(t)}catch(e){t.__v=null,(h||null!=o)&&(t.__e=l,t.__h=!!h,o[o.indexOf(l)]=null),x.__e(e,t,n)}}function E(e,t,n){for(var r=0;r<n.length;r++)C(n[r],n[++r],n[++r]);x.__c&&x.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){x.__e(e,t.__v)}}))}function k(e,t,n,r,s,o,a,c,u){var h,d,f,g=n.props,m=t.props,_=t.type,y=0;if("svg"===_&&(s=!0),null!=o)for(;y<o.length;y++)if((h=o[y])&&"setAttribute"in h==!!_&&(_?h.localName===_:3===h.nodeType)){e=h,o[y]=null;break}if(null==e){if(null===_)return document.createTextNode(m);e=s?document.createElementNS("http://www.w3.org/2000/svg",_):document.createElement(_,m.is&&m),o=null,c=!1}if(null===_)g===m||c&&e.data===m||(e.data=m);else{if(o=o&&D.call(e.childNodes),d=(g=n.props||B).dangerouslySetInnerHTML,f=m.dangerouslySetInnerHTML,!c){if(null!=o)for(g={},y=0;y<e.attributes.length;y++)g[e.attributes[y].name]=e.attributes[y].value;(f||d)&&(f&&(d&&f.__html==d.__html||f.__html===e.innerHTML)||(e.innerHTML=f&&f.__html||""))}if(function(e,t,n,r,i){var s;for(s in n)"children"===s||"key"===s||s in t||w(e,s,null,n[s],r);for(s in t)i&&"function"!=typeof t[s]||"children"===s||"key"===s||"value"===s||"checked"===s||n[s]===t[s]||w(e,s,t[s],n[s],r)}(e,m,g,s,c),f)t.__k=[];else if(p(e,$(y=t.props.children)?y:[y],t,n,r,s&&"foreignObject"!==_,o,a,o?o[0]:n.__k&&l(n,0),c,u),null!=o)for(y=o.length;y--;)null!=o[y]&&i(o[y]);c||("value"in m&&void 0!==(y=m.value)&&(y!==e.value||"progress"===_&&!y||"option"===_&&y!==g.value)&&w(e,"value",y,g.value,!1),"checked"in m&&void 0!==(y=m.checked)&&y!==e.checked&&w(e,"checked",y,g.checked,!1))}return e}function C(e,t,n){try{"function"==typeof e?e(t):e.current=t}catch(e){x.__e(e,n)}}function S(e,t,n){var r,s;if(x.unmount&&x.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||C(r,null,t)),null!=(r=e.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(e){x.__e(e,t)}r.base=r.__P=null,e.__c=void 0}if(r=e.__k)for(s=0;s<r.length;s++)r[s]&&S(r[s],t,n||"function"!=typeof e.type);n||null==e.__e||i(e.__e),e.__=e.__e=e.__d=void 0}function O(e,t,n){return this.constructor(e,n)}function A(e,t,n){var r,i,o,a;x.__&&x.__(e,t),i=(r="function"==typeof n)?null:n&&n.__k||t.__k,o=[],a=[],T(t,e=(!r&&n||t).__k=s(c,null,[e]),i||B,B,void 0!==t.ownerSVGElement,!r&&n?[n]:i?null:t.firstChild?D.call(t.childNodes):null,o,!r&&n?n:i?i.__e:t.firstChild,r,a),E(o,e,a)}function N(e,t){A(e,t,N)}function P(e,t,n){var i,s,a,c,u=r({},e.props);for(a in e.type&&e.type.defaultProps&&(c=e.type.defaultProps),t)"key"==a?i=t[a]:"ref"==a?s=t[a]:u[a]=void 0===t[a]&&void 0!==c?c[a]:t[a];return arguments.length>2&&(u.children=arguments.length>3?D.call(arguments,2):n),o(e.type,u,i||e.key,s||e.ref,null)}function R(e,t){var n={__c:t="__cC"+q++,__:e,Consumer:function(e,t){return e.children(t)},Provider:function(e){var n,r;return this.getChildContext||(n=[],(r={})[t]=this,this.getChildContext=function(){return r},this.shouldComponentUpdate=function(e){this.props.value!==e.value&&n.some((function(e){e.__e=!0,d(e)}))},this.sub=function(e){n.push(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){n.splice(n.indexOf(e),1),t&&t.call(e)}}),e.children}};return n.Provider.__=n.Consumer.contextType=n}n.r(t),n.d(t,"Component",(function(){return u})),n.d(t,"Fragment",(function(){return c})),n.d(t,"cloneElement",(function(){return P})),n.d(t,"createContext",(function(){return R})),n.d(t,"createElement",(function(){return s})),n.d(t,"createRef",(function(){return a})),n.d(t,"h",(function(){return s})),n.d(t,"hydrate",(function(){return N})),n.d(t,"isValidElement",(function(){return L})),n.d(t,"options",(function(){return x})),n.d(t,"render",(function(){return A})),n.d(t,"toChildArray",(function(){return m}));var D,x,M,L,j,F,U,V,q,B={},z=[],K=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,$=Array.isArray;D=z.slice,x={__e:function(e,t,n,r){for(var i,s,o;t=t.__;)if((i=t.__c)&&!i.__)try{if((s=i.constructor)&&null!=s.getDerivedStateFromError&&(i.setState(s.getDerivedStateFromError(e)),o=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(e,r||{}),o=i.__d),o)return i.__E=i}catch(t){e=t}throw e}},M=0,L=function(e){return null!=e&&void 0===e.constructor},u.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=r({},this.state),"function"==typeof e&&(e=e(r({},n),this.props)),e&&r(n,e),null!=e&&this.__v&&(t&&this._sb.push(t),d(this))},u.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),d(this))},u.prototype.render=c,j=[],U="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,V=function(e,t){return e.__v.__b-t.__v.__b},f.__r=0,q=0},l8WD:function(e,t,n){"use strict";function r(e,t){O.options.__h&&O.options.__h(k,e,A||t),A=0;var n=k.__H||(k.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({__V:P}),n.__[e]}function i(e){return A=1,s(d,e)}function s(e,t,n){var i=r(E++,2);if(i.t=e,!i.__c&&(i.__=[n?n(t):d(void 0,t),function(e){var t=i.__N?i.__N[0]:i.__[0],n=i.t(t,e);t!==n&&(i.__N=[n,i.__[1]],i.__c.setState({}))}],i.__c=k,!k.u)){var s=function(e,t,n){if(!i.__c.__H)return!0;var r=i.__c.__H.__.filter((function(e){return e.__c}));if(r.every((function(e){return!e.__N})))return!o||o.call(this,e,t,n);var s=!1;return r.forEach((function(e){if(e.__N){var t=e.__[0];e.__=e.__N,e.__N=void 0,t!==e.__[0]&&(s=!0)}})),!(!s&&i.__c.props===e)&&(!o||o.call(this,e,t,n))};k.u=!0;var o=k.shouldComponentUpdate,a=k.componentWillUpdate;k.componentWillUpdate=function(e,t,n){if(this.__e){var r=o;o=void 0,s(e,t,n),o=r}a&&a.call(this,e,t,n)},k.shouldComponentUpdate=s}return i.__N||i.__}function o(e,t){var n=r(E++,3);!O.options.__s&&h(n.__H,t)&&(n.__=e,n.i=t,k.__H.__h.push(n))}function a(){for(var e;e=N.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(u),e.__H.__h.forEach(l),e.__H.__h=[]}catch(t){e.__H.__h=[],O.options.__e(t,e.__v)}}function c(e){var t,n=function(){clearTimeout(r),j&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);j&&(t=requestAnimationFrame(n))}function u(e){var t=k,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),k=t}function l(e){var t=k;e.__c=e.__(),k=t}function h(e,t){return!e||e.length!==t.length||t.some((function(t,n){return t!==e[n]}))}function d(e,t){return"function"==typeof t?t(e):t}function f(e,t){for(var n in t)e[n]=t[n];return e}function p(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function g(e){this.props=e}function m(e,t,n){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),e.__c.__H=null),null!=(e=f({},e)).__c&&(e.__c.__P===n&&(e.__c.__P=t),e.__c=null),e.__k=e.__k&&e.__k.map((function(e){return m(e,t,n)}))),e}function _(e,t,n){return e&&(e.__v=null,e.__k=e.__k&&e.__k.map((function(e){return _(e,t,n)})),e.__c&&e.__c.__P===t&&(e.__e&&n.insertBefore(e.__e,e.__d),e.__c.__e=!0,e.__c.__P=n)),e}function y(){this.__u=0,this.t=null,this.__b=null}function v(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function w(){this.u=null,this.o=null}function b(){}function I(){return this.cancelBubble}function T(){return this.defaultPrevented}n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var E,k,C,S,O=n("hosL"),A=0,N=[],P=[],R=O.options.__b,D=O.options.__r,x=O.options.diffed,M=O.options.__c,L=O.options.unmount;O.options.__b=function(e){k=null,R&&R(e)},O.options.__r=function(e){D&&D(e),E=0;var t=(k=e.__c).__H;t&&(C===k?(t.__h=[],k.__h=[],t.__.forEach((function(e){e.__N&&(e.__=e.__N),e.__V=P,e.__N=e.i=void 0}))):(t.__h.forEach(u),t.__h.forEach(l),t.__h=[],E=0)),C=k},O.options.diffed=function(e){x&&x(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==N.push(t)&&S===O.options.requestAnimationFrame||((S=O.options.requestAnimationFrame)||c)(a)),t.__H.__.forEach((function(e){e.i&&(e.__H=e.i),e.__V!==P&&(e.__=e.__V),e.i=void 0,e.__V=P}))),C=k=null},O.options.__c=function(e,t){t.some((function(e){try{e.__h.forEach(u),e.__h=e.__h.filter((function(e){return!e.__||l(e)}))}catch(n){t.some((function(e){e.__h&&(e.__h=[])})),t=[],O.options.__e(n,e.__v)}})),M&&M(e,t)},O.options.unmount=function(e){L&&L(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{u(e)}catch(e){t=e}})),n.__H=void 0,t&&O.options.__e(t,n.__v))};var j="function"==typeof requestAnimationFrame;(g.prototype=new O.Component).isPureReactComponent=!0,g.prototype.shouldComponentUpdate=function(e,t){return p(this.props,e)||p(this.state,t)};var F=O.options.__b;O.options.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),F&&F(e)};"undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref");var U=O.options.__e;O.options.__e=function(e,t,n,r){if(e.then)for(var i,s=t;s=s.__;)if((i=s.__c)&&i.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),i.__c(e,t);U(e,t,n,r)};var V=O.options.unmount;O.options.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),V&&V(e)},(y.prototype=new O.Component).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var i=v(r.__v),s=!1,o=function(){s||(s=!0,n.__R=null,i?i(a):a())};n.__R=o;var a=function(){if(!--r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=_(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.t.pop();)t.forceUpdate()}},c=!0===t.__h;r.__u++||c||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(o,o)},y.prototype.componentWillUnmount=function(){this.t=[]},y.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=m(this.__b,n,r.__O=r.__P)}this.__b=null}var i=t.__a&&Object(O.createElement)(O.Fragment,null,e.fallback);return i&&(i.__h=null),[Object(O.createElement)(O.Fragment,null,t.__a?null:e.children),i]};var q=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};(w.prototype=new O.Component).__a=function(e){var t=this,n=v(t.__v),r=t.o.get(e);return r[0]++,function(i){var s=function(){t.props.revealOrder?(r.push(i),q(t,e,r)):i()};n?n(s):s()}},w.prototype.render=function(e){this.u=null,this.o=new Map;var t=Object(O.toChildArray)(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},w.prototype.componentDidUpdate=w.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){q(e,n,t)}))};var B="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,z=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,K=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,$=/[A-Z0-9]/g,W="undefined"!=typeof document,G=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/:/fil|che|ra/).test(e)};O.Component.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(O.Component.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var H=O.options.event;O.options.event=function(e){return H&&(e=H(e)),e.persist=b,e.isPropagationStopped=I,e.isDefaultPrevented=T,e.nativeEvent=e};var Q={enumerable:!1,configurable:!0,get:function(){return this.class}},Y=O.options.vnode;O.options.vnode=function(e){"string"==typeof e.type&&function(e){var t=e.props,n=e.type,r={};for(var i in t){var s=t[i];if(!("value"===i&&"defaultValue"in t&&null==s||W&&"children"===i&&"noscript"===n||"class"===i||"className"===i)){var o=i.toLowerCase();"defaultValue"===i&&"value"in t&&null==t.value?i="value":"download"===i&&!0===s?s="":"ondoubleclick"===o?i="ondblclick":"onchange"!==o||"input"!==n&&"textarea"!==n||G(t.type)?"onfocus"===o?i="onfocusin":"onblur"===o?i="onfocusout":K.test(i)?i=o:-1===n.indexOf("-")&&z.test(i)?i=i.replace($,"-$&").toLowerCase():null===s&&(s=void 0):o=i="oninput","oninput"===o&&r[i=o]&&(i="oninputCapture"),r[i]=s}}"select"==n&&r.multiple&&Array.isArray(r.value)&&(r.value=Object(O.toChildArray)(t.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==n&&null!=r.defaultValue&&(r.value=Object(O.toChildArray)(t.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),t.class&&!t.className?(r.class=t.class,Object.defineProperty(r,"className",Q)):(t.className&&!t.class||t.class&&t.className)&&(r.class=r.className=t.className),e.props=r}(e),e.$$typeof=B,Y&&Y(e)};var X=O.options.__r;O.options.__r=function(e){X&&X(e),e.__c};var J=O.options.diffed;O.options.diffed=function(e){J&&J(e);var t=e.props,n=e.__e;null!=n&&"textarea"===e.type&&"value"in t&&t.value!==n.value&&(n.value=null==t.value?"":t.value),null}},li6C:function(e,t,n){"use strict";function r(e){s.forEach((t=>{t.setLogLevel(e)}))}function i(e,t){for(const n of s){let r=null;t&&t.level&&(r=a[t.level]),n.userLogHandler=null===e?null:(t,n,...i)=>{const s=i.map((e=>{if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}})).filter((e=>e)).join(" ");n>=(null!=r?r:t.logLevel)&&e({level:o[n].toLowerCase(),message:s,args:i,type:t.name})}}}n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return i}));const s=[];var o;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(o||(o={}));const a={debug:o.DEBUG,verbose:o.VERBOSE,info:o.INFO,warn:o.WARN,error:o.ERROR,silent:o.SILENT},c=o.INFO,u={[o.DEBUG]:"log",[o.VERBOSE]:"log",[o.INFO]:"info",[o.WARN]:"warn",[o.ERROR]:"error"},l=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString(),i=u[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[i](`[${r}]  ${e.name}:`,...n)};class h{constructor(e){this.name=e,this._logLevel=c,this._logHandler=l,this._userLogHandler=null,s.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in o))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?a[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,o.DEBUG,...e),this._logHandler(this,o.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,o.VERBOSE,...e),this._logHandler(this,o.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,o.INFO,...e),this._logHandler(this,o.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,o.WARN,...e),this._logHandler(this,o.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,o.ERROR,...e),this._logHandler(this,o.ERROR,...e)}}},"meV/":function(e,t,n){"use strict";(function(e){function t(){var e;return(null===(e=null===self||void 0===self?void 0:self.location)||void 0===e?void 0:e.protocol)||null}function r(e=Object(w.A)()){return!("file:"!==t()&&"ionic:"!==t()&&"capacitor:"!==t()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function i(e=Object(w.A)()){return Object(w.F)()&&11===(null===document||void 0===document?void 0:document.documentMode)||function(e=Object(w.A)()){return/Edge\/\d+/.test(e)}(e)}function s(){try{const e=self.localStorage,t=y.s();if(e)return e.setItem(t,"1"),e.removeItem(t),!i()||Object(w.G)()}catch(e){return o()&&Object(w.G)()}return!1}function o(){return void 0!==e&&"WorkerGlobalScope"in e&&"importScripts"in e}function a(){return("http:"===t()||"https:"===t()||Object(w.D)()||r())&&!(Object(w.K)()||Object(w.I)())&&s()&&!o()}function c(){return r()&&"undefined"!=typeof document}async function u(e){await e._initializationPromise;const t=l(),n=y.w(T,e.config.apiKey,e.name);t&&t.setItem(n,e._getPersistence())}function l(){var e;try{return(null===(e="undefined"!=typeof window?window:null)||void 0===e?void 0:e.sessionStorage)||null}catch(e){return null}}function h(e){return e.unwrap()}function d(e){const{_tokenResponse:t}=e instanceof w.c?e.customData:e;if(!t)return null;if(!(e instanceof w.c)&&"temporaryProof"in t&&"phoneNumber"in t)return y.i.credentialFromResult(e);const n=t.providerId;if(!n||n===y.k.PASSWORD)return null;let r;switch(n){case y.k.GOOGLE:r=y.f;break;case y.k.FACEBOOK:r=y.d;break;case y.k.GITHUB:r=y.e;break;case y.k.TWITTER:r=y.o;break;default:const{oauthIdToken:e,oauthAccessToken:i,oauthTokenSecret:s,pendingToken:o,nonce:a}=t;return i||s||e||o?o?n.startsWith("saml.")?y.m._create(n,o):y.g._fromParams({providerId:n,signInMethod:n,pendingToken:o,idToken:e,accessToken:i}):new y.h(n).credential({idToken:e,accessToken:i,rawNonce:a}):null}return e instanceof w.c?r.credentialFromError(e):r.credentialFromResult(e)}function f(e,t){return t.catch((t=>{throw t instanceof w.c&&function(e,t){var n;const r=null===(n=t.customData)||void 0===n?void 0:n._tokenResponse;if("auth/multi-factor-auth-required"===(null==t?void 0:t.code))t.resolver=new C(e,y.K(e,t));else if(r){const e=d(t),n=t;e&&(n.credential=e,n.tenantId=r.tenantId||void 0,n.email=r.email||void 0,n.phoneNumber=r.phoneNumber||void 0)}}(e,t),t})).then((e=>{const t=e.user;return{operationType:e.operationType,credential:(n=e,d(n)),additionalUserInfo:y.J(e),user:S.getOrCreate(t)};var n}))}async function p(e,t){const n=await t;return{verificationId:n.verificationId,confirm:t=>f(e,n.confirm(t))}}function g(e,t,n){let r=e;"function"!=typeof e&&({next:r,error:t,complete:n}=e);const i=r;return{next:e=>i(e&&S.getOrCreate(e)),error:t,complete:n}}function m(e,t){const n=function(e,t){const n=l();if(!n)return[];const r=y.w(T,e,t);switch(n.getItem(r)){case b.NONE:return[y.M];case b.LOCAL:return[y.N,y.B];case b.SESSION:return[y.B];default:return[]}}(e,t);if("undefined"==typeof self||n.includes(y.N)||n.push(y.N),"undefined"!=typeof window)for(const e of[y.z,y.B])n.includes(e)||n.push(e);return n.includes(y.M)||n.push(y.M),n}var _=n("YfkF"),y=n("4Mou"),v=n("SgqZ"),w=n("8HXZ");const b={LOCAL:"local",NONE:"none",SESSION:"session"},I=y.p,T="persistence",E=y.p;class k{constructor(){this.browserResolver=y.t(y.A),this.cordovaResolver=y.t(y.F),this.underlyingResolver=null,this._redirectPersistence=y.B,this._completeRedirectFn=y.u,this._overrideRedirectResult=y.v}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,n,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,n,r)}async _openRedirect(e,t,n,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,n,r)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return c()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return E(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await async function(){return!!c()&&new Promise((e=>{const t=setTimeout((()=>{e(!1)}),1e3);document.addEventListener("deviceready",(()=>{clearTimeout(t),e(!0)}))}))}();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}class C{constructor(e,t){this.resolver=t,this.auth=e.wrapped()}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return f(h(this.auth),this.resolver.resolveSignIn(e))}}class S{constructor(e){this._delegate=e,this.multiFactor=y.T(e)}static getOrCreate(e){return S.USER_MAP.has(e)||S.USER_MAP.set(e,new S(e)),S.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return f(this.auth,y.P(this._delegate,e))}async linkWithPhoneNumber(e,t){return p(this.auth,y.Q(this._delegate,e,t))}async linkWithPopup(e){return f(this.auth,y.R(this._delegate,e,k))}async linkWithRedirect(e){return await u(y.q(this.auth)),y.S(this._delegate,e,k)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return f(this.auth,y.U(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return p(this.auth,y.V(this._delegate,e,t))}reauthenticateWithPopup(e){return f(this.auth,y.W(this._delegate,e,k))}async reauthenticateWithRedirect(e){return await u(y.q(this.auth)),y.X(this._delegate,e,k)}sendEmailVerification(e){return y.Y(this._delegate,e)}async unlink(e){return await y.jb(this._delegate,e),this}updateEmail(e){return y.kb(this._delegate,e)}updatePassword(e){return y.lb(this._delegate,e)}updatePhoneNumber(e){return y.mb(this._delegate,e)}updateProfile(e){return y.nb(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return y.ob(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}S.USER_MAP=new WeakMap;const O=y.p;class A{constructor(e,t){if(this.app=e,t.isInitialized())return this._delegate=t.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:n}=e.options;O(n,"invalid-api-key",{appName:e.name}),O(n,"invalid-api-key",{appName:e.name});const r="undefined"!=typeof window?k:void 0;this._delegate=t.initialize({options:{persistence:m(n,e.name),popupRedirectResolver:r}}),this._delegate._updateErrorMap(y.H),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?S.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){y.E(this._delegate,e,t)}applyActionCode(e){return y.y(this._delegate,e)}checkActionCode(e){return y.C(this._delegate,e)}confirmPasswordReset(e,t){return y.D(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return f(this._delegate,y.G(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return y.I(this._delegate,e)}isSignInWithEmailLink(e){return y.O(this._delegate,e)}async getRedirectResult(){O(a(),this._delegate,"operation-not-supported-in-this-environment");const e=await y.L(this._delegate,k);return e?f(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){y.x(this._delegate,e)}onAuthStateChanged(e,t,n){const{next:r,error:i,complete:s}=g(e,t,n);return this._delegate.onAuthStateChanged(r,i,s)}onIdTokenChanged(e,t,n){const{next:r,error:i,complete:s}=g(e,t,n);return this._delegate.onIdTokenChanged(r,i,s)}sendSignInLinkToEmail(e,t){return y.ab(this._delegate,e,t)}sendPasswordResetEmail(e,t){return y.Z(this._delegate,e,t||void 0)}async setPersistence(e){let t;switch(function(e,t){I(Object.values(b).includes(t),e,"invalid-persistence-type"),Object(w.K)()?I(t!==b.SESSION,e,"unsupported-persistence-type"):Object(w.I)()?I(t===b.NONE,e,"unsupported-persistence-type"):o()?I(t===b.NONE||t===b.LOCAL&&Object(w.G)(),e,"unsupported-persistence-type"):I(t===b.NONE||s(),e,"unsupported-persistence-type")}(this._delegate,e),e){case b.SESSION:t=y.B;break;case b.LOCAL:t=await y.t(y.N)._isAvailable()?y.N:y.z;break;case b.NONE:t=y.M;break;default:return y.r("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return f(this._delegate,y.bb(this._delegate))}signInWithCredential(e){return f(this._delegate,y.cb(this._delegate,e))}signInWithCustomToken(e){return f(this._delegate,y.db(this._delegate,e))}signInWithEmailAndPassword(e,t){return f(this._delegate,y.eb(this._delegate,e,t))}signInWithEmailLink(e,t){return f(this._delegate,y.fb(this._delegate,e,t))}signInWithPhoneNumber(e,t){return p(this._delegate,y.gb(this._delegate,e,t))}async signInWithPopup(e){return O(a(),this._delegate,"operation-not-supported-in-this-environment"),f(this._delegate,y.hb(this._delegate,e,k))}async signInWithRedirect(e){return O(a(),this._delegate,"operation-not-supported-in-this-environment"),await u(this._delegate),y.ib(this._delegate,e,k)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return y.pb(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}A.Persistence=b;class N{constructor(){this.providerId="phone",this._delegate=new y.i(h(_.a.auth()))}static credential(e,t){return y.i.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}N.PHONE_SIGN_IN_METHOD=y.i.PHONE_SIGN_IN_METHOD,N.PROVIDER_ID=y.i.PROVIDER_ID;const P=y.p;class R{constructor(e,t,n=_.a.app()){var r;P(null===(r=n.options)||void 0===r?void 0:r.apiKey,"invalid-api-key",{appName:n.name}),this._delegate=new y.l(n.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}var D;(D=_.a).INTERNAL.registerComponent(new v.a("auth-compat",(e=>{const t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("auth");return new A(t,n)}),"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:y.a.EMAIL_SIGNIN,PASSWORD_RESET:y.a.PASSWORD_RESET,RECOVER_EMAIL:y.a.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:y.a.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:y.a.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:y.a.VERIFY_EMAIL}},EmailAuthProvider:y.c,FacebookAuthProvider:y.d,GithubAuthProvider:y.e,GoogleAuthProvider:y.f,OAuthProvider:y.h,SAMLAuthProvider:y.n,PhoneAuthProvider:N,PhoneMultiFactorGenerator:y.j,RecaptchaVerifier:R,TwitterAuthProvider:y.o,Auth:A,AuthCredential:y.b,Error:w.c}).setInstantiationMode("LAZY").setMultipleInstances(!1)),D.registerVersion("@firebase/auth-compat","0.4.4")}).call(this,n("pCvA"))},pCvA:function(e){var t;t=function(){return this}();try{t=t||new Function("return this")()}catch(e){"object"==typeof window&&(t=window)}e.exports=t},qDtm:function(e,t,n){"use strict";function r(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(oa||(oa=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(fa(this),t),s(aa.get(this))}:function(...t){return s(e.apply(fa(this),t))}:function(t,...n){const r=e.call(fa(this),t,...n);return ua.set(r,t.sort?t.sort():[t]),s(r)}}function i(e){return"function"==typeof e?r(e):(e instanceof IDBTransaction&&function(e){if(ca.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)}));ca.set(e,t)}(e),ia(e,sa||(sa=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,da):e)}function s(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",o)},i=()=>{t(s(e.result)),r()},o=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",o)}));return t.then((t=>{t instanceof IDBCursor&&aa.set(t,e)})).catch((()=>{})),ha.set(t,e),t}(e);if(la.has(e))return la.get(e);const t=i(e);return t!==e&&(la.set(e,t),ha.set(t,e)),t}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(ma.get(t))return ma.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=ga.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!pa.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,i?"readwrite":"readonly");let o=s.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),i&&s.done]))[0]};return ma.set(t,s),s}function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(this,arguments)}function h(e){return e instanceof na.c&&e.code.includes("request-failed")}function d({projectId:e}){return`${Ia}/projects/${e}/installations`}function f(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function p(e,t){const n=(await t.json()).error;return Ea.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function g({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function m(e,{refreshToken:t}){const n=g(e);return n.append("Authorization",function(e){return`${ba} ${e}`}(t)),n}async function _(e){const t=await e();return t.status>=500&&t.status<600?e():t}function y(e){return new Promise((t=>{setTimeout(t,e)}))}function v(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){const t=(n=e,btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_"));var n;return t.substr(0,22)}(e);return ka.test(t)?t:Ca}catch(e){return Ca}}function w(e){return`${e.appName}!${e.appId}`}function b(e,t){const n=w(e);I(n,t),function(e,t){const n=T();n&&n.postMessage({key:e,fid:t});E()}(n,t)}function I(e,t){const n=Sa.get(e);if(n)for(const e of n)e(t)}function T(){return!Oa&&"BroadcastChannel"in self&&(Oa=new BroadcastChannel("[Firebase] FID Change"),Oa.onmessage=e=>{I(e.data.key,e.data.fid)}),Oa}function E(){0===Sa.size&&Oa&&(Oa.close(),Oa=null)}function k(){return Ra||(Ra=function(e,t,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){const a=indexedDB.open(e,t),c=s(a);return r&&a.addEventListener("upgradeneeded",(e=>{r(s(a.result),e.oldVersion,e.newVersion,s(a.transaction))})),n&&a.addEventListener("blocked",(()=>n())),c.then((e=>{o&&e.addEventListener("close",(()=>o())),i&&e.addEventListener("versionchange",(()=>i()))})).catch((()=>{})),c}(Aa,Na,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(Pa)}})),Ra}async function C(e,t){const n=w(e),r=(await k()).transaction(Pa,"readwrite"),i=r.objectStore(Pa),s=await i.get(n);return await i.put(t,n),await r.done,s&&s.fid===t.fid||b(e,t.fid),t}async function S(e){const t=w(e),n=(await k()).transaction(Pa,"readwrite");await n.objectStore(Pa).delete(t),await n.done}async function O(e,t){const n=w(e),r=(await k()).transaction(Pa,"readwrite"),i=r.objectStore(Pa),s=await i.get(n),o=t(s);return void 0===o?await i.delete(n):await i.put(o,n),await r.done,!o||s&&s.fid===o.fid||b(e,o.fid),o}async function A(e){let t;const n=await O(e.appConfig,(n=>{const r=function(e){const t=e||{fid:v(),registrationStatus:0};return R(t)}(n),i=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){return{installationEntry:t,registrationPromise:Promise.reject(Ea.create("app-offline"))}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(e,t){try{const n=await async function({appConfig:e,heartbeatServiceProvider:t},{fid:n}){const r=d(e),i=g(e),s=t.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&i.append("x-firebase-client",e)}const o={method:"POST",headers:i,body:JSON.stringify({fid:n,authVersion:ba,appId:e.appId,sdkVersion:wa})},a=await _((()=>fetch(r,o)));if(a.ok){const e=await a.json();return{fid:e.fid||n,registrationStatus:2,refreshToken:e.refreshToken,authToken:f(e.authToken)}}throw await p("Create Installation",a)}(e,t);return C(e.appConfig,n)}catch(n){throw h(n)&&409===n.customData.serverCode?await S(e.appConfig):await C(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:N(e)}:{installationEntry:t}}(e,r);return t=i.registrationPromise,i.installationEntry}));return n.fid===Ca?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function N(e){let t=await P(e.appConfig);for(;1===t.registrationStatus;)await y(100),t=await P(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await A(e);return n||t}return t}function P(e){return O(e,(e=>{if(!e)throw Ea.create("installation-not-found");return R(e)}))}function R(e){return 1===(t=e).registrationStatus&&t.registrationTime+va<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function D({appConfig:e,heartbeatServiceProvider:t},n){const r=function(e,{fid:t}){return`${d(e)}/${t}/authTokens:generate`}(e,n),i=m(e,n),s=t.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&i.append("x-firebase-client",e)}const o={method:"POST",headers:i,body:JSON.stringify({installation:{sdkVersion:wa,appId:e.appId}})},a=await _((()=>fetch(r,o)));if(a.ok){return f(await a.json())}throw await p("Generate Auth Token",a)}async function x(e,t=!1){let n;const r=await O(e.appConfig,(r=>{if(!L(r))throw Ea.create("not-registered");const i=r.authToken;if(!t&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+Ta}(e)}(i))return r;if(1===i.requestStatus)return n=async function(e,t){let n=await M(e.appConfig);for(;1===n.authToken.requestStatus;)await y(100),n=await M(e.appConfig);const r=n.authToken;return 0===r.requestStatus?x(e,t):r}(e,t),r;{if(!navigator.onLine)throw Ea.create("app-offline");const t=function(e){const t={requestStatus:1,requestTime:Date.now()};return l(l({},e),{authToken:t})}(r);return n=async function(e,t){try{const n=await D(e,t),r=l(l({},t),{authToken:n});return await C(e.appConfig,r),n}catch(n){if(!h(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=l(l({},t),{authToken:{requestStatus:0}});await C(e.appConfig,n)}else await S(e.appConfig);throw n}}(e,t),t}}));return n?await n:r.authToken}function M(e){return O(e,(e=>{if(!L(e))throw Ea.create("not-registered");return 1===(t=e.authToken).requestStatus&&t.requestTime+va<Date.now()?l(l({},e),{authToken:{requestStatus:0}}):e;var t}))}function L(e){return void 0!==e&&2===e.registrationStatus}async function j(e,t=!1){const n=e;await async function(e){const{registrationPromise:t}=await A(e);t&&await t}(n);return(await x(n,t)).token}function F(e){return Ea.create("missing-app-config-values",{valueName:e})}function U(){return U=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},U.apply(this,arguments)}function V(e){if(!e.startsWith(qa)){const t=za.create("invalid-gtag-resource",{gtagURL:e});return Ba.warn(t.message),""}return e}function q(e){return Promise.all(e.map((e=>e.catch((e=>e)))))}function B(e,t){const n=function(e,t){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(e,t)),n}("firebase-js-sdk-policy",{createScriptURL:V}),r=document.createElement("script"),i=`${qa}?l=${e}&id=${t}`;r.src=n?null==n?void 0:n.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function z(e,t,n,r){return async function(i,...s){try{if("event"===i){const[r,i]=s;await async function(e,t,n,r,i){try{let s=[];if(i&&i.send_to){let e=i.send_to;Array.isArray(e)||(e=[e]);const r=await q(n);for(const n of e){const e=r.find((e=>e.measurementId===n)),i=e&&t[e.appId];if(!i){s=[];break}s.push(i)}}0===s.length&&(s=Object.values(t)),await Promise.all(s),e("event",r,i||{})}catch(e){Ba.error(e)}}(e,t,n,r,i)}else if("config"===i){const[i,o]=s;await async function(e,t,n,r,i,s){const o=r[i];try{if(o)await t[o];else{const e=(await q(n)).find((e=>e.measurementId===i));e&&await t[e.appId]}}catch(e){Ba.error(e)}e("config",i,s)}(e,t,n,r,i,o)}else if("consent"===i){const[t]=s;e("consent","update",t)}else if("get"===i){const[t,n,r]=s;e("get",t,n,r)}else if("set"===i){const[t]=s;e("set",t)}else e(i,...s)}catch(e){Ba.error(e)}}}function K(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function $(e,t=$a,n){const{appId:r,apiKey:i,measurementId:s}=e.options;if(!r)throw za.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw za.create("no-api-key")}const o=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Wa;return setTimeout((async()=>{a.abort()}),void 0!==n?n:Ua),W({appId:r,apiKey:i,measurementId:s},o,a,t)}async function W(e,{throttleEndTimeMillis:t,backoffCount:n},r,i=$a){var s;const{appId:o,measurementId:a}=e;try{await function(e,t){return new Promise(((n,r)=>{const i=Math.max(t-Date.now(),0),s=setTimeout(n,i);e.addEventListener((()=>{clearTimeout(s),r(za.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(r,t)}catch(e){if(a)return Ba.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${null==e?void 0:e.message}]`),{appId:o,measurementId:a};throw e}try{const t=await async function(e){var t;const{appId:n,apiKey:r}=e,i={method:"GET",headers:K(r)},s=Va.replace("{app-id}",n),o=await fetch(s,i);if(200!==o.status&&304!==o.status){let e="";try{const n=await o.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(e){}throw za.create("config-fetch-failed",{httpStatus:o.status,responseMessage:e})}return o.json()}(e);return i.deleteThrottleMetadata(o),t}catch(t){const c=t;if(!function(e){if(!(e instanceof na.c&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(c)){if(i.deleteThrottleMetadata(o),a)return Ba.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${null==c?void 0:c.message}]`),{appId:o,measurementId:a};throw t}const u=503===Number(null===(s=null==c?void 0:c.customData)||void 0===s?void 0:s.httpStatus)?Object(na.l)(n,i.intervalMillis,Ka):Object(na.l)(n,i.intervalMillis),l={throttleEndTimeMillis:Date.now()+u,backoffCount:n+1};return i.setThrottleMetadata(o,l),Ba.debug(`Calling attemptFetch again in ${u} millis`),W(e,l,r,i)}}function G(e){Ha=e}function H(e){Ga=e}async function Q(e,t,n,r,i,s,o){var a;const c=$(e);c.then((t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&Ba.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((e=>Ba.error(e))),t.push(c);const u=async function(){if(!Object(na.G)())return Ba.warn(za.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await Object(na.ab)()}catch(e){return Ba.warn(za.create("indexeddb-unavailable",{errorInfo:null==e?void 0:e.toString()}).message),!1}return!0}().then((e=>e?r.getId():void 0)),[l,h]=await Promise.all([c,u]);(function(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes(qa)&&n.src.includes(e))return n;return null})(s)||B(s,l.measurementId),Ha&&(i("consent","default",Ha),G(void 0)),i("js",new Date);const d=null!==(a=null==o?void 0:o.config)&&void 0!==a?a:{};return d[Fa]="firebase",d.update=!0,null!=h&&(d[ja]=h),i("config",l.measurementId,d),Ga&&(i("set",Ga),H(void 0)),l.measurementId}function Y(e){if(rc)throw za.create("already-initialized");e.dataLayerName&&(tc=e.dataLayerName),e.gtagName&&(nc=e.gtagName)}function X(e,t,n){!function(){const e=[];if(Object(na.D)()&&e.push("This is a browser extension environment."),Object(na.e)()||e.push("Cookies are not available."),e.length>0){const t=e.map(((e,t)=>`(${t+1}) ${e}`)).join(" "),n=za.create("invalid-analytics-context",{errorInfo:t});Ba.warn(n.message)}}();const r=e.options.appId;if(!r)throw za.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw za.create("no-api-key");Ba.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Ya[r])throw za.create("already-exists",{id:r});if(!rc){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(tc);const{wrappedGtag:e,gtagCore:t}=function(e,t,n,r,i){let s=function(){window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(s=window[i]),window[i]=z(s,e,t,n),{gtagCore:s,wrappedGtag:window[i]}}(Ya,Xa,Ja,tc,nc);ec=e,Za=t,rc=!0}Ya[r]=Q(e,Xa,Ja,t,Za,tc,n);return new Qa(e)}async function J(){if(Object(na.D)())return!1;if(!Object(na.e)())return!1;if(!Object(na.G)())return!1;try{return await Object(na.ab)()}catch(e){return!1}}function Z(e,t,n){e=Object(na.z)(e),async function(e,t,n,r){if(r&&r.global)return e("set",{screen_name:n}),Promise.resolve();e("config",await t,{update:!0,screen_name:n})}(ec,Ya[e.app.options.appId],t,n).catch((e=>Ba.error(e)))}function ee(e,t,n){e=Object(na.z)(e),async function(e,t,n,r){if(r&&r.global)return e("set",{user_id:n}),Promise.resolve();e("config",await t,{update:!0,user_id:n})}(ec,Ya[e.app.options.appId],t,n).catch((e=>Ba.error(e)))}function te(e,t,n){e=Object(na.z)(e),async function(e,t,n,r){if(r&&r.global){const t={};for(const e of Object.keys(n))t[`user_properties.${e}`]=n[e];return e("set",t),Promise.resolve()}e("config",await t,{update:!0,user_properties:n})}(ec,Ya[e.app.options.appId],t,n).catch((e=>Ba.error(e)))}function ne(e,t){e=Object(na.z)(e),async function(e,t){const n=await e;window[`ga-disable-${n}`]=!t}(Ya[e.app.options.appId],t).catch((e=>Ba.error(e)))}function re(e,t,n,r){e=Object(na.z)(e),async function(e,t,n,r,i){if(i&&i.global)e("event",n,r);else{const i=await t;e("event",n,U(U({},r),{send_to:i}))}}(ec,Ya[e.app.options.appId],t,n,r).catch((e=>Ba.error(e)))}function ie(){return ie=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ie.apply(this,arguments)}function se(e){return uc.get(e)||ie({},lc)}function oe(){return hc}function ae(e=!1){var t;return e?null===(t=self.grecaptcha)||void 0===t?void 0:t.enterprise:self.grecaptcha}function ce(e){if(!se(e).activated)throw mc.create("use-before-activation",{appName:e.name})}function ue(e){const t=Math.round(e/1e3),n=Math.floor(t/86400),r=Math.floor((t-3600*n*24)/3600),i=Math.floor((t-3600*n*24-3600*r)/60),s=t-3600*n*24-3600*r-60*i;let o="";return n&&(o+=le(n)+"d:"),r&&(o+=le(r)+"h:"),o+=le(i)+"m:"+le(s)+"s",o}function le(e){return 0===e?"00":e>=10?e.toString():"0"+e}async function he({url:e,body:t},n){const r={"Content-Type":"application/json"},i=n.getImmediate({optional:!0});if(i){const e=await i.getHeartbeatsHeader();e&&(r["X-Firebase-Client"]=e)}const s={method:"POST",body:JSON.stringify(t),headers:r};let o,a;try{o=await fetch(e,s)}catch(e){throw mc.create("fetch-network-error",{originalErrorMessage:null==e?void 0:e.message})}if(200!==o.status)throw mc.create("fetch-status-error",{httpStatus:o.status});try{a=await o.json()}catch(e){throw mc.create("fetch-parse-error",{originalErrorMessage:null==e?void 0:e.message})}const c=a.ttl.match(/^([\d.]+)(s)$/);if(!c||!c[2]||isNaN(Number(c[1])))throw mc.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${a.ttl}`});const u=1e3*Number(c[1]),l=Date.now();return{token:a.token,expireTimeMillis:l+u,issuedAtTimeMillis:l}}function de(e,t){const{projectId:n,appId:r,apiKey:i}=e.options;return{url:`${dc}/projects/${n}/apps/${r}:${fc}?key=${i}`,body:{debug_token:t}}}function fe(){return bc||(bc=new Promise(((e,t)=>{try{const n=indexedDB.open(_c,yc);n.onsuccess=t=>{e(t.target.result)},n.onerror=e=>{var n;t(mc.create("storage-open",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))},n.onupgradeneeded=e=>{if(0===e.oldVersion)e.target.result.createObjectStore(vc,{keyPath:"compositeKey"})}}catch(e){t(mc.create("storage-open",{originalErrorMessage:null==e?void 0:e.message}))}})),bc)}async function pe(e,t){const n=(await fe()).transaction(vc,"readwrite"),r=n.objectStore(vc).put({compositeKey:e,value:t});return new Promise(((e,t)=>{r.onsuccess=()=>{e()},n.onerror=e=>{var n;t(mc.create("storage-set",{originalErrorMessage:null===(n=e.target.error)||void 0===n?void 0:n.message}))}}))}async function ge(e){const t=(await fe()).transaction(vc,"readonly"),n=t.objectStore(vc).get(e);return new Promise(((e,r)=>{n.onsuccess=t=>{const n=t.target.result;e(n?n.value:void 0)},t.onerror=e=>{var t;r(mc.create("storage-get",{originalErrorMessage:null===(t=e.target.error)||void 0===t?void 0:t.message}))}}))}function me(e){return`${e.options.appId}-${e.name}`}async function _e(e){if(Object(na.G)()){let t;try{t=await function(e){return ge(me(e))}(e)}catch(e){Ic.warn(`Failed to read token from IndexedDB. Error: ${e}`)}return t}}function ye(e,t){return Object(na.G)()?function(e,t){return pe(me(e),t)}(e,t).catch((e=>{Ic.warn(`Failed to write token to IndexedDB. Error: ${e}`)})):Promise.resolve()}async function ve(){let e;try{e=await ge(wc)}catch(e){}if(e)return e;{const e=Object(na.W)();return(t=e,pe(wc,t)).catch((e=>Ic.warn(`Failed to persist debug token to IndexedDB. Error: ${e}`))),e}var t}function we(){return oe().enabled}async function be(){const e=oe();if(e.enabled&&e.token)return e.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}async function Ie(e,t=!1){const n=e.app;ce(n);const r=se(n);let i,s=r.token;if(s&&!Oe(s)&&(r.token=void 0,s=void 0),!s){const e=await r.cachedTokenPromise;e&&(Oe(e)?s=e:await ye(n,void 0))}if(!t&&s&&Oe(s))return{token:s.token};let o,a=!1;if(we()){r.exchangeTokenPromise||(r.exchangeTokenPromise=he(de(n,await be()),e.heartbeatServiceProvider).finally((()=>{r.exchangeTokenPromise=void 0})),a=!0);const t=await r.exchangeTokenPromise;return await ye(n,t),r.token=t,{token:t.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally((()=>{r.exchangeTokenPromise=void 0})),a=!0),s=await se(n).exchangeTokenPromise}catch(e){"appCheck/throttled"===e.code?Ic.warn(e.message):Ic.error(e),i=e}return s?i?o=Oe(s)?{token:s.token,internalError:i}:Ae(i):(o={token:s.token},r.token=s,await ye(n,s)):o=Ae(i),a&&Se(n,o),o}async function Te(e){const t=e.app;ce(t);const{provider:n}=se(t);if(we()){const n=await be(),{token:r}=await he(de(t,n),e.heartbeatServiceProvider);return{token:r}}{const{token:e}=await n.getToken();return{token:e}}}function Ee(e,t,n,r){const{app:i}=e,s=se(i);if(s.tokenObservers=[...s.tokenObservers,{next:n,error:r,type:t}],s.token&&Oe(s.token)){const t=s.token;Promise.resolve().then((()=>{n({token:t.token}),Ce(e)})).catch((()=>{}))}s.cachedTokenPromise.then((()=>Ce(e)))}function ke(e,t){const n=se(e),r=n.tokenObservers.filter((e=>e.next!==t));0===r.length&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=r}function Ce(e){const{app:t}=e,n=se(t);let r=n.tokenRefresher;r||(r=function(e){const{app:t}=e;return new gc((async()=>{let n;if(n=se(t).token?await Ie(e,!0):await Ie(e),n.error)throw n.error;if(n.internalError)throw n.internalError}),(()=>!0),(()=>{const e=se(t);if(e.token){let t=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5;return t=Math.min(t,e.token.expireTimeMillis-3e5),Math.max(0,t-Date.now())}return 0}),pc.RETRIAL_MIN_WAIT,pc.RETRIAL_MAX_WAIT)}(e),n.tokenRefresher=r),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function Se(e,t){const n=se(e).tokenObservers;for(const e of n)try{"EXTERNAL"===e.type&&null!=t.error?e.error(t.error):e.next(t)}catch(e){}}function Oe(e){return e.expireTimeMillis-Date.now()>0}function Ae(e){return{token:(t=Tc,na.h.encodeString(JSON.stringify(t),!1)),error:e};var t}function Ne(e,t){const n=new na.a;se(e).reCAPTCHAState={initialized:n};const r=De(e),i=ae(!1);return i?Re(e,t,i,r,n):function(e){const t=document.createElement("script");t.src=kc,t.onload=e,document.head.appendChild(t)}((()=>{const i=ae(!1);if(!i)throw new Error("no recaptcha");Re(e,t,i,r,n)})),n.promise}function Pe(e,t){const n=new na.a;se(e).reCAPTCHAState={initialized:n};const r=De(e),i=ae(!0);return i?Re(e,t,i,r,n):function(e){const t=document.createElement("script");t.src=Cc,t.onload=e,document.head.appendChild(t)}((()=>{const i=ae(!0);if(!i)throw new Error("no recaptcha");Re(e,t,i,r,n)})),n.promise}function Re(e,t,n,r,i){n.ready((()=>{!function(e,t,n,r){const i=n.render(r,{sitekey:t,size:"invisible",callback:()=>{se(e).reCAPTCHAState.succeeded=!0},"error-callback":()=>{se(e).reCAPTCHAState.succeeded=!1}}),s=se(e);s.reCAPTCHAState=ie(ie({},s.reCAPTCHAState),{widgetId:i})}(e,t,n,r),i.resolve(n)}))}function De(e){const t=`fire_app_check_${e.name}`,n=document.createElement("div");return n.id=t,n.style.display="none",document.body.appendChild(n),t}async function xe(e){ce(e);const t=se(e).reCAPTCHAState,n=await t.initialized.promise;return new Promise((t=>{const r=se(e).reCAPTCHAState;n.ready((()=>{t(n.execute(r.widgetId,{action:"fire_app_check"}))}))}))}function Me(e,t){if(404===e||403===e)return{backoffCount:1,allowRequestsAfter:Date.now()+864e5,httpStatus:e};{const n=t?t.backoffCount:0,r=Object(na.l)(n,1e3,2);return{backoffCount:n+1,allowRequestsAfter:Date.now()+r,httpStatus:e}}}function Le(e){if(e&&Date.now()-e.allowRequestsAfter<=0)throw mc.create("throttled",{time:ue(e.allowRequestsAfter-Date.now()),httpStatus:e.httpStatus})}function je(e=Object(ea.getApp)(),t){e=Object(na.z)(e);const n=Object(ea._getProvider)(e,"app-check");if(oe().initialized||function(){const e=Object(na.y)(),t=oe();if(t.initialized=!0,"string"!=typeof e.FIREBASE_APPCHECK_DEBUG_TOKEN&&!0!==e.FIREBASE_APPCHECK_DEBUG_TOKEN)return;t.enabled=!0;const n=new na.a;t.token=n,n.resolve("string"==typeof e.FIREBASE_APPCHECK_DEBUG_TOKEN?e.FIREBASE_APPCHECK_DEBUG_TOKEN:ve())}(),we()&&be().then((e=>console.log(`App Check debug token: ${e}. You will need to add it to your app's App Check settings in the Firebase console for it to work.`))),n.isInitialized()){const r=n.getImmediate(),i=n.getOptions();if(i.isTokenAutoRefreshEnabled===t.isTokenAutoRefreshEnabled&&i.provider.isEqual(t.provider))return r;throw mc.create("already-initialized",{appName:e.name})}const r=n.initialize({options:t});return function(e,t,n){const r=function(e,t){return uc.set(e,t),uc.get(e)}(e,ie({},lc));r.activated=!0,r.provider=t,r.cachedTokenPromise=_e(e).then((t=>(t&&Oe(t)&&(r.token=t,Se(e,{token:t.token})),t))),r.isTokenAutoRefreshEnabled=void 0===n?e.automaticDataCollectionEnabled:n,r.provider.initialize(e)}(e,t.provider,t.isTokenAutoRefreshEnabled),se(e).isTokenAutoRefreshEnabled&&Ee(r,"INTERNAL",(()=>{})),r}function Fe(){return Fe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Fe.apply(this,arguments)}function Ue(e){Mc=e}function Ve(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}function qe(e,t,n){let r;if(Object(na.f)("string"==typeof t,"typeof type must == string"),Object(na.f)("object"==typeof n,"typeof params must == object"),t===yu)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==vu)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const i=[];return Ve(n,((e,t)=>{i.push(e+"="+t)})),r+i.join("&")}function Be(e){const t=e.toString();return Iu[t]||(Iu[t]=new bu),Iu[t]}function ze(){return new ju("")}function Ke(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function $e(e){return e.pieces_.length-e.pieceNum_}function We(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new ju(e.pieces_,t)}function Ge(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function He(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function Qe(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new ju(t,0)}function Ye(e,t){const n=[];for(let t=e.pieceNum_;t<e.pieces_.length;t++)n.push(e.pieces_[t]);if(t instanceof ju)for(let e=t.pieceNum_;e<t.pieces_.length;e++)n.push(t.pieces_[e]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new ju(n,0)}function Xe(e){return e.pieceNum_>=e.pieces_.length}function Je(e,t){const n=Ke(e),r=Ke(t);if(null===n)return t;if(n===r)return Je(We(e),We(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function Ze(e,t){const n=He(e,0),r=He(t,0);for(let e=0;e<n.length&&e<r.length;e++){const t=nu(n[e],r[e]);if(0!==t)return t}return n.length===r.length?0:n.length<r.length?-1:1}function et(e,t){if($e(e)!==$e(t))return!1;for(let n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function tt(e,t){let n=e.pieceNum_,r=t.pieceNum_;if($e(e)>$e(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}function nt(e){if(e.byteLength_>Lu)throw new Error(e.errorPrefix_+"has a key path longer than "+Lu+" bytes ("+e.byteLength_+").");if(e.parts_.length>Mu)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Mu+") or object contains a cycle "+rt(e))}function rt(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}function it(e,t){return nu(e.name,t.name)}function st(e,t){return nu(e,t)}function ot(e,t=null){if(null===e)return hl.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),Object(na.f)(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e){return new nl(e,ot(t))}if(e instanceof Array||!fl){let n=hl.EMPTY_NODE;return Ve(e,((t,r)=>{if(Object(na.m)(e,t)&&"."!==t.substring(0,1)){const e=ot(r);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}})),n.updatePriority(ot(t))}{const n=[];let r=!1;if(Ve(e,((e,t)=>{if("."!==e.substring(0,1)){const i=ot(t);i.isEmpty()||(r=r||!i.getPriority().isEmpty(),n.push(new Bu(e,i)))}})),0===n.length)return hl.EMPTY_NODE;const i=ol(n,it,(e=>e.name),st);if(r){const e=ol(n,rl.getCompare());return new hl(i,ot(t),new ul({".priority":e},{".priority":rl}))}return new hl(i,ot(t),ul.Default)}}function at(e){return{type:"value",snapshotNode:e}}function ct(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function ut(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function lt(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}function ht(e,t,n){const r=e.copy();return r.startSet_=!0,void 0===t&&(t=null),r.indexStartValue_=t,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function dt(e,t,n){const r=e.copy();return r.endSet_=!0,void 0===t&&(t=null),r.indexEndValue_=t,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function ft(e,t){const n=e.copy();return n.index_=t,n}function pt(e){const t={};if(e.isDefault())return t;let n;if(e.index_===rl?n="$priority":e.index_===gl?n="$value":e.index_===Wu?n="$key":(Object(na.f)(e.index_ instanceof pl,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=Object(na.V)(n),e.startSet_){const n=e.startAfterSet_?"startAfter":"startAt";t[n]=Object(na.V)(e.indexStartValue_),e.startNameSet_&&(t[n]+=","+Object(na.V)(e.indexStartName_))}if(e.endSet_){const n=e.endBeforeSet_?"endBefore":"endAt";t[n]=Object(na.V)(e.indexEndValue_),e.endNameSet_&&(t[n]+=","+Object(na.V)(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function gt(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==rl&&(t.i=e.index_.toString()),t}function mt(){return{value:null,children:new Map}}function _t(e,t,n){if(Xe(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const r=Ke(t);e.children.has(r)||e.children.set(r,mt());_t(e.children.get(r),t=We(t),n)}}function yt(e,t){if(Xe(t))return e.value=null,e.children.clear(),!0;if(null!==e.value){if(e.value.isLeafNode())return!1;{const n=e.value;return e.value=null,n.forEachChild(rl,((t,n)=>{_t(e,new ju(t),n)})),yt(e,t)}}if(e.children.size>0){const n=Ke(t);if(t=We(t),e.children.has(n)){yt(e.children.get(n),t)&&e.children.delete(n)}return 0===e.children.size}return!0}function vt(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(((e,n)=>{t(n,e)}))}(e,((e,r)=>{vt(r,new ju(t.toString()+"/"+e),n)}))}function wt(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}function bt(e,t,n,r,i,s){const o=r.filter((e=>e.type===n));o.sort(((t,n)=>function(e,t,n){if(null==t.childName||null==n.childName)throw Object(na.g)("Should only compare child_ events.");const r=new Bu(t.childName,t.snapshotNode),i=new Bu(n.childName,n.snapshotNode);return e.index_.compare(r,i)}(e,t,n))),o.forEach((n=>{const r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,s);i.forEach((i=>{i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))}))}))}function It(e,t){return{eventCache:e,serverCache:t}}function Tt(e,t,n,r){return It(new Al(t,n,r),e.serverCache)}function Et(e,t,n,r){return It(e.eventCache,new Al(t,n,r))}function kt(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Ct(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}function St(e,t,n){if(Xe(t))return new Dl(new Rl(n));{const r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){const i=r.path;let s=r.value;const o=Je(i,t);return s=s.updateChild(o,n),new Dl(e.writeTree_.set(i,s))}{const r=new Rl(n),i=e.writeTree_.setTree(t,r);return new Dl(i)}}}function Ot(e,t,n){let r=e;return Ve(n,((e,n)=>{r=St(r,Ye(t,e),n)})),r}function At(e,t){if(Xe(t))return Dl.empty();{const n=e.writeTree_.setTree(t,new Rl(null));return new Dl(n)}}function Nt(e,t){return null!=Pt(e,t)}function Pt(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(Je(n.path,t)):null}function Rt(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(rl,((e,n)=>{t.push(new Bu(e,n))})):e.writeTree_.children.inorderTraversal(((e,n)=>{null!=n.value&&t.push(new Bu(e,n.value))})),t}function Dt(e,t){if(Xe(t))return e;{const n=Pt(e,t);return new Dl(null!=n?new Rl(n):e.writeTree_.subtree(t))}}function xt(e){return e.writeTree_.isEmpty()}function Mt(e,t){return Lt(ze(),e.writeTree_,t)}function Lt(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);{let r=null;return t.children.inorderTraversal(((t,i)=>{".priority"===t?(Object(na.f)(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=Lt(Ye(e,t),i,n)})),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(Ye(e,".priority"),r)),n}}function jt(e,t){return Yt(t,e)}function Ft(e,t){const n=e.allWrites.findIndex((e=>e.writeId===t));Object(na.f)(n>=0,"removeWrite called with nonexistent writeId.");const r=e.allWrites[n];e.allWrites.splice(n,1);let i=r.visible,s=!1,o=e.allWrites.length-1;for(;i&&o>=0;){const t=e.allWrites[o];t.visible&&(o>=n&&Ut(t,r.path)?i=!1:tt(r.path,t.path)&&(s=!0)),o--}if(i){if(s)return function(e){e.visibleWrites=qt(e.allWrites,Vt,ze()),e.lastWriteId=e.allWrites.length>0?e.allWrites[e.allWrites.length-1].writeId:-1}(e),!0;if(r.snap)e.visibleWrites=At(e.visibleWrites,r.path);else{Ve(r.children,(t=>{e.visibleWrites=At(e.visibleWrites,Ye(r.path,t))}))}return!0}return!1}function Ut(e,t){if(e.snap)return tt(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&tt(Ye(e.path,n),t))return!0;return!1}function Vt(e){return e.visible}function qt(e,t,n){let r=Dl.empty();for(let i=0;i<e.length;++i){const s=e[i];if(t(s)){const e=s.path;let t;if(s.snap)tt(n,e)?(t=Je(n,e),r=St(r,t,s.snap)):tt(e,n)&&(t=Je(e,n),r=St(r,ze(),s.snap.getChild(t)));else{if(!s.children)throw Object(na.g)("WriteRecord should have .snap or .children");if(tt(n,e))t=Je(n,e),r=Ot(r,t,s.children);else if(tt(e,n))if(t=Je(e,n),Xe(t))r=Ot(r,ze(),s.children);else{const e=Object(na.S)(s.children,Ke(t));if(e){const n=e.getChild(We(t));r=St(r,ze(),n)}}}}}return r}function Bt(e,t,n,r,i){if(r||i){const s=Dt(e.visibleWrites,t);if(!i&&xt(s))return n;if(i||null!=n||Nt(s,ze())){return Mt(qt(e.allWrites,(function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(tt(e.path,t)||tt(t,e.path))}),t),n||hl.EMPTY_NODE)}return null}{const r=Pt(e.visibleWrites,t);if(null!=r)return r;{const r=Dt(e.visibleWrites,t);if(xt(r))return n;if(null!=n||Nt(r,ze())){return Mt(r,n||hl.EMPTY_NODE)}return null}}}function zt(e,t,n,r){return Bt(e.writeTree,e.treePath,t,n,r)}function Kt(e,t){return function(e,t,n){let r=hl.EMPTY_NODE;const i=Pt(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(rl,((e,t)=>{r=r.updateImmediateChild(e,t)})),r;if(n){const i=Dt(e.visibleWrites,t);return n.forEachChild(rl,((e,t)=>{const n=Mt(Dt(i,new ju(e)),t);r=r.updateImmediateChild(e,n)})),Rt(i).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}return Rt(Dt(e.visibleWrites,t)).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function $t(e,t,n,r){return function(e,t,n,r,i){Object(na.f)(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=Ye(t,n);if(Nt(e.visibleWrites,s))return null;{const t=Dt(e.visibleWrites,s);return xt(t)?i.getChild(n):Mt(t,i.getChild(n))}}(e.writeTree,e.treePath,t,n,r)}function Wt(e,t){return function(e,t){return Pt(e.visibleWrites,t)}(e.writeTree,Ye(e.treePath,t))}function Gt(e,t,n,r,i,s){return function(e,t,n,r,i,s,o){let a;const c=Dt(e.visibleWrites,t),u=Pt(c,ze());if(null!=u)a=u;else{if(null==n)return[];a=Mt(c,n)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const e=[],t=o.getCompare(),n=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let c=n.getNext();for(;c&&e.length<i;)0!==t(c,r)&&e.push(c),c=n.getNext();return e}}(e.writeTree,e.treePath,t,n,r,i,s)}function Ht(e,t,n){return function(e,t,n,r){const i=Ye(t,n),s=Pt(e.visibleWrites,i);if(null!=s)return s;if(r.isCompleteForChild(n))return Mt(Dt(e.visibleWrites,i),r.getNode().getImmediateChild(n));return null}(e.writeTree,e.treePath,t,n)}function Qt(e,t){return Yt(Ye(e.treePath,t),e.writeTree)}function Yt(e,t){return{treePath:e,writeTree:t}}function Xt(e,t,n,r,i){const s=new xl;let o,a;if(n.type===El.OVERWRITE){const c=n;c.source.fromUser?o=en(e,t,c.path,c.snap,r,i,s):(Object(na.f)(c.source.fromServer,"Unknown source."),a=c.source.tagged||t.serverCache.isFiltered()&&!Xe(c.path),o=Zt(e,t,c.path,c.snap,r,i,a,s))}else if(n.type===El.MERGE){const c=n;c.source.fromUser?o=function(e,t,n,r,i,s,o){let a=t;return r.foreach(((r,c)=>{const u=Ye(n,r);tn(t,Ke(u))&&(a=en(e,a,u,c,i,s,o))})),r.foreach(((r,c)=>{const u=Ye(n,r);tn(t,Ke(u))||(a=en(e,a,u,c,i,s,o))})),a}(e,t,c.path,c.children,r,i,s):(Object(na.f)(c.source.fromServer,"Unknown source."),a=c.source.tagged||t.serverCache.isFiltered(),o=rn(e,t,c.path,c.children,r,i,a,s))}else if(n.type===El.ACK_USER_WRITE){const a=n;o=a.revert?function(e,t,n,r,i,s){let o;if(null!=Wt(r,n))return t;{const a=new Ll(r,t,i),c=t.eventCache.getNode();let u;if(Xe(n)||".priority"===Ke(n)){let n;if(t.serverCache.isFullyInitialized())n=zt(r,Ct(t));else{const e=t.serverCache.getNode();Object(na.f)(e instanceof hl,"serverChildren would be complete if leaf node"),n=Kt(r,e)}u=e.filter.updateFullNode(c,n,s)}else{const i=Ke(n);let l=Ht(r,i,t.serverCache);null==l&&t.serverCache.isCompleteForChild(i)&&(l=c.getImmediateChild(i)),u=null!=l?e.filter.updateChild(c,i,l,We(n),a,s):t.eventCache.getNode().hasChild(i)?e.filter.updateChild(c,i,hl.EMPTY_NODE,We(n),a,s):c,u.isEmpty()&&t.serverCache.isFullyInitialized()&&(o=zt(r,Ct(t)),o.isLeafNode()&&(u=e.filter.updateFullNode(u,o,s)))}return o=t.serverCache.isFullyInitialized()||null!=Wt(r,ze()),Tt(t,u,o,e.filter.filtersNodes())}}(e,t,a.path,r,i,s):function(e,t,n,r,i,s,o){if(null!=Wt(i,n))return t;const a=t.serverCache.isFiltered(),c=t.serverCache;if(null!=r.value){if(Xe(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return Zt(e,t,n,c.getNode().getChild(n),i,s,a,o);if(Xe(n)){let r=new Rl(null);return c.getNode().forEachChild(Wu,((e,t)=>{r=r.set(new ju(e),t)})),rn(e,t,n,r,i,s,a,o)}return t}{let u=new Rl(null);return r.foreach((e=>{const t=Ye(n,e);c.isCompleteForPath(t)&&(u=u.set(e,c.getNode().getChild(t)))})),rn(e,t,n,u,i,s,a,o)}}(e,t,a.path,a.affectedTree,r,i,s)}else{if(n.type!==El.LISTEN_COMPLETE)throw Object(na.g)("Unknown operation type: "+n.type);o=function(e,t,n,r,i){const s=t.serverCache,o=Et(t,s.getNode(),s.isFullyInitialized()||Xe(n),s.isFiltered());return Jt(e,o,n,r,Ml,i)}(e,t,n.path,r,s)}const c=s.getChanges();return function(e,t,n){const r=t.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=kt(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(at(kt(t)))}}(t,o,c),{viewCache:o,changes:c}}function Jt(e,t,n,r,i,s){const o=t.eventCache;if(null!=Wt(r,n))return t;{let a,c;if(Xe(n))if(Object(na.f)(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=Ct(t),i=Kt(r,n instanceof hl?n:hl.EMPTY_NODE);a=e.filter.updateFullNode(t.eventCache.getNode(),i,s)}else{const n=zt(r,Ct(t));a=e.filter.updateFullNode(t.eventCache.getNode(),n,s)}else{const u=Ke(n);if(".priority"===u){Object(na.f)(1===$e(n),"Can't have a priority with additional path components");const i=o.getNode();c=t.serverCache.getNode();const s=$t(r,n,i,c);a=null!=s?e.filter.updatePriority(i,s):o.getNode()}else{const l=We(n);let h;if(o.isCompleteForChild(u)){c=t.serverCache.getNode();const e=$t(r,n,o.getNode(),c);h=null!=e?o.getNode().getImmediateChild(u).updateChild(l,e):o.getNode().getImmediateChild(u)}else h=Ht(r,u,t.serverCache);a=null!=h?e.filter.updateChild(o.getNode(),u,h,l,i,s):o.getNode()}}return Tt(t,a,o.isFullyInitialized()||Xe(n),e.filter.filtersNodes())}}function Zt(e,t,n,r,i,s,o,a){const c=t.serverCache;let u;const l=o?e.filter:e.filter.getIndexedFilter();if(Xe(n))u=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){const e=c.getNode().updateChild(n,r);u=l.updateFullNode(c.getNode(),e,null)}else{const e=Ke(n);if(!c.isCompleteForPath(n)&&$e(n)>1)return t;const i=We(n),s=c.getNode().getImmediateChild(e).updateChild(i,r);u=".priority"===e?l.updatePriority(c.getNode(),s):l.updateChild(c.getNode(),e,s,i,Ml,null)}const h=Et(t,u,c.isFullyInitialized()||Xe(n),l.filtersNodes());return Jt(e,h,n,i,new Ll(i,h,s),a)}function en(e,t,n,r,i,s,o){const a=t.eventCache;let c,u;const l=new Ll(i,t,s);if(Xe(n))u=e.filter.updateFullNode(t.eventCache.getNode(),r,o),c=Tt(t,u,!0,e.filter.filtersNodes());else{const i=Ke(n);if(".priority"===i)u=e.filter.updatePriority(t.eventCache.getNode(),r),c=Tt(t,u,a.isFullyInitialized(),a.isFiltered());else{const s=We(n),u=a.getNode().getImmediateChild(i);let h;if(Xe(s))h=r;else{const e=l.getCompleteChild(i);h=null!=e?".priority"===Ge(s)&&e.getChild(Qe(s)).isEmpty()?e:e.updateChild(s,r):hl.EMPTY_NODE}if(u.equals(h))c=t;else{c=Tt(t,e.filter.updateChild(a.getNode(),i,h,s,l,o),a.isFullyInitialized(),e.filter.filtersNodes())}}}return c}function tn(e,t){return e.eventCache.isCompleteForChild(t)}function nn(e,t,n){return n.foreach(((e,n)=>{t=t.updateChild(e,n)})),t}function rn(e,t,n,r,i,s,o,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let c,u=t;c=Xe(n)?r:new Rl(null).setTree(n,r);const l=t.serverCache.getNode();return c.children.inorderTraversal(((n,r)=>{if(l.hasChild(n)){const c=nn(0,t.serverCache.getNode().getImmediateChild(n),r);u=Zt(e,u,new ju(n),c,i,s,o,a)}})),c.children.inorderTraversal(((n,r)=>{const c=!t.serverCache.isCompleteForChild(n)&&null===r.value;if(!l.hasChild(n)&&!c){const c=nn(0,t.serverCache.getNode().getImmediateChild(n),r);u=Zt(e,u,new ju(n),c,i,s,o,a)}})),u}function sn(e,t){const n=Ct(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!Xe(t)&&!n.getImmediateChild(Ke(t)).isEmpty())?n.getChild(t):null}function on(e){return 0===e.eventRegistrations_.length}function an(e,t,n){const r=[];if(n){Object(na.f)(null==t,"A cancel should cancel all event registrations.");const i=e.query._path;e.eventRegistrations_.forEach((e=>{const t=e.createCancelEvent(n,i);t&&r.push(t)}))}if(t){let n=[];for(let r=0;r<e.eventRegistrations_.length;++r){const i=e.eventRegistrations_[r];if(i.matches(t)){if(t.hasAnyCallback()){n=n.concat(e.eventRegistrations_.slice(r+1));break}}else n.push(i)}e.eventRegistrations_=n}else e.eventRegistrations_=[];return r}function cn(e,t,n,r){t.type===El.MERGE&&null!==t.source.queryId&&(Object(na.f)(Ct(e.viewCache_),"We should always have a full cache before handling merges"),Object(na.f)(kt(e.viewCache_),"Missing event cache, even though we have a server cache"));const i=e.viewCache_,s=Xt(e.processor_,i,t,n,r);var o,a;return o=e.processor_,a=s.viewCache,Object(na.f)(a.eventCache.getNode().isIndexed(o.filter.getIndex()),"Event snap not indexed"),Object(na.f)(a.serverCache.getNode().isIndexed(o.filter.getIndex()),"Server snap not indexed"),Object(na.f)(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,un(e,s.changes,s.viewCache.eventCache.getNode(),null)}function un(e,t,n,r){return function(e,t,n,r){const i=[],s=[];return t.forEach((t=>{"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&s.push({type:"child_moved",snapshotNode:t.snapshotNode,childName:t.childName})})),bt(e,i,"child_removed",t,r,n),bt(e,i,"child_added",t,r,n),bt(e,i,"child_moved",s,r,n),bt(e,i,"child_changed",t,r,n),bt(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,r?[r]:e.eventRegistrations_)}function ln(e,t,n,r){const i=t.source.queryId;if(null!==i){const s=e.views.get(i);return Object(na.f)(null!=s,"SyncTree gave us an op for an invalid query."),cn(s,t,n,r)}{let i=[];for(const s of e.views.values())i=i.concat(cn(s,t,n,r));return i}}function hn(e,t,n,r,i){const s=e.views.get(t._queryIdentifier);if(!s){let e=zt(n,i?r:null),s=!1;e?s=!0:r instanceof hl?(e=Kt(n,r),s=!1):(e=hl.EMPTY_NODE,s=!1);const o=It(new Al(e,s,!1),new Al(r,i,!1));return new jl(t,o)}return s}function dn(e,t,n,r,i,s){const o=hn(e,t,r,i,s);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),function(e,t){e.eventRegistrations_.push(t)}(o,n),function(e,t){const n=e.viewCache_.eventCache,r=[];n.getNode().isLeafNode()||n.getNode().forEachChild(rl,((e,t)=>{r.push(ct(e,t))}));return n.isFullyInitialized()&&r.push(at(n.getNode())),un(e,r,n.getNode(),t)}(o,n)}function fn(e,t,n,r){const i=t._queryIdentifier,s=[];let o=[];const a=yn(e);if("default"===i)for(const[t,i]of e.views.entries())o=o.concat(an(i,n,r)),on(i)&&(e.views.delete(t),i.query._queryParams.loadsAllData()||s.push(i.query));else{const t=e.views.get(i);t&&(o=o.concat(an(t,n,r)),on(t)&&(e.views.delete(i),t.query._queryParams.loadsAllData()||s.push(t.query)))}return a&&!yn(e)&&s.push(new(Object(na.f)(Fl,"Reference.ts has not been loaded"),Fl)(t._repo,t._path)),{removed:s,events:o}}function pn(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function gn(e,t){let n=null;for(const r of e.views.values())n=n||sn(r,t);return n}function mn(e,t){if(t._queryParams.loadsAllData())return vn(e);return e.views.get(t._queryIdentifier)}function _n(e,t){return null!=mn(e,t)}function yn(e){return null!=vn(e)}function vn(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}function wn(e,t,n,r,i){return function(e,t,n,r,i){Object(na.f)(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=St(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?An(e,new Sl({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function bn(e,t,n,r){!function(e,t,n,r){Object(na.f)(r>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:n,writeId:r,visible:!0}),e.visibleWrites=Ot(e.visibleWrites,t,n),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r);const i=Rl.fromObject(n);return An(e,new Ol({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,i))}function In(e,t,n=!1){const r=function(e,t){for(let n=0;n<e.allWrites.length;n++){const r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(Ft(e.pendingWriteTree_,t)){let t=new Rl(null);return null!=r.snap?t=t.set(ze(),!0):Ve(r.children,(e=>{t=t.set(new ju(e),!0)})),An(e,new kl(r.path,t,n))}return[]}function Tn(e,t,n){return An(e,new Sl({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function En(e,t,n,r,i=!1){const s=t._path,o=e.syncPointTree_.get(s);let a=[];if(o&&("default"===t._queryIdentifier||_n(o,t))){const c=fn(o,t,n,r);0===o.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(s));const u=c.removed;if(a=c.events,!i){const n=-1!==u.findIndex((e=>e._queryParams.loadsAllData())),i=e.syncPointTree_.findOnPath(s,((e,t)=>yn(t)));if(n&&!i){const t=e.syncPointTree_.subtree(s);if(!t.isEmpty()){const n=function(e){return e.fold(((e,t,n)=>{if(t&&yn(t)){return[vn(t)]}{let e=[];return t&&(e=pn(t)),Ve(n,((t,n)=>{e=e.concat(n)})),e}}))}(t);for(let t=0;t<n.length;++t){const r=n[t],i=r.query,s=Rn(e,r);e.listenProvider_.startListening(Fn(i),Dn(e,i),s.hashFn,s.onComplete)}}}if(!i&&u.length>0&&!r)if(n){const n=null;e.listenProvider_.stopListening(Fn(t),n)}else u.forEach((t=>{const n=e.queryToTagMap.get(xn(t));e.listenProvider_.stopListening(Fn(t),n)}))}!function(e,t){for(let n=0;n<t.length;++n){const r=t[n];if(!r._queryParams.loadsAllData()){const t=xn(r),n=e.queryToTagMap.get(t);e.queryToTagMap.delete(t),e.tagToQueryMap.delete(n)}}}(e,u)}return a}function kn(e,t,n,r){const i=Mn(e,r);if(null!=i){const r=Ln(i),s=r.path,o=r.queryId,a=Je(s,t);return jn(e,s,new Sl(wt(o),a,n))}return[]}function Cn(e,t,n,r=!1){const i=t._path;let s=null,o=!1;e.syncPointTree_.foreachOnPath(i,((e,t)=>{const n=Je(e,i);s=s||gn(t,n),o=o||yn(t)}));let a,c=e.syncPointTree_.get(i);if(c?(o=o||yn(c),s=s||gn(c,ze())):(c=new Vl,e.syncPointTree_=e.syncPointTree_.set(i,c)),null!=s)a=!0;else{a=!1,s=hl.EMPTY_NODE;e.syncPointTree_.subtree(i).foreachChild(((e,t)=>{const n=gn(t,ze());n&&(s=s.updateImmediateChild(e,n))}))}const u=_n(c,t);if(!u&&!t._queryParams.loadsAllData()){const n=xn(t);Object(na.f)(!e.queryToTagMap.has(n),"View does not exist, but we have a tag");const r=ql++;e.queryToTagMap.set(n,r),e.tagToQueryMap.set(r,n)}let l=dn(c,t,n,jt(e.pendingWriteTree_,i),s,a);if(!u&&!o&&!r){const n=mn(c,t);l=l.concat(function(e,t,n){const r=t._path,i=Dn(e,t),s=Rn(e,n),o=e.listenProvider_.startListening(Fn(t),i,s.hashFn,s.onComplete),a=e.syncPointTree_.subtree(r);if(i)Object(na.f)(!yn(a.value),"If we're adding a query, it shouldn't be shadowed");else{const t=a.fold(((e,t,n)=>{if(!Xe(e)&&t&&yn(t))return[vn(t).query];{let e=[];return t&&(e=e.concat(pn(t).map((e=>e.query)))),Ve(n,((t,n)=>{e=e.concat(n)})),e}}));for(let n=0;n<t.length;++n){const r=t[n];e.listenProvider_.stopListening(Fn(r),Dn(e,r))}}return o}(e,t,n))}return l}function Sn(e,t,n){const r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,((e,n)=>{const r=gn(n,Je(e,t));if(r)return r}));return Bt(r,t,i,n,!0)}function On(e,t){const n=t._path;let r=null;e.syncPointTree_.foreachOnPath(n,((e,t)=>{const i=Je(e,n);r=r||gn(t,i)}));let i=e.syncPointTree_.get(n);i?r=r||gn(i,ze()):(i=new Vl,e.syncPointTree_=e.syncPointTree_.set(n,i));const s=null!=r,o=s?new Al(r,!0,!1):null;return function(e){return kt(e.viewCache_)}(hn(i,t,jt(e.pendingWriteTree_,t._path),s?o.getNode():hl.EMPTY_NODE,s))}function An(e,t){return Nn(t,e.syncPointTree_,null,jt(e.pendingWriteTree_,ze()))}function Nn(e,t,n,r){if(Xe(e.path))return Pn(e,t,n,r);{const i=t.get(ze());null==n&&null!=i&&(n=gn(i,ze()));let s=[];const o=Ke(e.path),a=e.operationForChild(o),c=t.children.get(o);if(c&&a){const e=n?n.getImmediateChild(o):null,t=Qt(r,o);s=s.concat(Nn(a,c,e,t))}return i&&(s=s.concat(ln(i,e,r,n))),s}}function Pn(e,t,n,r){const i=t.get(ze());null==n&&null!=i&&(n=gn(i,ze()));let s=[];return t.children.inorderTraversal(((t,i)=>{const o=n?n.getImmediateChild(t):null,a=Qt(r,t),c=e.operationForChild(t);c&&(s=s.concat(Pn(c,i,o,a)))})),i&&(s=s.concat(ln(i,e,r,n))),s}function Rn(e,t){const n=t.query,r=Dn(e,n);return{hashFn:()=>{const e=function(e){return e.viewCache_.serverCache.getNode()}(t)||hl.EMPTY_NODE;return e.hash()},onComplete:t=>{if("ok"===t)return r?function(e,t,n){const r=Mn(e,n);if(r){const n=Ln(r),i=n.path,s=n.queryId,o=Je(i,t);return jn(e,i,new Cl(wt(s),o))}return[]}(e,n._path,r):function(e,t){return An(e,new Cl({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);{const r=function(e,t){let n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");const r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(t,n);return En(e,n,null,r)}}}}function Dn(e,t){const n=xn(t);return e.queryToTagMap.get(n)}function xn(e){return e._path.toString()+"$"+e._queryIdentifier}function Mn(e,t){return e.tagToQueryMap.get(t)}function Ln(e){const t=e.indexOf("$");return Object(na.f)(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new ju(e.substr(0,t))}}function jn(e,t,n){const r=e.syncPointTree_.get(t);Object(na.f)(r,"Missing sync point for query tag that we're tracking");return ln(r,n,jt(e.pendingWriteTree_,t),null)}function Fn(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(Object(na.f)(Ul,"Reference.ts has not been loaded"),Ul)(e._repo,e._path):e}function Un(e,t,n){const r=e.getPriority().val(),i=Wl(r,t.getImmediateChild(".priority"),n);let s;if(e.isLeafNode()){const r=e,s=Wl(r.getValue(),t,n);return s!==r.getValue()||i!==r.getPriority().val()?new nl(s,ot(i)):e}{const r=e;return s=r,i!==r.getPriority().val()&&(s=s.updatePriority(new nl(i))),r.forEachChild(rl,((e,r)=>{const i=Un(r,t.getImmediateChild(e),n);i!==r&&(s=s.updateImmediateChild(e,i))})),s}}function Vn(e,t){let n=t instanceof ju?t:new ju(t),r=e,i=Ke(n);for(;null!==i;){const e=Object(na.S)(r.node.children,i)||{children:{},childCount:0};r=new Xl(i,r,e),n=We(n),i=Ke(n)}return r}function qn(e){return e.node.value}function Bn(e,t){e.node.value=t,Gn(e)}function zn(e){return e.node.childCount>0}function Kn(e,t){Ve(e.node.children,((n,r)=>{t(new Xl(n,e,r))}))}function $n(e,t,n,r){n&&!r&&t(e),Kn(e,(e=>{$n(e,t,!0,r)})),n&&r&&t(e)}function Wn(e){return new ju(null===e.parent?e.name:Wn(e.parent)+"/"+e.name)}function Gn(e){null!==e.parent&&function(e,t,n){const r=function(e){return void 0===qn(e)&&!zn(e)}(n),i=Object(na.m)(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,Gn(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,Gn(e))}(e.parent,e.name,e)}function Hn(e,t){let n=null;for(let r=0;r<t.length;r++){const i=t[r],s=i.getPath();null===n||et(s,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:s}),n.events.push(i)}n&&e.eventLists_.push(n)}function Qn(e,t,n){Hn(e,n),Xn(e,(e=>et(e,t)))}function Yn(e,t,n){Hn(e,n),Xn(e,(e=>tt(e,t)||tt(t,e)))}function Xn(e,t){e.recursionDepth_++;let n=!0;for(let r=0;r<e.eventLists_.length;r++){const i=e.eventLists_[r];if(i){t(i.path)?(Jn(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}}n&&(e.eventLists_=[]),e.recursionDepth_--}function Jn(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const r=n.getEventRunner();$c&&Hc("event: "+n.toString()),lu(r)}}}function Zn(e,t,n){if(e.stats_=Be(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new wl(e.repoInfo_,((t,n,r,i)=>{nr(e,t,n,r,i)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((()=>rr(e,!0)),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Object(na.V)(n)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}e.persistentConnection_=new qu(e.repoInfo_,t,((t,n,r,i)=>{nr(e,t,n,r,i)}),(t=>{rr(e,t)}),(t=>{!function(e,t){Ve(t,((t,n)=>{ir(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((t=>{e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((t=>{e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(e,t){const n=e.toString();return Tu[n]||(Tu[n]=t()),Tu[n]}(e.repoInfo_,(()=>new Tl(e.stats_,e.server_))),e.infoData_=new bl,e.infoSyncTree_=new Bl({startListening:(t,n,r,i)=>{let s=[];const o=e.infoData_.getNode(t._path);return o.isEmpty()||(s=Tn(e.infoSyncTree_,t._path,o),setTimeout((()=>{i("ok")}),0)),s},stopListening:()=>{}}),ir(e,"connected",!1),e.serverSyncTree_=new Bl({startListening:(t,n,r,i)=>(e.server_.listen(t,r,n,((n,r)=>{const s=i(n,r);Yn(e.eventQueue_,t._path,s)})),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function er(e){const t=e.infoData_.getNode(new ju(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function tr(e){return $l({timestamp:er(e)})}function nr(e,t,n,r,i){e.dataUpdateCount++;const s=new ju(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let o=[];if(i)if(r){const t=Object(na.P)(n,(e=>ot(e)));o=function(e,t,n,r){const i=Mn(e,r);if(i){const r=Ln(i),s=r.path,o=r.queryId,a=Je(s,t),c=Rl.fromObject(n);return jn(e,s,new Ol(wt(o),a,c))}return[]}(e.serverSyncTree_,s,t,i)}else{const t=ot(n);o=kn(e.serverSyncTree_,s,t,i)}else if(r){const t=Object(na.P)(n,(e=>ot(e)));o=function(e,t,n){const r=Rl.fromObject(n);return An(e,new Ol({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,s,t)}else{const t=ot(n);o=Tn(e.serverSyncTree_,s,t)}let a=s;o.length>0&&(a=gr(e,s)),Yn(e.eventQueue_,a,o)}function rr(e,t){ir(e,"connected",t),!1===t&&function(e){hr(e,"onDisconnectEvents");const t=tr(e),n=mt();vt(e.onDisconnect_,ze(),((r,i)=>{const s=Ql(r,i,e.serverSyncTree_,t);_t(n,r,s)}));let r=[];vt(n,ze(),((t,n)=>{r=r.concat(Tn(e.serverSyncTree_,t,n));const i=wr(e,t);gr(e,i)})),e.onDisconnect_=mt(),Yn(e.eventQueue_,ze(),r)}(e)}function ir(e,t,n){const r=new ju("/.info/"+t),i=ot(n);e.infoData_.updateSnapshot(r,i);const s=Tn(e.infoSyncTree_,r,i);Yn(e.eventQueue_,r,s)}function sr(e){return e.nextWriteId_++}function or(e,t,n,r,i){hr(e,"set",{path:t.toString(),value:n,priority:r});const s=tr(e),o=ot(n,r),a=Sn(e.serverSyncTree_,t),c=Yl(o,a,s),u=sr(e),l=wn(e.serverSyncTree_,t,c,u,!0);Hn(e.eventQueue_,l),e.server_.put(t.toString(),o.val(!0),((n,r)=>{const s="ok"===n;s||Jc("set at "+t+" failed: "+n);const o=In(e.serverSyncTree_,u,!s);Yn(e.eventQueue_,t,o),dr(e,i,n,r)}));const h=wr(e,t);gr(e,h),Yn(e.eventQueue_,h,[])}function ar(e,t,n){e.server_.onDisconnectCancel(t.toString(),((r,i)=>{"ok"===r&&yt(e.onDisconnect_,t),dr(e,n,r,i)}))}function cr(e,t,n,r){const i=ot(n);e.server_.onDisconnectPut(t.toString(),i.val(!0),((n,s)=>{"ok"===n&&_t(e.onDisconnect_,t,i),dr(e,r,n,s)}))}function ur(e,t,n){let r;r=".info"===Ke(t._path)?En(e.infoSyncTree_,t,n):En(e.serverSyncTree_,t,n),Qn(e.eventQueue_,t._path,r)}function lr(e){e.persistentConnection_&&e.persistentConnection_.interrupt(ph)}function hr(e,...t){let n="";e.persistentConnection_&&(n=e.persistentConnection_.id+":"),Hc(n,...t)}function dr(e,t,n,r){t&&lu((()=>{if("ok"===n)t(null);else{const e=(n||"error").toUpperCase();let i=e;r&&(i+=": "+r);const s=new Error(i);s.code=e,t(s)}}))}function fr(e,t,n){return Sn(e.serverSyncTree_,t,n)||hl.EMPTY_NODE}function pr(e,t=e.transactionQueueTree_){if(t||vr(e,t),qn(t)){const n=_r(e,t);Object(na.f)(n.length>0,"Sending zero length transaction queue");n.every((e=>0===e.status))&&function(e,t,n){const r=n.map((e=>e.currentWriteId)),i=fr(e,t,r);let s=i;const o=i.hash();for(let e=0;e<n.length;e++){const r=n[e];Object(na.f)(0===r.status,"tryToSendTransactionQueue_: items in queue should all be run."),r.status=1,r.retryCount++;const i=Je(t,r.path);s=s.updateChild(i,r.currentOutputSnapshotRaw)}const a=s.val(!0),c=t;e.server_.put(c.toString(),a,(r=>{hr(e,"transaction put response",{path:c.toString(),status:r});let i=[];if("ok"===r){const r=[];for(let t=0;t<n.length;t++)n[t].status=2,i=i.concat(In(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&r.push((()=>n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved))),n[t].unwatcher();vr(e,Vn(e.transactionQueueTree_,t)),pr(e,e.transactionQueueTree_),Yn(e.eventQueue_,t,i);for(let e=0;e<r.length;e++)lu(r[e])}else{if("datastale"===r)for(let e=0;e<n.length;e++)n[e].status=3===n[e].status?4:0;else{Jc("transaction at "+c.toString()+" failed: "+r);for(let e=0;e<n.length;e++)n[e].status=4,n[e].abortReason=r}gr(e,t)}}),o)}(e,Wn(t),n)}else zn(t)&&Kn(t,(t=>{pr(e,t)}))}function gr(e,t){const n=mr(e,t),r=Wn(n);return function(e,t,n){if(0===t.length)return;const r=[];let i=[];const s=t.filter((e=>0===e.status)),o=s.map((e=>e.currentWriteId));for(let s=0;s<t.length;s++){const a=t[s],c=Je(n,a.path);let u,l=!1;if(Object(na.f)(null!==c,"rerunTransactionsUnderNode_: relativePath should not be null."),4===a.status)l=!0,u=a.abortReason,i=i.concat(In(e.serverSyncTree_,a.currentWriteId,!0));else if(0===a.status)if(a.retryCount>=gh)l=!0,u="maxretry",i=i.concat(In(e.serverSyncTree_,a.currentWriteId,!0));else{const n=fr(e,a.path,o);a.currentInputSnapshot=n;const r=t[s].update(n.val());if(void 0!==r){sh("transaction failed: Data returned ",r,a.path);let t=ot(r);"object"==typeof r&&null!=r&&Object(na.m)(r,".priority")||(t=t.updatePriority(n.getPriority()));const s=a.currentWriteId,c=tr(e),u=Yl(t,n,c);a.currentOutputSnapshotRaw=t,a.currentOutputSnapshotResolved=u,a.currentWriteId=sr(e),o.splice(o.indexOf(s),1),i=i.concat(wn(e.serverSyncTree_,a.path,u,a.currentWriteId,a.applyLocally)),i=i.concat(In(e.serverSyncTree_,s,!0))}else l=!0,u="nodata",i=i.concat(In(e.serverSyncTree_,a.currentWriteId,!0))}Yn(e.eventQueue_,n,i),i=[],l&&(t[s].status=2,setTimeout(t[s].unwatcher,Math.floor(0)),t[s].onComplete&&r.push("nodata"===u?()=>t[s].onComplete(null,!1,t[s].currentInputSnapshot):()=>t[s].onComplete(new Error(u),!1,null)))}vr(e,e.transactionQueueTree_);for(let e=0;e<r.length;e++)lu(r[e]);pr(e,e.transactionQueueTree_)}(e,_r(e,n),r),r}function mr(e,t){let n,r=e.transactionQueueTree_;for(n=Ke(t);null!==n&&void 0===qn(r);)r=Vn(r,n),n=Ke(t=We(t));return r}function _r(e,t){const n=[];return yr(e,t,n),n.sort(((e,t)=>e.order-t.order)),n}function yr(e,t,n){const r=qn(t);if(r)for(let e=0;e<r.length;e++)n.push(r[e]);Kn(t,(t=>{yr(e,t,n)}))}function vr(e,t){const n=qn(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,Bn(t,n.length>0?n:void 0)}Kn(t,(t=>{vr(e,t)}))}function wr(e,t){const n=Wn(mr(e,t)),r=Vn(e.transactionQueueTree_,t);return function(e,t,n){let r=n?e:e.parent;for(;null!==r;){if(t(r))return!0;r=r.parent}}(r,(t=>{br(e,t)})),br(e,r),$n(r,(t=>{br(e,t)})),n}function br(e,t){const n=qn(t);if(n){const r=[];let i=[],s=-1;for(let t=0;t<n.length;t++)3===n[t].status||(1===n[t].status?(Object(na.f)(s===t-1,"All SENT items should be at beginning of queue."),s=t,n[t].status=3,n[t].abortReason="set"):(Object(na.f)(0===n[t].status,"Unexpected transaction status in abort"),n[t].unwatcher(),i=i.concat(In(e.serverSyncTree_,n[t].currentWriteId,!0)),n[t].onComplete&&r.push(n[t].onComplete.bind(null,new Error("set"),!1,null))));-1===s?Bn(t,void 0):n.length=s+1,Yn(e.eventQueue_,Wn(t),i);for(let e=0;e<r.length;e++)lu(r[e])}}function Ir(e,t){if(!0===e._orderByCalled)throw new Error(t+": You can't combine multiple orderBy calls.")}function Tr(e){let t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===Wu){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==eu)throw new Error(r);if("string"!=typeof t)throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!==tu)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(e.getIndex()===rl){if(null!=t&&!rh(t)||null!=n&&!rh(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(Object(na.f)(e.getIndex()instanceof pl||e.getIndex()===gl,"unknown index type."),null!=t&&"object"==typeof t||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Er(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}function kr(e,t){return(e=Object(na.z)(e))._checkNotDeleted("ref"),void 0!==t?Sr(e._root,t):e._root}function Cr(e,t){(e=Object(na.z)(e))._checkNotDeleted("refFromURL");const n=_h(t,e._repo.repoInfo_.nodeAdmin);dh("refFromURL",n);const r=n.repoInfo;return e._repo.repoInfo_.isCustomHost()||r.host===e._repo.repoInfo_.host||Xc("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+e._repo.repoInfo_.host+")"),kr(e,n.path.toString())}function Sr(e,t){return null===Ke((e=Object(na.z)(e))._path)?lh("child","path",t,!1):uh("child","path",t,!1),new Ch(e._repo,Ye(e._path,t))}function Or(e,t){e=Object(na.z)(e),hh("set",e._path),ih("set",t,e._path,!1);const n=new na.a;return or(e._repo,e._path,t,null,n.wrapCallback((()=>{}))),n.promise}function Ar(e,t){oh("update",t,e._path,!1);const n=new na.a;return function(e,t,n,r){hr(e,"update",{path:t.toString(),value:n});let i=!0;const s=tr(e),o={};if(Ve(n,((n,r)=>{i=!1,o[n]=Ql(Ye(t,n),ot(r),e.serverSyncTree_,s)})),i)Hc("update() called with empty data.  Don't do anything."),dr(0,r,"ok",void 0);else{const i=sr(e),s=bn(e.serverSyncTree_,t,o,i);Hn(e.eventQueue_,s),e.server_.merge(t.toString(),n,((n,s)=>{const o="ok"===n;o||Jc("update at "+t+" failed: "+n);const a=In(e.serverSyncTree_,i,!o),c=a.length>0?gr(e,t):t;Yn(e.eventQueue_,c,a),dr(0,r,n,s)})),Ve(n,(n=>{const r=wr(e,Ye(t,n));gr(e,r)})),Yn(e.eventQueue_,t,[])}}(e._repo,e._path,t,n.wrapCallback((()=>{}))),n.promise}function Nr(e){e=Object(na.z)(e);const t=new Th((()=>{})),n=new Oh(t);return function(e,t,n){const r=On(e.serverSyncTree_,t);return null!=r?Promise.resolve(r):e.server_.get(t).then((r=>{const i=ot(r).withIndex(t._queryParams.getIndex());let s;if(Cn(e.serverSyncTree_,t,n,!0),t._queryParams.loadsAllData())s=Tn(e.serverSyncTree_,t._path,i);else{const n=Dn(e.serverSyncTree_,t);s=kn(e.serverSyncTree_,t._path,i,n)}return Yn(e.eventQueue_,t._path,s),En(e.serverSyncTree_,t,n,null,!0),i}),(n=>(hr(e,"get for query "+Object(na.V)(t)+" failed: "+n),Promise.reject(new Error(n)))))}(e._repo,e,n).then((t=>new Sh(t,new Ch(e._repo,e._path),e._queryParams.getIndex())))}function Pr(e,t,n,r,i){let s;if("object"==typeof r&&(s=void 0,i=r),"function"==typeof r&&(s=r),i&&i.onlyOnce){const t=n,r=(n,r)=>{ur(e._repo,e,a),t(n,r)};r.userCallback=n.userCallback,r.context=n.context,n=r}const o=new Th(n,s||void 0),a="value"===t?new Oh(o):new Ah(t,o);return function(e,t,n){let r;r=".info"===Ke(t._path)?Cn(e.infoSyncTree_,t,n):Cn(e.serverSyncTree_,t,n),Qn(e.eventQueue_,t._path,r)}(e._repo,e,a),()=>ur(e._repo,e,a)}function Rr(e,t,n,r){return Pr(e,"value",t,n,r)}function Dr(e,t,n,r){return Pr(e,"child_added",t,n,r)}function xr(e,t,n,r){return Pr(e,"child_changed",t,n,r)}function Mr(e,t,n,r){return Pr(e,"child_moved",t,n,r)}function Lr(e,t,n,r){return Pr(e,"child_removed",t,n,r)}function jr(e,t,n){let r=null;const i=n?new Th(n):null;"value"===t?r=new Oh(i):t&&(r=new Ah(t,i)),ur(e._repo,e,r)}function Fr(e,...t){let n=Object(na.z)(e);for(const e of t)n=e._apply(n);return n}function Ur(e,t,n,r,i){let s=r||e.options.databaseURL;void 0===s&&(e.options.projectId||Xc("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Hc("Using default host for project ",e.options.projectId),s=`${e.options.projectId}-default-rtdb.firebaseio.com`);let o,a,c=_h(s,i),u=c.repoInfo;"undefined"!=typeof process&&process.env&&(a=process.env[Bh]),a?(o=!0,s=`http://${a}?ns=${u.namespace}`,c=_h(s,i),u=c.repoInfo):o=!c.repoInfo.secure;const l=i&&o?new pu(pu.OWNER):new fu(e.name,e.options,t);dh("Invalid Firebase Database URL",c),Xe(c.path)||Xc("Database URL must point to the root of a Firebase Database (not including a child path).");const h=function(e,t,n,r){let i=zh[t.name];i||(i={},zh[t.name]=i);let s=i[e.toURLString()];s&&Xc("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return s=new mh(e,Kh,n,r),i[e.toURLString()]=s,s}(u,e,l,new du(e.name,n));return new $h(h,e)}function Vr(){Nu.IS_TRANSPORT_INITIALIZED&&Jc("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function qr(){Vr(),Cu.forceDisallow()}function Br(){Vr(),Au.forceDisallow(),Cu.forceAllow()}function zr(e,t,n,r={}){(e=Object(na.z)(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&Xc("Cannot call useEmulator() after instance has already been initialized.");const i=e._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Xc('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new pu(pu.OWNER);else if(r.mockUserToken){const t="string"==typeof r.mockUserToken?r.mockUserToken:Object(na.n)(r.mockUserToken,e.app.options.projectId);s=new pu(t)}!function(e,t,n,r){e.repoInfo_=new wu(`${t}:${n}`,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0),r&&(e.authTokenProvider_=r)}(i,t,n,s)}function Kr(e){var t;(e=Object(na.z)(e))._checkNotDeleted("goOnline"),(t=e._repo).persistentConnection_&&t.persistentConnection_.resume(ph)}function $r(e,t){Gc(e,t)}function Wr(e,t,n){var r;if(e=Object(na.z)(e),hh("Reference.transaction",e._path),".length"===e.key||".keys"===e.key)throw"Reference.transaction failed: "+e.key+" is a read-only object.";const i=null===(r=null==n?void 0:n.applyLocally)||void 0===r||r,s=new na.a,o=Rr(e,(()=>{}));return function(e,t,n,r,i,s){hr(e,"transaction on "+t);const o={path:t,update:n,onComplete:r,status:null,order:Bc(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=fr(e,t,void 0);o.currentInputSnapshot=a;const c=o.update(a.val());if(void 0===c)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{sh("transaction failed: Data returned ",c,o.path),o.status=0;const n=Vn(e.transactionQueueTree_,t),r=qn(n)||[];let i;r.push(o),Bn(n,r),"object"==typeof c&&null!==c&&Object(na.m)(c,".priority")?(i=Object(na.S)(c,".priority"),Object(na.f)(rh(i),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):i=(Sn(e.serverSyncTree_,t)||hl.EMPTY_NODE).getPriority().val();const s=tr(e),u=ot(c,i),l=Yl(u,a,s);o.currentOutputSnapshotRaw=u,o.currentOutputSnapshotResolved=l,o.currentWriteId=sr(e);const h=wn(e.serverSyncTree_,t,l,o.currentWriteId,o.applyLocally);Yn(e.eventQueue_,t,h),pr(e,e.transactionQueueTree_)}}(e._repo,e._path,t,((t,n,r)=>{let i=null;t?s.reject(t):(i=new Sh(r,new Ch(e._repo,e._path),rl),s.resolve(new Gh(n,i)))}),o,i),s.promise}function Gr(){return Gr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Gr.apply(this,arguments)}function Hr(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new od.g("invalid-argument",`Invalid options passed to function ${e}(): You cannot specify both "merge" and "mergeFields".`);return t}function Qr(){if("undefined"==typeof Uint8Array)throw new od.g("unimplemented","Uint8Arrays are not available in this environment.")}function Yr(){if(!Object(od.r)())throw new od.g("unimplemented","Blobs are unavailable in Firestore in this environment.")}function Xr(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const e of t)if(e in n&&"function"==typeof n[e])return!0;return!1}(e,["next","error","complete"])}function Jr(e,t,n){return e.message=e.message.replace(t,n),e}function Zr(e){for(const t of e)if("object"==typeof t&&!Xr(t))return t;return{}}function ei(e,t){var n,r;let i;return i=Xr(e[0])?e[0]:Xr(e[1])?e[1]:"function"==typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]},{next:e=>{i.next&&i.next(t(e))},error:null===(n=i.error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}function ti(e){return Object(od.p)(e,od.d)}function ni(e,t){const n={};for(const r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r]));return n}function ri(e){if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"==typeof e&&isFinite(e))return e;if(!0===e||!1===e)return e;if("[object String]"===Object.prototype.toString.call(e))return e;if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.map((e=>ri(e)));if("function"==typeof e||"object"==typeof e)return ni(e,(e=>ri(e)));throw new Error("Data cannot be encoded in JSON: "+e)}function ii(e){if(null==e)return e;if(e["@type"])switch(e["@type"]){case Ed:case kd:{const t=Number(e.value);if(isNaN(t))throw new Error("Data cannot be decoded from JSON: "+e);return t}default:throw new Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map((e=>ii(e))):"function"==typeof e||"object"==typeof e?ni(e,(e=>ii(e))):e}function si(e,t,n){return r=>function(e,t,n,r){const i=e._url(t);return ai(e,i,n,r)}(e,t,r,n||{})}async function oi(e,t,n,r){let i;n["Content-Type"]="application/json";try{i=await r(e,{method:"POST",body:JSON.stringify(t),headers:n})}catch(e){return{status:0,json:null}}let s=null;try{s=await i.json()}catch(e){}return{status:i.status,json:s}}async function ai(e,t,n,r){const i={data:n=ri(n)},s={},o=await e.contextProvider.getContext(r.limitedUseAppCheckTokens);o.authToken&&(s.Authorization="Bearer "+o.authToken),o.messagingToken&&(s["Firebase-Instance-ID-Token"]=o.messagingToken),null!==o.appCheckToken&&(s["X-Firebase-AppCheck"]=o.appCheckToken);const a=function(e){let t=null;return{promise:new Promise(((n,r)=>{t=setTimeout((()=>{r(new Od("deadline-exceeded","deadline-exceeded"))}),e)})),cancel:()=>{t&&clearTimeout(t)}}}(r.timeout||7e4),c=await Promise.race([oi(t,i,s,e.fetchImpl),a.promise,e.cancelAllRequests]);if(a.cancel(),!c)throw new Od("cancelled","Firebase Functions instance was deleted.");const u=function(e,t){let n,r=function(e){if(e>=200&&e<300)return"ok";switch(e){case 0:case 500:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(e),i=r;try{const e=t&&t.error;if(e){const t=e.status;if("string"==typeof t){if(!Sd[t])return new Od("internal","internal");r=Sd[t],i=t}const s=e.message;"string"==typeof s&&(i=s),n=e.details,void 0!==n&&(n=ii(n))}}catch(e){}return"ok"===r?null:new Od(r,i,n)}(c.status,c.json);if(u)throw u;if(!c.json)throw new Od("internal","Response is not valid JSON object.");let l=c.json.data;if(void 0===l&&(l=c.json.result),void 0===l)throw new Od("internal","Response is missing data field.");return{data:ii(l)}}function ci(e,t,n){!function(e,t,n){e.emulatorOrigin=`http://${t}:${n}`}(Object(na.z)(e),t,n)}function ui(e,t,n){return function(e,t,n){return r=>ai(e,t,r,n||{})}(Object(na.z)(e),t,n)}function li(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Fd||(Fd=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply($d(this),t),di(Ud.get(this))}:function(...t){return di(e.apply($d(this),t))}:function(t,...n){const r=e.call($d(this),t,...n);return qd.set(r,t.sort?t.sort():[t]),di(r)}}function hi(e){return"function"==typeof e?li(e):(e instanceof IDBTransaction&&function(e){if(Vd.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)}));Vd.set(e,t)}(e),Ld(e,jd||(jd=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,Kd):e)}function di(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(di(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&Ud.set(t,e)})).catch((()=>{})),zd.set(t,e),t}(e);if(Bd.has(e))return Bd.get(e);const t=hi(e);return t!==e&&(Bd.set(e,t),zd.set(t,e)),t}function fi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fi(Object(n),!0).forEach((function(t){gi(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gi(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mi(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(e,t),a=di(o);return r&&o.addEventListener("upgradeneeded",(e=>{r(di(o.result),e.oldVersion,e.newVersion,di(o.transaction))})),n&&o.addEventListener("blocked",(()=>n())),a.then((e=>{s&&e.addEventListener("close",(()=>s())),i&&e.addEventListener("versionchange",(()=>i()))})).catch((()=>{})),a}function _i(e,{blocked:t}={}){const n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",(()=>t())),di(n).then((()=>{}))}function yi(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Hd.get(t))return Hd.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=Gd.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!Wd.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,i?"readwrite":"readonly");let o=s.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),i&&s.done]))[0]};return Hd.set(t,s),s}function vi(){return vi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vi.apply(this,arguments)}function wi(e){const t=new Uint8Array(e);return btoa(String.fromCharCode(...t)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function bi(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length);for(let e=0;e<n.length;++e)r[e]=n.charCodeAt(e);return r}function Ii(){return hf||(hf=mi(cf,uf,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(lf)}})),hf}async function Ti(e){const t=ki(e),n=await Ii(),r=await n.transaction(lf).objectStore(lf).get(t);if(r)return r;{const t=await async function(e){if("databases"in indexedDB){const e=(await indexedDB.databases()).map((e=>e.name));if(!e.includes(sf))return null}let t=null;return(await mi(sf,of,{upgrade:async(n,r,i,s)=>{var o;if(r<2)return;if(!n.objectStoreNames.contains(af))return;const a=s.objectStore(af),c=await a.index("fcmSenderId").get(e);if(await a.clear(),c)if(2===r){const e=c;if(!e.auth||!e.p256dh||!e.endpoint)return;t={token:e.fcmToken,createTime:null!==(o=e.createTime)&&void 0!==o?o:Date.now(),subscriptionOptions:{auth:e.auth,p256dh:e.p256dh,endpoint:e.endpoint,swScope:e.swScope,vapidKey:"string"==typeof e.vapidKey?e.vapidKey:wi(e.vapidKey)}}}else if(3===r){const e=c;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:wi(e.auth),p256dh:wi(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:wi(e.vapidKey)}}}else if(4===r){const e=c;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:wi(e.auth),p256dh:wi(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:wi(e.vapidKey)}}}}})).close(),await _i(sf),await _i("fcm_vapid_details_db"),await _i("undefined"),function(e){if(!e||!e.subscriptionOptions)return!1;const{subscriptionOptions:t}=e;return"number"==typeof e.createTime&&e.createTime>0&&"string"==typeof e.token&&e.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}(t)?t:null}(e.appConfig.senderId);if(t)return await Ei(e,t),t}}async function Ei(e,t){const n=ki(e),r=(await Ii()).transaction(lf,"readwrite");return await r.objectStore(lf).put(t,n),await r.done,t}function ki({appConfig:e}){return e.appId}async function Ci(e,t){const n={method:"DELETE",headers:await Oi(e)};try{const r=await fetch(`${Si(e.appConfig)}/${t}`,n),i=await r.json();if(i.error){throw df.create("token-unsubscribe-failed",{errorInfo:i.error.message})}}catch(e){throw df.create("token-unsubscribe-failed",{errorInfo:null==e?void 0:e.toString()})}}function Si({projectId:e}){return`${Jd}/projects/${e}/registrations`}async function Oi({appConfig:e,installations:t}){const n=await t.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function Ai({p256dh:e,auth:t,endpoint:n,vapidKey:r}){const i={web:{endpoint:n,auth:t,p256dh:e}};return r!==Xd&&(i.web.applicationPubKey=r),i}async function Ni(e){const t=await async function(e,t){const n=await e.pushManager.getSubscription();if(n)return n;return e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:bi(t)})}(e.swRegistration,e.vapidKey),n={vapidKey:e.vapidKey,swScope:e.swRegistration.scope,endpoint:t.endpoint,auth:wi(t.getKey("auth")),p256dh:wi(t.getKey("p256dh"))},r=await Ti(e.firebaseDependencies);if(r){if(function(e,t){const n=t.endpoint===e.endpoint,r=t.auth===e.auth,i=t.p256dh===e.p256dh;return t.vapidKey===e.vapidKey&&n&&r&&i}(r.subscriptionOptions,n))return Date.now()>=r.createTime+ff?async function(e,t){try{const n=await async function(e,t){const n=await Oi(e),r=Ai(t.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)};let s;try{const n=await fetch(`${Si(e.appConfig)}/${t.token}`,i);s=await n.json()}catch(e){throw df.create("token-update-failed",{errorInfo:null==e?void 0:e.toString()})}if(s.error)throw df.create("token-update-failed",{errorInfo:s.error.message});if(!s.token)throw df.create("token-update-no-token");return s.token}(e.firebaseDependencies,t),r=vi(vi({},t),{token:n,createTime:Date.now()});return await Ei(e.firebaseDependencies,r),n}catch(t){throw await Pi(e),t}}(e,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await Ci(e.firebaseDependencies,r.token)}catch(e){console.warn(e)}return Ri(e.firebaseDependencies,n)}return Ri(e.firebaseDependencies,n)}async function Pi(e){const t=await Ti(e.firebaseDependencies);t&&(await Ci(e.firebaseDependencies,t.token),await async function(e){const t=ki(e),n=(await Ii()).transaction(lf,"readwrite");await n.objectStore(lf).delete(t),await n.done}(e.firebaseDependencies));const n=await e.swRegistration.pushManager.getSubscription();return!n||n.unsubscribe()}async function Ri(e,t){const n=await async function(e,t){const n=await Oi(e),r=Ai(t),i={method:"POST",headers:n,body:JSON.stringify(r)};let s;try{const t=await fetch(Si(e.appConfig),i);s=await t.json()}catch(e){throw df.create("token-subscribe-failed",{errorInfo:null==e?void 0:e.toString()})}if(s.error)throw df.create("token-subscribe-failed",{errorInfo:s.error.message});if(!s.token)throw df.create("token-subscribe-no-token");return s.token}(e,t),r={token:n,createTime:Date.now(),subscriptionOptions:t};return await Ei(e,r),r.token}function Di(e){const t={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return function(e,t){if(!t.notification)return;e.notification={};const n=t.notification.title;n&&(e.notification.title=n);const r=t.notification.body;r&&(e.notification.body=r);const i=t.notification.image;i&&(e.notification.image=i);const s=t.notification.icon;s&&(e.notification.icon=s)}(t,e),function(e,t){if(!t.data)return;e.data=t.data}(t,e),function(e,t){var n,r,i,s,o;if(!t.fcmOptions&&!(null===(n=t.notification)||void 0===n?void 0:n.click_action))return;e.fcmOptions={};const a=null!==(i=null===(r=t.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==i?i:null===(s=t.notification)||void 0===s?void 0:s.click_action;a&&(e.fcmOptions.link=a);const c=null===(o=t.fcmOptions)||void 0===o?void 0:o.analytics_label;c&&(e.fcmOptions.analyticsLabel=c)}(t,e),t}function xi(e,t){const n=[];for(let r=0;r<e.length;r++)n.push(e.charAt(r)),r<t.length&&n.push(t.charAt(r));return n.join("")}function Mi(e){return df.create("missing-app-config-values",{valueName:e})}async function Li(e){try{e.swRegistration=await navigator.serviceWorker.register(Qd,{scope:Yd}),e.swRegistration.update().catch((()=>{}))}catch(e){throw df.create("failed-service-worker-registration",{browserErrorMessage:null==e?void 0:e.message})}}async function ji(e,t){if(!navigator)throw df.create("only-available-in-window");if("default"===Notification.permission&&await Notification.requestPermission(),"granted"!==Notification.permission)throw df.create("permission-blocked");return await async function(e,t){t?e.vapidKey=t:e.vapidKey||(e.vapidKey=Xd)}(e,null==t?void 0:t.vapidKey),await async function(e,t){if(t||e.swRegistration||await Li(e),t||!e.swRegistration){if(!(t instanceof ServiceWorkerRegistration))throw df.create("invalid-sw-registration");e.swRegistration=t}}(e,null==t?void 0:t.serviceWorkerRegistration),Ni(e)}async function Fi(e,t,n){const r=function(e){switch(e){case rf.NOTIFICATION_CLICKED:return"notification_open";case rf.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(t);(await e.firebaseDependencies.analyticsProvider.get()).logEvent(r,{message_id:n[Zd],message_name:n[ef],message_time:n[tf],message_device_time:Math.floor(Date.now()/1e3)})}async function Ui(e,t){const n=t.data;if(!n.isFirebaseMessaging)return;e.onMessageHandler&&n.messageType===rf.PUSH_RECEIVED&&("function"==typeof e.onMessageHandler?e.onMessageHandler(Di(n)):e.onMessageHandler.next(Di(n)));const r=n.data;var i;"object"==typeof(i=r)&&i&&Zd in i&&"1"===r["google.c.a.e"]&&await Fi(e,n.messageType,r)}function Vi(e){return async function(e){if(!navigator)throw df.create("only-available-in-window");return e.swRegistration||await Li(e),Pi(e)}(e=Object(na.z)(e))}function qi(e,t){return function(e,t){if(!navigator)throw df.create("only-available-in-window");return e.onMessageHandler=t,()=>{e.onMessageHandler=null}}(e=Object(na.z)(e),t)}function Bi(){return Bi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Bi.apply(this,arguments)}function zi(e){const t=new Uint8Array(e);return btoa(String.fromCharCode(...t)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Ki(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length);for(let e=0;e<n.length;++e)r[e]=n.charCodeAt(e);return r}function $i(){return Df||(Df=mi(Nf,Pf,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(Rf)}})),Df}async function Wi(e){const t=Hi(e),n=await $i(),r=await n.transaction(Rf).objectStore(Rf).get(t);if(r)return r;{const t=await async function(e){if("databases"in indexedDB){const e=(await indexedDB.databases()).map((e=>e.name));if(!e.includes(Sf))return null}let t=null;return(await mi(Sf,Of,{upgrade:async(n,r,i,s)=>{var o;if(r<2)return;if(!n.objectStoreNames.contains(Af))return;const a=s.objectStore(Af),c=await a.index("fcmSenderId").get(e);if(await a.clear(),c)if(2===r){const e=c;if(!e.auth||!e.p256dh||!e.endpoint)return;t={token:e.fcmToken,createTime:null!==(o=e.createTime)&&void 0!==o?o:Date.now(),subscriptionOptions:{auth:e.auth,p256dh:e.p256dh,endpoint:e.endpoint,swScope:e.swScope,vapidKey:"string"==typeof e.vapidKey?e.vapidKey:zi(e.vapidKey)}}}else if(3===r){const e=c;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:zi(e.auth),p256dh:zi(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:zi(e.vapidKey)}}}else if(4===r){const e=c;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:zi(e.auth),p256dh:zi(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:zi(e.vapidKey)}}}}})).close(),await _i(Sf),await _i("fcm_vapid_details_db"),await _i("undefined"),function(e){if(!e||!e.subscriptionOptions)return!1;const{subscriptionOptions:t}=e;return"number"==typeof e.createTime&&e.createTime>0&&"string"==typeof e.token&&e.token.length>0&&"string"==typeof t.auth&&t.auth.length>0&&"string"==typeof t.p256dh&&t.p256dh.length>0&&"string"==typeof t.endpoint&&t.endpoint.length>0&&"string"==typeof t.swScope&&t.swScope.length>0&&"string"==typeof t.vapidKey&&t.vapidKey.length>0}(t)?t:null}(e.appConfig.senderId);if(t)return await Gi(e,t),t}}async function Gi(e,t){const n=Hi(e),r=(await $i()).transaction(Rf,"readwrite");return await r.objectStore(Rf).put(t,n),await r.done,t}function Hi({appConfig:e}){return e.appId}async function Qi(e,t){const n={method:"DELETE",headers:await Xi(e)};try{const r=await fetch(`${Yi(e.appConfig)}/${t}`,n),i=await r.json();if(i.error){throw xf.create("token-unsubscribe-failed",{errorInfo:i.error.message})}}catch(e){throw xf.create("token-unsubscribe-failed",{errorInfo:null==e?void 0:e.toString()})}}function Yi({projectId:e}){return`${wf}/projects/${e}/registrations`}async function Xi({appConfig:e,installations:t}){const n=await t.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function Ji({p256dh:e,auth:t,endpoint:n,vapidKey:r}){const i={web:{endpoint:n,auth:t,p256dh:e}};return r!==vf&&(i.web.applicationPubKey=r),i}async function Zi(e){const t=await async function(e,t){const n=await e.pushManager.getSubscription();if(n)return n;return e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Ki(t)})}(e.swRegistration,e.vapidKey),n={vapidKey:e.vapidKey,swScope:e.swRegistration.scope,endpoint:t.endpoint,auth:zi(t.getKey("auth")),p256dh:zi(t.getKey("p256dh"))},r=await Wi(e.firebaseDependencies);if(r){if(function(e,t){const n=t.endpoint===e.endpoint,r=t.auth===e.auth,i=t.p256dh===e.p256dh;return t.vapidKey===e.vapidKey&&n&&r&&i}(r.subscriptionOptions,n))return Date.now()>=r.createTime+Mf?async function(e,t){try{const n=await async function(e,t){const n=await Xi(e),r=Ji(t.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)};let s;try{const n=await fetch(`${Yi(e.appConfig)}/${t.token}`,i);s=await n.json()}catch(e){throw xf.create("token-update-failed",{errorInfo:null==e?void 0:e.toString()})}if(s.error)throw xf.create("token-update-failed",{errorInfo:s.error.message});if(!s.token)throw xf.create("token-update-no-token");return s.token}(e.firebaseDependencies,t),r=Bi(Bi({},t),{token:n,createTime:Date.now()});return await Gi(e.firebaseDependencies,r),n}catch(t){throw await es(e),t}}(e,{token:r.token,createTime:Date.now(),subscriptionOptions:n}):r.token;try{await Qi(e.firebaseDependencies,r.token)}catch(e){console.warn(e)}return ts(e.firebaseDependencies,n)}return ts(e.firebaseDependencies,n)}async function es(e){const t=await Wi(e.firebaseDependencies);t&&(await Qi(e.firebaseDependencies,t.token),await async function(e){const t=Hi(e),n=(await $i()).transaction(Rf,"readwrite");await n.objectStore(Rf).delete(t),await n.done}(e.firebaseDependencies));const n=await e.swRegistration.pushManager.getSubscription();return!n||n.unsubscribe()}async function ts(e,t){const n=await async function(e,t){const n=await Xi(e),r=Ji(t),i={method:"POST",headers:n,body:JSON.stringify(r)};let s;try{const t=await fetch(Yi(e.appConfig),i);s=await t.json()}catch(e){throw xf.create("token-subscribe-failed",{errorInfo:null==e?void 0:e.toString()})}if(s.error)throw xf.create("token-subscribe-failed",{errorInfo:s.error.message});if(!s.token)throw xf.create("token-subscribe-no-token");return s.token}(e,t),r={token:n,createTime:Date.now(),subscriptionOptions:t};return await Gi(e,r),r.token}async function ns(e,t){const n=function(e,t){var n,r;const i={};e.from&&(i.project_number=e.from);e.fcmMessageId&&(i.message_id=e.fcmMessageId);i.instance_id=t,i.message_type=e.notification?kf.DISPLAY_NOTIFICATION.toString():kf.DATA_MESSAGE.toString();i.sdk_platform=Tf.toString(),i.package_name=self.origin.replace(/(^\w+:|^)\/\//,""),!e.collapse_key||(i.collapse_key=e.collapse_key);i.event=Ef.toString(),!(null===(n=e.fcmOptions)||void 0===n?void 0:n.analytics_label)||(i.analytics_label=null===(r=e.fcmOptions)||void 0===r?void 0:r.analytics_label);return i}(t,await e.firebaseDependencies.installations.getId());!function(e,t){const n={};n.event_time_ms=Math.floor(Date.now()).toString(),n.source_extension_json_proto3=JSON.stringify(t),e.logEvents.push(n)}(e,n)}function rs(e,t){const n=[];for(let r=0;r<e.length;r++)n.push(e.charAt(r)),r<t.length&&n.push(t.charAt(r));return n.join("")}async function is(e,t){const n=function({data:e}){if(!e)return null;try{return e.json()}catch(e){return null}}(e);if(!n)return;t.deliveryMetricsExportedToBigQueryEnabled&&await ns(t,n);const r=await os();if(function(e){return e.some((e=>"visible"===e.visibilityState&&!e.url.startsWith("chrome-extension://")))}(r))return function(e,t){t.isFirebaseMessaging=!0,t.messageType=Cf.PUSH_RECEIVED;for(const n of e)n.postMessage(t)}(r,n);if(n.notification&&await function(e){var t;const{actions:n}=e,{maxActions:r}=Notification;n&&r&&n.length>r&&console.warn(`This browser only supports ${r} actions. The remaining actions will not be displayed.`);return self.registration.showNotification(null!==(t=e.title)&&void 0!==t?t:"",e)}(function(e){const t=Bi({},e.notification);return t.data={[bf]:e},t}(n)),t&&t.onBackgroundMessageHandler){const e=function(e){const t={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return function(e,t){if(!t.notification)return;e.notification={};const n=t.notification.title;n&&(e.notification.title=n);const r=t.notification.body;r&&(e.notification.body=r);const i=t.notification.image;i&&(e.notification.image=i);const s=t.notification.icon;s&&(e.notification.icon=s)}(t,e),function(e,t){t.data&&(e.data=t.data)}(t,e),function(e,t){var n,r,i,s,o;if(!t.fcmOptions&&!(null===(n=t.notification)||void 0===n?void 0:n.click_action))return;e.fcmOptions={};const a=null!==(i=null===(r=t.fcmOptions)||void 0===r?void 0:r.link)&&void 0!==i?i:null===(s=t.notification)||void 0===s?void 0:s.click_action;a&&(e.fcmOptions.link=a);const c=null===(o=t.fcmOptions)||void 0===o?void 0:o.analytics_label;c&&(e.fcmOptions.analyticsLabel=c)}(t,e),t}(n);"function"==typeof t.onBackgroundMessageHandler?await t.onBackgroundMessageHandler(e):t.onBackgroundMessageHandler.next(e)}}async function ss(e){var t,n;const r=null===(n=null===(t=e.notification)||void 0===t?void 0:t.data)||void 0===n?void 0:n[bf];if(!r)return;if(e.action)return;e.stopImmediatePropagation(),e.notification.close();const i=function(e){var t,n,r;const i=null!==(n=null===(t=e.fcmOptions)||void 0===t?void 0:t.link)&&void 0!==n?n:null===(r=e.notification)||void 0===r?void 0:r.click_action;if(i)return i;return s=e.data,"object"==typeof s&&s&&If in s?self.location.origin:null;var s}(r);if(!i)return;const s=new URL(i,self.location.href),o=new URL(self.location.origin);if(s.host!==o.host)return;let a=await async function(e){const t=await os();for(const n of t){const t=new URL(n.url,self.location.href);if(e.host===t.host)return n}return null}(s);var c;return a?a=await a.focus():(a=await self.clients.openWindow(i),await(c=3e3,new Promise((e=>{setTimeout(e,c)})))),a?(r.messageType=Cf.NOTIFICATION_CLICKED,r.isFirebaseMessaging=!0,a.postMessage(r)):void 0}function os(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function as(e){return xf.create("missing-app-config-values",{valueName:e})}function cs(e,t){return function(e,t){if(void 0!==self.document)throw xf.create("only-available-in-sw");return e.onBackgroundMessageHandler=t,()=>{e.onBackgroundMessageHandler=null}}(e=Object(na.z)(e),t)}function us(){return us=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},us.apply(this,arguments)}function ls(e){return"storage/"+e}function hs(){return new Bf(zf.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function ds(){return new Bf(zf.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function fs(){return new Bf(zf.CANCELED,"User canceled the upload/download.")}function ps(){return new Bf(zf.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function gs(e){return new Bf(zf.INVALID_ARGUMENT,e)}function ms(){return new Bf(zf.APP_DELETED,"The Firebase app was deleted.")}function _s(e){return new Bf(zf.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function ys(e,t){return new Bf(zf.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function vs(e){throw new Bf(zf.INTERNAL_ERROR,"Internal error: "+e)}function ws(e){return"string"==typeof e||e instanceof String}function bs(e){return Is()&&e instanceof Blob}function Is(){return"undefined"!=typeof Blob&&!Object(na.I)()}function Ts(e,t,n,r){if(r<t)throw gs(`Invalid value for '${e}'. Expected ${t} or greater.`);if(r>n)throw gs(`Invalid value for '${e}'. Expected ${n} or less.`)}function Es(e,t,n){let r=t;return null==n&&(r=`https://${t}`),`${n}://${r}/v0${e}`}function ks(e){const t=encodeURIComponent;let n="?";for(const r in e)if(e.hasOwnProperty(r)){n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1),n}function Cs(e,t){const n=e>=500&&e<600,r=-1!==[408,429].indexOf(e),i=-1!==t.indexOf(e);return n||r||i}function Ss(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function Os(...e){const t=Ss();if(void 0!==t){const n=new t;for(let t=0;t<e.length;t++)n.append(e[t]);return n.getBlob()}if(Is())return new Blob(e);throw new Bf(zf.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}function As(e){if("undefined"==typeof atob)throw new Bf(zf.UNSUPPORTED_ENVIRONMENT,`${"base-64"} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`);return atob(e)}function Ns(e,t){switch(e){case Qf.RAW:return new Yf(Ps(t));case Qf.BASE64:case Qf.BASE64URL:return new Yf(Rs(e,t));case Qf.DATA_URL:return new Yf(function(e){const t=new Xf(e);return t.base64?Rs(Qf.BASE64,t.rest):function(e){let t;try{t=decodeURIComponent(e)}catch(e){throw ys(Qf.DATA_URL,"Malformed data URL.")}return Ps(t)}(t.rest)}(t),new Xf(t).contentType)}throw hs()}function Ps(e){const t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|63&r);else if(55296==(64512&r)){if(n<e.length-1&&56320==(64512&e.charCodeAt(n+1))){r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else t.push(239,191,189)}else 56320==(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function Rs(e,t){switch(e){case Qf.BASE64:{const n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r){throw ys(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?")}break}case Qf.BASE64URL:{const n=-1!==t.indexOf("+"),r=-1!==t.indexOf("/");if(n||r){throw ys(e,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?")}t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=As(t)}catch(t){if(t.message.includes("polyfill"))throw t;throw ys(e,"Invalid character found")}const r=new Uint8Array(n.length);for(let e=0;e<n.length;e++)r[e]=n.charCodeAt(e);return r}function Ds(e){let t;try{t=JSON.parse(e)}catch(e){return null}return"object"!=typeof(n=t)||Array.isArray(n)?null:t;var n}function xs(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function Ms(e,t){return t}function Ls(){if(ep)return ep;const e=[];e.push(new Zf("bucket")),e.push(new Zf("generation")),e.push(new Zf("metageneration")),e.push(new Zf("name","fullPath",!0));const t=new Zf("name");t.xform=function(e,t){return function(e){return!ws(e)||e.length<2?e:xs(e)}(t)},e.push(t);const n=new Zf("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new Zf("timeCreated")),e.push(new Zf("updated")),e.push(new Zf("md5Hash",null,!0)),e.push(new Zf("cacheControl",null,!0)),e.push(new Zf("contentDisposition",null,!0)),e.push(new Zf("contentEncoding",null,!0)),e.push(new Zf("contentLanguage",null,!0)),e.push(new Zf("contentType",null,!0)),e.push(new Zf("metadata","customMetadata",!0)),ep=e,ep}function js(e,t,n){const r={type:"file"},i=n.length;for(let e=0;e<i;e++){const i=n[e];r[i.local]=i.xform(r,t[i.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){const n=new $f(e.bucket,e.fullPath);return t._makeStorageReference(n)}})}(r,e),r}function Fs(e,t,n){const r=Ds(t);if(null===r)return null;return js(e,r,n)}function Us(e,t){const n={},r=t.length;for(let i=0;i<r;i++){const r=t[i];r.writable&&(n[r.server]=e[r.local])}return JSON.stringify(n)}function Vs(e,t,n){const r=Ds(n);if(null===r)return null;return function(e,t,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[tp])for(const i of n[tp]){const n=i.replace(/\/$/,""),s=e._makeStorageReference(new $f(t,n));r.prefixes.push(s)}if(n[np])for(const i of n[np]){const n=e._makeStorageReference(new $f(t,i.name));r.items.push(n)}return r}(e,t,r)}function qs(e){if(!e)throw hs()}function Bs(e,t){return function(n,r){const i=Fs(e,r,t);return qs(null!==i),i}}function zs(e,t){return function(n,r){const i=Fs(e,r,t);return qs(null!==i),function(e,t,n,r){const i=Ds(t);if(null===i)return null;if(!ws(i.downloadTokens))return null;const s=i.downloadTokens;if(0===s.length)return null;const o=encodeURIComponent;return s.split(",").map((t=>{const i=e.fullPath;return Es("/b/"+o(e.bucket)+"/o/"+o(i),n,r)+ks({alt:"media",token:t})}))[0]}(i,r,e.host,e._protocol)}}function Ks(e){return function(t,n){let r;return r=401===t.getStatus()?t.getErrorText().includes("Firebase App Check token is invalid")?new Bf(zf.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project."):new Bf(zf.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?new Bf(zf.QUOTA_EXCEEDED,"Quota for bucket '"+e.bucket+"' exceeded, please view quota on https://firebase.google.com/pricing/."):403===t.getStatus()?new Bf(zf.UNAUTHORIZED,"User does not have permission to access '"+e.path+"'."):n,r.status=t.getStatus(),r.serverResponse=n.serverResponse,r}}function $s(e){const t=Ks(e);return function(n,r){let i=t(n,r);return 404===n.getStatus()&&(i=new Bf(zf.OBJECT_NOT_FOUND,"Object '"+e.path+"' does not exist.")),i.serverResponse=r.serverResponse,i}}function Ws(e,t,n){const r=Es(t.fullServerUrl(),e.host,e._protocol),i=e.maxOperationRetryTime,s=new rp(r,"GET",Bs(e,n),i);return s.errorHandler=$s(t),s}function Gs(e,t,n,r,i){const s={};s.prefix=t.isRoot?"":t.path+"/",n&&n.length>0&&(s.delimiter=n),r&&(s.pageToken=r),i&&(s.maxResults=i);const o=Es(t.bucketOnlyServerUrl(),e.host,e._protocol),a=e.maxOperationRetryTime,c=new rp(o,"GET",function(e,t){return function(n,r){const i=Vs(e,t,r);return qs(null!==i),i}}(e,t.bucket),a);return c.urlParams=s,c.errorHandler=Ks(t),c}function Hs(e,t,n){const r=us({},n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=function(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}(null,t)),r}function Qs(e,t,n,r,i){const s=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"},a=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();o["Content-Type"]="multipart/related; boundary="+a;const c=Hs(t,r,i),u=Us(c,n),l=Jf.getBlob("--"+a+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+u+"\r\n--"+a+"\r\nContent-Type: "+c.contentType+"\r\n\r\n",r,"\r\n--"+a+"--");if(null===l)throw ps();const h={name:c.fullPath},d=Es(s,e.host,e._protocol),f=e.maxUploadRetryTime,p=new rp(d,"POST",Bs(e,n),f);return p.urlParams=h,p.headers=o,p.body=l.uploadData(),p.errorHandler=Ks(t),p}function Ys(e,t){let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Status")}catch(e){qs(!1)}return qs(!!n&&-1!==(t||["active"]).indexOf(n)),n}function Xs(e,t,n,r,i,s,o,a){const c=new ip(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=r.size()),r.size()!==c.total)throw new Bf(zf.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.");const u=c.total-c.current;let l=u;i>0&&(l=Math.min(l,i));const h=c.current;let d="";d=0===l?"finalize":u===l?"upload, finalize":"upload";const f={"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":`${c.current}`},p=r.slice(h,h+l);if(null===p)throw ps();const g=new rp(n,"POST",(function(e,n){const i=Ys(e,["active","final"]),o=c.current+l,a=r.size();let u;return u="final"===i?Bs(t,s)(e,n):null,new ip(o,a,"final"===i,u)}),t.maxUploadRetryTime);return g.headers=f,g.body=p.uploadData(),g.progressCallback=a||null,g.errorHandler=Ks(e),g}function Js(e){switch(e){case"running":case"pausing":case"canceling":return ap.RUNNING;case"paused":return ap.PAUSED;case"success":return ap.SUCCESS;case"canceled":return ap.CANCELED;default:return ap.ERROR}}function Zs(e){return(...t)=>{Promise.resolve().then((()=>e(...t)))}}function eo(){return up?up():new hp}function to(e){const t={prefixes:[],items:[]};return no(e,t).then((()=>t))}async function no(e,t,n){const r={pageToken:n},i=await ro(e,r);t.prefixes.push(...i.prefixes),t.items.push(...i.items),null!=i.nextPageToken&&await no(e,t,i.nextPageToken)}function ro(e,t){null!=t&&"number"==typeof t.maxResults&&Ts("options.maxResults",1,1e3,t.maxResults);const n=t||{},r=Gs(e.storage,e._location,"/",n.pageToken,n.maxResults);return e.storage.makeRequestWithTokens(r,eo)}function io(e,t){e._throwIfRoot("updateMetadata");const n=function(e,t,n,r){const i=Es(t.fullServerUrl(),e.host,e._protocol),s=Us(n,r),o=e.maxOperationRetryTime,a=new rp(i,"PATCH",Bs(e,r),o);return a.headers={"Content-Type":"application/json; charset=utf-8"},a.body=s,a.errorHandler=$s(t),a}(e.storage,e._location,t,Ls());return e.storage.makeRequestWithTokens(n,eo)}function so(e){e._throwIfRoot("getDownloadURL");const t=function(e,t,n){const r=Es(t.fullServerUrl(),e.host,e._protocol),i=e.maxOperationRetryTime,s=new rp(r,"GET",zs(e,n),i);return s.errorHandler=$s(t),s}(e.storage,e._location,Ls());return e.storage.makeRequestWithTokens(t,eo).then((e=>{if(null===e)throw new Bf(zf.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return e}))}function oo(e){e._throwIfRoot("deleteObject");const t=function(e,t){const n=Es(t.fullServerUrl(),e.host,e._protocol),r=new rp(n,"DELETE",(function(){}),e.maxOperationRetryTime);return r.successCodes=[200,204],r.errorHandler=$s(t),r}(e.storage,e._location);return e.storage.makeRequestWithTokens(t,eo)}function ao(e,t){const n=function(e,t){const n=t.split("/").filter((e=>e.length>0)).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),r=new $f(e._location.bucket,n);return new fp(e.storage,r)}function co(e,t){if(e instanceof pp){const n=e;if(null==n._bucket)throw new Bf(zf.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+qf+"' property when initializing the app?");const r=new fp(n,n._bucket);return null!=t?co(r,t):r}return void 0!==t?ao(e,t):e}function uo(e,t){if(t&&/^[A-Za-z]+:\/\//.test(t)){if(e instanceof pp)return new fp(e,t);throw gs("To use ref(service, url), the first argument must be a Storage instance.")}return co(e,t)}function lo(e,t){const n=null==t?void 0:t[qf];return null==n?null:$f.makeFromBucketSpec(n,e)}function ho(e,t,n){return function(e,t,n){return e._throwIfRoot("uploadBytesResumable"),new dp(e,new Jf(t),n)}(e=Object(na.z)(e),t,n)}function fo(e){return function(e){e._throwIfRoot("getMetadata");const t=Ws(e.storage,e._location,Ls());return e.storage.makeRequestWithTokens(t,eo)}(e=Object(na.z)(e))}function po(e,t){return uo(e=Object(na.z)(e),t)}function go(e,t,n,r={}){!function(e,t,n,r={}){e.host=`${t}:${n}`,e._protocol="http";const{mockUserToken:i}=r;i&&(e._overrideAuthToken="string"==typeof i?i:Object(na.n)(i,e.app.options.projectId))}(e,t,n,r)}function mo(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return new pp(n,r,i,t,ea.SDK_VERSION)}function _o(){return _o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_o.apply(this,arguments)}function yo(e){return/^[A-Za-z]+:\/\//.test(e)}function vo(e,{instanceIdentifier:t}){const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("storage").getImmediate({identifier:t});return new Ip(n,r)}function wo(){return wo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},wo.apply(this,arguments)}function bo(){return jp}function Io(e,t){const n=e.length-t.length;if(n<0||n>1)throw Dp.create("invalid String merger input");const r=[];for(let n=0;n<e.length;n++)r.push(e.charAt(n)),t.length>n&&r.push(t.charAt(n));return r.join("")}function To(){const e=Up.getInstance().navigator;return(null==e?void 0:e.serviceWorker)?e.serviceWorker.controller?2:3:1}function Eo(){switch(Up.getInstance().document.visibilityState){case"visible":return qp.VISIBLE;case"hidden":return qp.HIDDEN;default:return qp.UNKNOWN}}function ko(){const e=Up.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}function Co(e){var t;const n=null===(t=e.options)||void 0===t?void 0:t.appId;if(!n)throw Dp.create("no app id");return n}function So(e,t){const n=function(){const e=Up.getInstance().localStorage;if(!e)return;const t=e.getItem(Pp);if(!(t&&(n=t,Number(n)>Date.now())))return;var n;const r=e.getItem(Np);if(!r)return;try{return JSON.parse(r)}catch(e){return}}();return n?(Oo(n),Promise.resolve()):function(e,t){return function(e){const t=e.getToken();return t.then((()=>{})),t}(e.installations).then((n=>{const r=function(e){var t;const n=null===(t=e.options)||void 0===t?void 0:t.projectId;if(!n)throw Dp.create("no project id");return n}(e.app),i=function(e){var t;const n=null===(t=e.options)||void 0===t?void 0:t.apiKey;if(!n)throw Dp.create("no api key");return n}(e.app),s=new Request(`https://firebaseremoteconfig.googleapis.com/v1/projects/${r}/namespaces/fireperf:fetch?key=${i}`,{method:"POST",headers:{Authorization:`${Wp} ${n}`},body:JSON.stringify({app_instance_id:t,app_instance_id_token:n,app_id:Co(e.app),app_version:kp,sdk_version:Kp})});return fetch(s).then((e=>{if(e.ok)return e.json();throw Dp.create("RC response not ok")}))})).catch((()=>{xp.info(Gp)}))}(e,t).then(Oo).then((e=>function(e){const t=Up.getInstance().localStorage;if(!e||!t)return;t.setItem(Np,JSON.stringify(e)),t.setItem(Pp,String(Date.now()+60*Vp.getInstance().configTimeToLive*60*1e3))}(e)),(()=>{}))}function Oo(e){if(!e)return e;const t=Vp.getInstance(),n=e.entries||{};return t.loggingEnabled=void 0!==n.fpr_enabled?"true"===String(n.fpr_enabled):$p.loggingEnabled,n.fpr_log_source?t.logSource=Number(n.fpr_log_source):$p.logSource&&(t.logSource=$p.logSource),n.fpr_log_endpoint_url?t.logEndPointUrl=n.fpr_log_endpoint_url:$p.logEndPointUrl&&(t.logEndPointUrl=$p.logEndPointUrl),n.fpr_log_transport_key?t.transportKey=n.fpr_log_transport_key:$p.transportKey&&(t.transportKey=$p.transportKey),void 0!==n.fpr_vc_network_request_sampling_rate?t.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate):void 0!==$p.networkRequestsSamplingRate&&(t.networkRequestsSamplingRate=$p.networkRequestsSamplingRate),void 0!==n.fpr_vc_trace_sampling_rate?t.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate):void 0!==$p.tracesSamplingRate&&(t.tracesSamplingRate=$p.tracesSamplingRate),t.logTraceAfterSampling=Ao(t.tracesSamplingRate),t.logNetworkAfterSampling=Ao(t.networkRequestsSamplingRate),e}function Ao(e){return Math.random()<=e}function No(e){return Qp=2,Hp=Hp||function(e){return function(){const e=Up.getInstance().document;return new Promise((t=>{if(e&&"complete"!==e.readyState){const n=()=>{"complete"===e.readyState&&(e.removeEventListener("readystatechange",n),t())};e.addEventListener("readystatechange",n)}else t()}))}().then((()=>function(e){const t=e.getId();return t.then((e=>{jp=e})),t}(e.installations))).then((t=>So(e,t))).then((()=>Po()),(()=>Po()))}(e),Hp}function Po(){Qp=3}function Ro(e){setTimeout((()=>{if(0!==eg)return tg.length?void function(){const e=tg.splice(0,Jp),t=e.map((e=>({source_extension_json_proto3:e.message,event_time_ms:String(e.eventTime)})));(function(e,t){return function(e){const t=Vp.getInstance().getFlTransportFullUrl();return fetch(t,{method:"POST",body:JSON.stringify(e)})}(e).then((e=>(e.ok||xp.info("Call to Firebase backend failed."),e.json()))).then((e=>{const n=Number(e.nextRequestWaitMillis);let r=Yp;isNaN(n)||(r=Math.max(n,r));const i=e.logResponseDetails;Array.isArray(i)&&i.length>0&&"RETRY_REQUEST_LATER"===i[0].responseAction&&(tg=[...t,...tg],xp.info("Retry transport request later.")),eg=Xp,Ro(r)}))})({request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:Vp.getInstance().logSource,log_event:t},e).catch((()=>{tg=[...e,...tg],eg--,xp.info(`Tries left: ${eg}.`),Ro(Yp)}))}():Ro(Yp)}),e)}function Do(e){return(...t)=>{!function(e){if(!e.eventTime||!e.message)throw Dp.create("invalid cc log");tg=[...tg,e]}({message:e(...t),eventTime:Date.now()})}}function xo(e,t){Zp||(Zp=Do(jo)),Zp(e,t)}function Mo(e){const t=Vp.getInstance();!t.instrumentationEnabled&&e.isAuto||(t.dataCollectionEnabled||e.isAuto)&&Up.getInstance().requiredApisAvailable()&&(e.isAuto&&Eo()!==qp.VISIBLE||(3===Qp?Lo(e):No(e.performanceController).then((()=>Lo(e)),(()=>Lo(e)))))}function Lo(e){if(!bo())return;const t=Vp.getInstance();t.loggingEnabled&&t.logTraceAfterSampling&&setTimeout((()=>xo(e,1)),0)}function jo(e,t){return 0===t?function(e){const t={url:e.url,http_method:e.httpMethod||0,http_response_code:200,response_payload_bytes:e.responsePayloadBytes,client_start_time_us:e.startTimeUs,time_to_response_initiated_us:e.timeToResponseInitiatedUs,time_to_response_completed_us:e.timeToResponseCompletedUs},n={application_info:Fo(e.performanceController.app),network_request_metric:t};return JSON.stringify(n)}(e):function(e){const t={name:e.name,is_auto:e.isAuto,client_start_time_us:e.startTimeUs,duration_us:e.durationUs};0!==Object.keys(e.counters).length&&(t.counters=e.counters);const n=e.getAttributes();0!==Object.keys(n).length&&(t.custom_attributes=n);const r={application_info:Fo(e.performanceController.app),trace_metric:t};return JSON.stringify(r)}(e)}function Fo(e){return{google_app_id:Co(e),app_instance_id:bo(),web_app_info:{sdk_version:kp,page_url:Up.getInstance().getUrl(),service_worker_status:To(),visibility_state:Eo(),effective_connection_type:ko()},application_process_state:0}}function Uo(e,t){const n=t;if(!n||void 0===n.responseStart)return;const r=Up.getInstance().getTimeOrigin(),i=Math.floor(1e3*(n.startTime+r)),s=n.responseStart?Math.floor(1e3*(n.responseStart-n.startTime)):void 0,o=Math.floor(1e3*(n.responseEnd-n.startTime));!function(e){const t=Vp.getInstance();if(!t.instrumentationEnabled)return;const n=e.url,r=t.logEndPointUrl.split("?")[0],i=t.flTransportEndpointUrl.split("?")[0];n!==r&&n!==i&&t.loggingEnabled&&t.logNetworkAfterSampling&&setTimeout((()=>xo(e,0)),0)}({performanceController:e,url:n.name&&n.name.split("?")[0],responsePayloadBytes:n.transferSize,startTimeUs:i,timeToResponseInitiatedUs:s,timeToResponseCompletedUs:o})}function Vo(e){bo()&&(setTimeout((()=>function(e){const t=Up.getInstance(),n=t.getEntriesByType("navigation"),r=t.getEntriesByType("paint");if(t.onFirstInputDelay){let i=setTimeout((()=>{ig.createOobTrace(e,n,r),i=void 0}),sg);t.onFirstInputDelay((t=>{i&&(clearTimeout(i),ig.createOobTrace(e,n,r,t))}))}else ig.createOobTrace(e,n,r)}(e)),0),setTimeout((()=>function(e){const t=Up.getInstance(),n=t.getEntriesByType("resource");for(const t of n)Uo(e,t);t.setupObserver("resource",(t=>Uo(e,t)))}(e)),0),setTimeout((()=>function(e){const t=Up.getInstance(),n=t.getEntriesByType("measure");for(const t of n)qo(e,t);t.setupObserver("measure",(t=>qo(e,t)))}(e)),0))}function qo(e,t){const n=t.name;n.substring(0,Cp.length)!==Cp&&ig.createUserTimingTrace(e,n)}function Bo(e){const t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("performance").getImmediate();return new cg(t,n)}function zo(){return zo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},zo.apply(this,arguments)}async function Ko(e){const t=Object(na.z)(e),[n,r]=await Promise.all([t._storage.getLastSuccessfulFetchResponse(),t._storage.getActiveConfigEtag()]);return!!(n&&n.config&&n.eTag&&n.eTag!==r)&&(await Promise.all([t._storageCache.setActiveConfig(n.config),t._storage.setActiveConfigEtag(n.eTag)]),!0)}function $o(e){const t=Object(na.z)(e);return t._initializePromise||(t._initializePromise=t._storageCache.loadFromStorage().then((()=>{t._isInitializationComplete=!0}))),t._initializePromise}async function Wo(e){const t=Object(na.z)(e),n=new dg;setTimeout((async()=>{n.abort()}),t.settings.fetchTimeoutMillis);try{await t._client.fetch({cacheMaxAgeMillis:t.settings.minimumFetchIntervalMillis,signal:n}),await t._storageCache.setLastFetchStatus("success")}catch(e){const n=function(e,t){return e instanceof na.c&&-1!==e.code.indexOf(t)}(e,"fetch-throttle")?"throttle":"failure";throw await t._storageCache.setLastFetchStatus(n),e}}function Go(e){const t=Object(na.z)(e);return function(e={},t={}){return Object.keys(zo(zo({},e),t))}(t._storageCache.getActiveConfig(),t.defaultConfig).reduce(((t,n)=>(t[n]=Ho(e,n),t)),{})}function Ho(e,t){const n=Object(na.z)(e);n._isInitializationComplete||n._logger.debug(`A value was requested for key "${t}" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.`);const r=n._storageCache.getActiveConfig();return r&&void 0!==r[t]?new mg("remote",r[t]):n.defaultConfig&&void 0!==n.defaultConfig[t]?new mg("default",String(n.defaultConfig[t])):(n._logger.debug(`Returning static value for key "${t}". Define a default or remote value if this is unintentional.`),new mg("static"))}function Qo(e=navigator){return e.languages&&e.languages[0]||e.language}function Yo(e,t){const n=e.target.error||void 0;return pg.create(t,{originalErrorMessage:n&&(null==n?void 0:n.message)})}async function Xo(){if(!Object(na.G)())return!1;try{return await Object(na.ab)()}catch(e){return!1}}function Jo(e,{instanceIdentifier:t}){const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("remote-config").getImmediate({identifier:t});return new Eg(n,r)}n.d(t,"a",(function(){return Zo.a}));var Zo=n("YfkF"),ea=n("xsHj"),ta=n("li6C"),na=n("8HXZ"),ra=n("SgqZ");const ia=(e,t)=>t.some((t=>e instanceof t));let sa,oa;const aa=new WeakMap,ca=new WeakMap,ua=new WeakMap,la=new WeakMap,ha=new WeakMap;let da={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return ca.get(e);if("objectStoreNames"===t)return e.objectStoreNames||ua.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return s(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};const fa=e=>ha.get(e),pa=["get","getKey","getAll","getAllKeys","count"],ga=["put","add","delete","clear"],ma=new Map;da=(e=>a(a({},e),{},{get:(t,n,r)=>u(t,n)||e.get(t,n,r),has:(t,n)=>!!u(t,n)||e.has(t,n)}))(da);const _a="@firebase/installations",ya="0.6.4",va=1e4,wa=`w:${ya}`,ba="FIS_v2",Ia="https://firebaseinstallations.googleapis.com/v1",Ta=36e5,Ea=new na.b("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."}),ka=/^[cdef][\w-]{21}$/,Ca="",Sa=new Map;let Oa=null;const Aa="firebase-installations-database",Na=1,Pa="firebase-installations-store";let Ra=null;const Da="installations",xa=e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw F("App Configuration");if(!e.name)throw F("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw F(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:Object(ea._getProvider)(t,"heartbeat"),_delete:()=>Promise.resolve()}},Ma=e=>{const t=e.getProvider("app").getImmediate(),n=Object(ea._getProvider)(t,Da).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:r}=await A(t);return r?r.catch(console.error):x(t).catch(console.error),n.fid}(n),getToken:e=>j(n,e)}};Object(ea._registerComponent)(new ra.a(Da,xa,"PUBLIC")),Object(ea._registerComponent)(new ra.a("installations-internal",Ma,"PRIVATE")),Object(ea.registerVersion)(_a,ya),Object(ea.registerVersion)(_a,ya,"esm2017");const La="analytics",ja="firebase_id",Fa="origin",Ua=6e4,Va="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",qa="https://www.googletagmanager.com/gtag/js",Ba=new ta.b("@firebase/analytics"),za=new na.b("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."}),Ka=30;const $a=new class{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};class Wa{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}let Ga,Ha;class Qa{constructor(e){this.app=e}_delete(){return delete Ya[this.app.options.appId],Promise.resolve()}}let Ya={},Xa=[];const Ja={};let Za,ec,tc="dataLayer",nc="gtag",rc=!1;const ic="@firebase/analytics",sc="0.10.0";Object(ea._registerComponent)(new ra.a(La,((e,{options:t})=>X(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t)),"PUBLIC")),Object(ea._registerComponent)(new ra.a("analytics-internal",(function(e){try{const t=e.getProvider(La).getImmediate();return{logEvent:(e,n,r)=>re(t,e,n,r)}}catch(e){throw za.create("interop-component-reg-failed",{reason:e})}}),"PRIVATE")),Object(ea.registerVersion)(ic,sc),Object(ea.registerVersion)(ic,sc,"esm2017");class oc{constructor(e,t){this.app=e,this._delegate=t}logEvent(e,t,n){re(this._delegate,e,t,n)}setCurrentScreen(e,t){Z(this._delegate,e,t)}setUserId(e,t){ee(this._delegate,e,t)}setUserProperties(e,t){te(this._delegate,e,t)}setAnalyticsCollectionEnabled(e){ne(this._delegate,e)}}var ac;!function(e){e.ADD_SHIPPING_INFO="add_shipping_info",e.ADD_PAYMENT_INFO="add_payment_info",e.ADD_TO_CART="add_to_cart",e.ADD_TO_WISHLIST="add_to_wishlist",e.BEGIN_CHECKOUT="begin_checkout",e.CHECKOUT_PROGRESS="checkout_progress",e.EXCEPTION="exception",e.GENERATE_LEAD="generate_lead",e.LOGIN="login",e.PAGE_VIEW="page_view",e.PURCHASE="purchase",e.REFUND="refund",e.REMOVE_FROM_CART="remove_from_cart",e.SCREEN_VIEW="screen_view",e.SEARCH="search",e.SELECT_CONTENT="select_content",e.SELECT_ITEM="select_item",e.SELECT_PROMOTION="select_promotion",e.SET_CHECKOUT_OPTION="set_checkout_option",e.SHARE="share",e.SIGN_UP="sign_up",e.TIMING_COMPLETE="timing_complete",e.VIEW_CART="view_cart",e.VIEW_ITEM="view_item",e.VIEW_ITEM_LIST="view_item_list",e.VIEW_PROMOTION="view_promotion",e.VIEW_SEARCH_RESULTS="view_search_results"}(ac||(ac={}));const cc=e=>{const t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("analytics").getImmediate();return new oc(t,n)};!function(){const e={Analytics:oc,settings:Y,isSupported:J,EventName:ac};Zo.a.INTERNAL.registerComponent(new ra.a("analytics-compat",cc,"PUBLIC").setServiceProps(e).setMultipleInstances(!0))}(),Zo.a.registerVersion("@firebase/analytics-compat","0.2.6");const uc=new Map,lc={activated:!1,tokenObservers:[]},hc={initialized:!1,enabled:!1},dc="https://content-firebaseappcheck.googleapis.com/v1",fc="exchangeDebugToken",pc={OFFSET_DURATION:3e5,RETRIAL_MIN_WAIT:3e4,RETRIAL_MAX_WAIT:96e4};class gc{constructor(e,t,n,r,i){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=n,this.lowerBound=r,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=r,r>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch((()=>{}))}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}async process(e){this.stop();try{this.pending=new na.a,await(t=this.getNextRun(e),new Promise((e=>{setTimeout(e,t)}))),this.pending.resolve(),await this.pending.promise,this.pending=new na.a,await this.operation(),this.pending.resolve(),await this.pending.promise,this.process(!0).catch((()=>{}))}catch(e){this.retryPolicy(e)?this.process(!1).catch((()=>{})):this.stop()}var t}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const e=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),e}}}const mc=new na.b("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"}),_c="firebase-app-check-database",yc=1,vc="firebase-app-check-store",wc="debug-token";let bc=null;const Ic=new ta.b("@firebase/app-check"),Tc={error:"UNKNOWN_ERROR"};class Ec{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=se(this.app);for(const t of e)ke(this.app,t.next);return Promise.resolve()}}const kc="https://www.google.com/recaptcha/api.js",Cc="https://www.google.com/recaptcha/enterprise.js";class Sc{constructor(e){this._siteKey=e,this._throttleData=null}async getToken(){var e,t,n;Le(this._throttleData);const r=await xe(this._app).catch((()=>{throw mc.create("recaptcha-error")}));if(!(null===(e=se(this._app).reCAPTCHAState)||void 0===e?void 0:e.succeeded))throw mc.create("recaptcha-error");let i;try{i=await he(function(e,t){const{projectId:n,appId:r,apiKey:i}=e.options;return{url:`${dc}/projects/${n}/apps/${r}:exchangeRecaptchaV3Token?key=${i}`,body:{recaptcha_v3_token:t}}}(this._app,r),this._heartbeatServiceProvider)}catch(e){throw(null===(t=e.code)||void 0===t?void 0:t.includes("fetch-status-error"))?(this._throttleData=Me(Number(null===(n=e.customData)||void 0===n?void 0:n.httpStatus),this._throttleData),mc.create("throttled",{time:ue(this._throttleData.allowRequestsAfter-Date.now()),httpStatus:this._throttleData.httpStatus})):e}return this._throttleData=null,i}initialize(e){this._app=e,this._heartbeatServiceProvider=Object(ea._getProvider)(e,"heartbeat"),Ne(e,this._siteKey).catch((()=>{}))}isEqual(e){return e instanceof Sc&&this._siteKey===e._siteKey}}class Oc{constructor(e){this._siteKey=e,this._throttleData=null}async getToken(){var e,t,n;Le(this._throttleData);const r=await xe(this._app).catch((()=>{throw mc.create("recaptcha-error")}));if(!(null===(e=se(this._app).reCAPTCHAState)||void 0===e?void 0:e.succeeded))throw mc.create("recaptcha-error");let i;try{i=await he(function(e,t){const{projectId:n,appId:r,apiKey:i}=e.options;return{url:`${dc}/projects/${n}/apps/${r}:exchangeRecaptchaEnterpriseToken?key=${i}`,body:{recaptcha_enterprise_token:t}}}(this._app,r),this._heartbeatServiceProvider)}catch(e){throw(null===(t=e.code)||void 0===t?void 0:t.includes("fetch-status-error"))?(this._throttleData=Me(Number(null===(n=e.customData)||void 0===n?void 0:n.httpStatus),this._throttleData),mc.create("throttled",{time:ue(this._throttleData.allowRequestsAfter-Date.now()),httpStatus:this._throttleData.httpStatus})):e}return this._throttleData=null,i}initialize(e){this._app=e,this._heartbeatServiceProvider=Object(ea._getProvider)(e,"heartbeat"),Pe(e,this._siteKey).catch((()=>{}))}isEqual(e){return e instanceof Oc&&this._siteKey===e._siteKey}}class Ac{constructor(e){this._customProviderOptions=e}async getToken(){const e=await this._customProviderOptions.getToken(),t=Object(na.N)(e.token),n=null!==t&&t<Date.now()&&t>0?1e3*t:Date.now();return ie(ie({},e),{issuedAtTimeMillis:n})}initialize(e){this._app=e}isEqual(e){return e instanceof Ac&&this._customProviderOptions.getToken.toString()===e._customProviderOptions.getToken.toString()}}const Nc="app-check-internal";Object(ea._registerComponent)(new ra.a("app-check",(e=>function(e,t){return new Ec(e,t)}(e.getProvider("app").getImmediate(),e.getProvider("heartbeat"))),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e=>{e.getProvider(Nc).initialize()}))),Object(ea._registerComponent)(new ra.a(Nc,(e=>function(e){return{getToken:t=>Ie(e,t),getLimitedUseToken:()=>Te(e),addTokenListener:t=>Ee(e,"INTERNAL",t),removeTokenListener:t=>ke(e.app,t)}}(e.getProvider("app-check").getImmediate())),"PUBLIC").setInstantiationMode("EXPLICIT")),Object(ea.registerVersion)("@firebase/app-check","0.8.0");const Pc=new na.b("appCheck","AppCheck",{"use-before-activation":"App Check is being used before activate() is called for FirebaseApp {$appName}. Call activate() before instantiating other Firebase services."});class Rc{constructor(e){this.app=e}activate(e,t){let n;n="string"==typeof e?new Sc(e):e instanceof Oc||e instanceof Sc||e instanceof Ac?e:new Ac({getToken:e.getToken}),this._delegate=je(this.app,{provider:n,isTokenAutoRefreshEnabled:t})}setTokenAutoRefreshEnabled(e){if(!this._delegate)throw Pc.create("use-before-activation",{appName:this.app.name});!function(e,t){const n=se(e.app);n.tokenRefresher&&(!0===t?n.tokenRefresher.start():n.tokenRefresher.stop()),n.isTokenAutoRefreshEnabled=t}(this._delegate,e)}getToken(e){if(!this._delegate)throw Pc.create("use-before-activation",{appName:this.app.name});return async function(e,t){const n=await Ie(e,t);if(n.error)throw n.error;return{token:n.token}}(this._delegate,e)}onTokenChanged(e,t,n){if(!this._delegate)throw Pc.create("use-before-activation",{appName:this.app.name});return function(e,t,n){let r=()=>{},i=()=>{};return r=null!=t.next?t.next.bind(t):t,null!=t.error?i=t.error.bind(t):n&&(i=n),Ee(e,"EXTERNAL",r,i),()=>ke(e.app,r)}(this._delegate,e,t)}}Zo.a.INTERNAL.registerComponent(new ra.a("appCheck-compat",(e=>{const t=e.getProvider("app-compat").getImmediate();return new Rc(t)}),"PUBLIC").setServiceProps({ReCaptchaEnterpriseProvider:Oc,ReCaptchaV3Provider:Sc,CustomProvider:Ac})),Zo.a.registerVersion("@firebase/app-check-compat","0.3.7");n("meV/");const Dc="@firebase/database",xc="1.0.1";let Mc="";class Lc{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Object(na.V)(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:Object(na.O)(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class jc{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return Object(na.m)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const Fc=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new Lc(t)}}catch(e){}return new jc},Uc=Fc("localStorage"),Vc=Fc("sessionStorage"),qc=new ta.b("@firebase/database"),Bc=function(){let e=1;return function(){return e++}}(),zc=function(e){const t=Object(na.U)(e),n=new na.d;n.update(t);const r=n.digest();return na.h.encodeByteArray(r)},Kc=function e(...t){let n="";for(let r=0;r<t.length;r++){const i=t[r];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?n+=e.apply(null,i):n+="object"==typeof i?Object(na.V)(i):i,n+=" "}return n};let $c=null,Wc=!0;const Gc=function(e,t){Object(na.f)(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(qc.logLevel=ta.a.VERBOSE,$c=qc.log.bind(qc),t&&Vc.set("logging_enabled",!0)):"function"==typeof e?$c=e:($c=null,Vc.remove("logging_enabled"))},Hc=function(...e){if(!0===Wc&&(Wc=!1,null===$c&&!0===Vc.get("logging_enabled")&&Gc(!0)),$c){const t=Kc.apply(null,e);$c(t)}},Qc=function(e){return function(...t){Hc(e,...t)}},Yc=function(...e){const t="FIREBASE INTERNAL ERROR: "+Kc(...e);qc.error(t)},Xc=function(...e){const t=`FIREBASE FATAL ERROR: ${Kc(...e)}`;throw qc.error(t),new Error(t)},Jc=function(...e){const t="FIREBASE WARNING: "+Kc(...e);qc.warn(t)},Zc=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},eu="[MIN_NAME]",tu="[MAX_NAME]",nu=function(e,t){if(e===t)return 0;if(e===eu||t===tu)return-1;if(t===eu||e===tu)return 1;{const n=uu(e),r=uu(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1}},ru=function(e,t){return e===t?0:e<t?-1:1},iu=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+Object(na.V)(t))},su=function e(t){if("object"!=typeof t||null===t)return Object(na.V)(t);const n=[];for(const e in t)n.push(e);n.sort();let r="{";for(let i=0;i<n.length;i++)0!==i&&(r+=","),r+=Object(na.V)(n[i]),r+=":",r+=e(t[n[i]]);return r+="}",r},ou=function(e,t){const n=e.length;if(n<=t)return[e];const r=[];for(let i=0;i<n;i+=t)r.push(e.substring(i,i+t>n?n:i+t));return r},au=function(e){Object(na.f)(!Zc(e),"Invalid JSON number");const t=1023;let n,r,i,s,o;0===e?(r=0,i=0,n=1/e==-1/0?1:0):(n=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(s=Math.min(Math.floor(Math.log(e)/Math.LN2),t),r=s+t,i=Math.round(e*Math.pow(2,52-s)-Math.pow(2,52))):(r=0,i=Math.round(e/Math.pow(2,-1074))));const a=[];for(o=52;o;o-=1)a.push(i%2?1:0),i=Math.floor(i/2);for(o=11;o;o-=1)a.push(r%2?1:0),r=Math.floor(r/2);a.push(n?1:0),a.reverse();const c=a.join("");let u="";for(o=0;o<64;o+=8){let e=parseInt(c.substr(o,8),2).toString(16);1===e.length&&(e="0"+e),u+=e}return u.toLowerCase()},cu=new RegExp("^-?(0*)\\d{1,10}$"),uu=function(e){if(cu.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},lu=function(e){try{e()}catch(e){setTimeout((()=>{throw Jc("Exception was thrown by user callback.",e.stack||""),e}),Math.floor(0))}},hu=function(e,t){const n=setTimeout(e,t);return"number"==typeof n&&"undefined"!=typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"==typeof n&&n.unref&&n.unref(),n};class du{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then((e=>this.appCheck=e))}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise(((t,n)=>{setTimeout((()=>{this.appCheck?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((t=>t.addTokenListener(e)))}notifyForInvalidToken(){Jc(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class fu{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((e=>this.auth_=e))}getToken(e){return this.auth_?this.auth_.getToken(e).catch((e=>e&&"auth/token-not-initialized"===e.code?(Hc("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e))):new Promise(((t,n)=>{setTimeout((()=>{this.auth_?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((t=>t.addAuthTokenListener(e)))}removeTokenChangeListener(e){this.authProvider_.get().then((t=>t.removeAuthTokenListener(e)))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Jc(e)}}class pu{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}pu.OWNER="owner";const gu="5",mu=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,_u="ac",yu="websocket",vu="long_polling";class wu{constructor(e,t,n,r,i=!1,s="",o=!1,a=!1){this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=s,this.includeNamespaceInQueryParams=o,this.isUsingEmulator=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Uc.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Uc.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}class bu{constructor(){this.counters_={}}incrementCounter(e,t=1){Object(na.m)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return Object(na.p)(this.counters_)}}const Iu={},Tu={};class Eu{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&lu((()=>{this.onMessage_(e[t])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const ku="start";class Cu{constructor(e,t,n,r,i,s,o){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=s,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Qc(e),this.stats_=Be(t),this.urlFn=e=>(this.appCheckToken&&(e[_u]=this.appCheckToken),qe(t,vu,e))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Eu(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if(Object(na.J)()||"complete"===document.readyState)e();else{let t=!1;const n=function n(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new Su(((...e)=>{const[t,n,r,i,s]=e;if(this.incrementIncomingBytes_(e),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,t===ku)this.id=n,this.password=r;else{if("close"!==t)throw new Error("Unrecognized command received: "+t);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,(()=>{this.onClosed_()}))):this.onClosed_()}}),((...e)=>{const[t,n]=e;this.incrementIncomingBytes_(e),this.myPacketOrderer.handleResponse(t,n)}),(()=>{this.onClosed_()}),this.urlFn);const e={};e[ku]="t",e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v=gu,this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e[_u]=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&mu.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Cu.forceAllow_=!0}static forceDisallow(){Cu.forceDisallow_=!0}static isAvailable(){return!Object(na.J)()&&(!!Cu.forceAllow_||!(Cu.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=Object(na.V)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=Object(na.j)(t),r=ou(n,1840);for(let e=0;e<r.length;e++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[e]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(Object(na.J)())return;this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=Object(na.V)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class Su{constructor(e,t,n,r){if(this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,Object(na.J)())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=Bc(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=Su.createIFrame_();let n="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)){n='<script>document.domain="'+document.domain+'";<\/script>'}const r="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(e){Hc("frame writing exception"),e.stack&&Hc(e.stack),Hc(e)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Hc("No IE domain setting required")}catch(t){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",r=0;for(;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;{const e=this.pendingSegs.shift();n=n+"&seg"+r+"="+e.seg+"&ts"+r+"="+e.ts+"&d"+r+"="+e.d,r++}}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(n,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(r),n()}))}addTag(e,t){Object(na.J)()?this.doNodeLongPoll(e,t):setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{Hc("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(e){}}),Math.floor(1))}}let Ou=null;"undefined"!=typeof MozWebSocket?Ou=MozWebSocket:"undefined"!=typeof WebSocket&&(Ou=WebSocket);class Au{constructor(e,t,n,r,i,s,o){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Qc(this.connId),this.stats_=Be(t),this.connURL=Au.connectionURL_(t,s,o,r,n),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,r,i){const s={};return s.v=gu,!Object(na.J)()&&"undefined"!=typeof location&&location.hostname&&mu.test(location.hostname)&&(s.r="f"),t&&(s.s=t),n&&(s.ls=n),r&&(s[_u]=r),i&&(s.p=i),qe(e,yu,s)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Uc.set("previous_websocket_failure",!0);try{let e;if(Object(na.J)()){e={headers:{"User-Agent":`Firebase/${gu}/${Mc}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(e.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(e.headers["X-Firebase-AppCheck"]=this.appCheckToken);const t=process.env,n=0===this.connURL.indexOf("wss://")?t.HTTPS_PROXY||t.https_proxy:t.HTTP_PROXY||t.http_proxy;n&&(e.proxy={origin:n})}this.mySock=new Ou(this.connURL,[],e)}catch(e){this.log_("Error instantiating WebSocket.");const t=e.message||e.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){Au.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const t=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);t&&t.length>1&&parseFloat(t[1])<4.4&&(e=!0)}return!e&&null!==Ou&&!Au.forceDisallow_}static previouslyFailed(){return Uc.isInMemoryStorage||!0===Uc.get("previous_websocket_failure")}markConnectionHealthy(){Uc.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=Object(na.O)(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(Object(na.f)(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=Object(na.V)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=ou(t,16384);n.length>1&&this.sendString_(String(n.length));for(let e=0;e<n.length;e++)this.sendString_(n[e])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Au.responsesRequiredToBeHealthy=2,Au.healthyTimeout=3e4;class Nu{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Cu,Au]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=Au&&Au.isAvailable();let n=t&&!Au.previouslyFailed();if(e.webSocketOnly&&(t||Jc("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[Au];else{const e=this.transports_=[];for(const t of Nu.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t);Nu.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Nu.globalTransportInitialized_=!1;class Pu{constructor(e,t,n,r,i,s,o,a,c,u){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=s,this.onReady_=o,this.onDisconnect_=a,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Qc("c:"+this.id+":"),this.transportManager_=new Nu(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,n)}),Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=hu((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=iu("t",e),n=iu("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=iu("t",e),n=iu("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=iu("t",e);if("d"in e){const n=e.d;if("h"===t){const e=Fe({},n);this.repoInfo_.isUsingEmulator&&(e.h=this.repoInfo_.host),this.onHandshake_(e)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?Yc("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Yc("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),gu!==n&&Jc("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),hu((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):hu((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Uc.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class Ru{put(e,t,n,r){}merge(e,t,n,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}class Du{constructor(e){this.allowedEvents_=e,this.listeners_={},Object(na.f)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let e=0;e<n.length;e++)n[e].callback.apply(n[e].context,t)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const r=this.getInitialEvent(e);r&&t.apply(n,r)}off(e,t,n){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let e=0;e<r.length;e++)if(r[e].callback===t&&(!n||n===r[e].context))return void r.splice(e,1)}validateEventType_(e){Object(na.f)(this.allowedEvents_.find((t=>t===e)),"Unknown event: "+e)}}class xu extends Du{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||Object(na.H)()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new xu}getInitialEvent(e){return Object(na.f)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}const Mu=32,Lu=768;class ju{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}class Fu{constructor(e,t){this.errorPrefix_=t,this.parts_=He(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let e=0;e<this.parts_.length;e++)this.byteLength_+=Object(na.T)(this.parts_[e]);nt(this)}}class Uu extends Du{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}static getInstance(){return new Uu}getInitialEvent(e){return Object(na.f)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const Vu=1e3;class qu extends Ru{constructor(e,t,n,r,i,s,o,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=s,this.appCheckTokenProvider_=o,this.authOverride_=a,this.id=qu.nextPersistentConnectionId_++,this.log_=Qc("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Vu,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a&&!Object(na.J)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Uu.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&xu.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(Object(na.V)(i)),Object(na.f)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}get(e){this.initConnection_();const t=new na.a,n={p:e._path.toString(),q:e._queryObject};this.outstandingGets_.push({action:"g",request:n,onComplete:e=>{const n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}}),this.outstandingGetCount_++;return this.connected_&&this.sendGet_(this.outstandingGets_.length-1),t.promise}listen(e,t,n,r){this.initConnection_();const i=e._queryIdentifier,s=e._path.toString();this.log_("Listen called for "+s+" "+i),this.listens.has(s)||this.listens.set(s,new Map),Object(na.f)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Object(na.f)(!this.listens.get(s).has(i),"listen() called twice for same path/queryId.");const o={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(s).set(i,o),this.connected_&&this.sendListen_(o)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)}))}sendListen_(e){const t=e.query,n=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+n+" for "+r);const i={p:n};e.tag&&(i.q=t._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest("q",i,(i=>{const s=i.d,o=i.s;qu.warnOnListenWarnings_(s,t);(this.listens.get(n)&&this.listens.get(n).get(r))===e&&(this.log_("listen response",i),"ok"!==o&&this.removeListen_(n,r),e.onComplete&&e.onComplete(o,s))}))}static warnOnListenWarnings_(e,t){if(e&&"object"==typeof e&&Object(na.m)(e,"w")){const n=Object(na.S)(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();Jc(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${e} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||Object(na.B)(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=Object(na.M)(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,(t=>{const n=t.s,r=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,r))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)}))}unlisten(e,t){const n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),Object(na.f)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query");this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}sendUnlisten_(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);const i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,r){const i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(e=>{r&&setTimeout((()=>{r(e.s,e.d)}),Math.floor(0))}))}put(e,t,n,r){this.putInternal("p",e,t,n,r)}merge(e,t,n,r){this.putInternal("m",e,t,n,r)}putInternal(e,t,n,r,i){this.initConnection_();const s={p:t,d:n};void 0!==i&&(s.h=i),this.outstandingPuts_.push({action:e,request:s,onComplete:r}),this.outstandingPutCount_++;this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,(n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(n.s,n.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){this.log_("reportStats","Error sending stats: "+e.d)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+Object(na.V)(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):Yc("Unrecognized action received from server: "+Object(na.V)(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){Object(na.f)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Vu,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Vu,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Vu),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+qu.nextConnectionId_++,i=this.lastSessionId;let s=!1,o=null;const a=function(){o?o.close():(s=!0,n())};this.realtime_={close:a,sendRequest:function(e){Object(na.f)(o,"sendRequest call when we're not connected not allowed."),o.sendRequest(e)}};const c=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[a,u]=await Promise.all([this.authTokenProvider_.getToken(c),this.appCheckTokenProvider_.getToken(c)]);s?Hc("getToken() completed but was canceled"):(Hc("getToken() completed. Creating connection."),this.authToken_=a&&a.accessToken,this.appCheckToken_=u&&u.token,o=new Pu(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,(e=>{Jc(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),i))}catch(e){this.log_("Failed to get token: "+e),s||(this.repoInfo_.nodeAdmin&&Jc(e),a())}}}interrupt(e){Hc("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Hc("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Object(na.E)(this.interruptReasons_)&&(this.reconnectDelay_=Vu,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map((e=>su(e))).join("$"):"default";const r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const n=new ju(e).toString();let r;if(this.listens.has(n)){const e=this.listens.get(n);r=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(e,t){Hc("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){Hc("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";Object(na.J)()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+Mc.replace(/\./g,"-")]=1,Object(na.H)()?e["framework.cordova"]=1:Object(na.K)()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=xu.getInstance().currentlyOnline();return Object(na.E)(this.interruptReasons_)&&e}}qu.nextPersistentConnectionId_=0,qu.nextConnectionId_=0;class Bu{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Bu(e,t)}}class zu{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new Bu(eu,e),r=new Bu(eu,t);return 0!==this.compare(n,r)}minPost(){return Bu.MIN}}let Ku;class $u extends zu{static get __EMPTY_NODE(){return Ku}static set __EMPTY_NODE(e){Ku=e}compare(e,t){return nu(e.name,t.name)}isDefinedOn(e){throw Object(na.g)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Bu.MIN}maxPost(){return new Bu(tu,Ku)}makePost(e,t){return Object(na.f)("string"==typeof e,"KeyIndex indexValue must always be a string."),new Bu(e,Ku)}toString(){return".key"}}const Wu=new $u;class Gu{constructor(e,t,n,r,i=null){this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,r&&(s*=-1),s<0)e=this.isReverse_?e.left:e.right;else{if(0===s){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Hu{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Hu.RED,this.left=null!=r?r:Qu.EMPTY_NODE,this.right=null!=i?i:Qu.EMPTY_NODE}copy(e,t,n,r,i){return new Hu(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return Qu.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,r;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return Qu.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Hu.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Hu.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Hu.RED=!0,Hu.BLACK=!1;class Qu{constructor(e,t=Qu.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new Qu(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Hu.BLACK,null,null))}remove(e){return new Qu(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Hu.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,r=null;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Gu(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new Gu(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new Gu(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new Gu(this.root_,null,this.comparator_,!0,e)}}let Yu;Qu.EMPTY_NODE=new class{copy(e,t,n,r,i){return this}insert(e,t,n){return new Hu(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const Xu=function(e){return"number"==typeof e?"number:"+au(e):"string:"+e},Ju=function(e){if(e.isLeafNode()){const t=e.val();Object(na.f)("string"==typeof t||"number"==typeof t||"object"==typeof t&&Object(na.m)(t,".sv"),"Priority must be a string or number.")}else Object(na.f)(e===Yu||e.isEmpty(),"priority of unexpected type.");Object(na.f)(e===Yu||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let Zu,el,tl;class nl{constructor(e,t=nl.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,Object(na.f)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),Ju(this.priorityNode_)}static set __childrenNodeConstructor(e){Zu=e}static get __childrenNodeConstructor(){return Zu}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new nl(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:nl.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return Xe(e)?this:".priority"===Ke(e)?this.priorityNode_:nl.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:nl.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=Ke(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:(Object(na.f)(".priority"!==n||1===$e(e),".priority must be the last token in a path"),this.updateImmediateChild(n,nl.__childrenNodeConstructor.EMPTY_NODE.updateChild(We(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Xu(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?au(this.value_):this.value_,this.lazyHash_=zc(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===nl.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof nl.__childrenNodeConstructor?-1:(Object(na.f)(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,r=nl.VALUE_TYPE_ORDER.indexOf(t),i=nl.VALUE_TYPE_ORDER.indexOf(n);return Object(na.f)(r>=0,"Unknown leaf type: "+t),Object(na.f)(i>=0,"Unknown leaf type: "+n),r===i?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}return!1}}nl.VALUE_TYPE_ORDER=["object","boolean","number","string"];const rl=new class extends zu{compare(e,t){const n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?nu(e.name,t.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Bu.MIN}maxPost(){return new Bu(tu,new nl("[PRIORITY-POST]",tl))}makePost(e,t){const n=el(e);return new Bu(t,new nl("[PRIORITY-POST]",n))}toString(){return".priority"}},il=Math.log(2);class sl{constructor(e){this.count=parseInt(Math.log(e+1)/il,10),this.current_=this.count-1;const t=parseInt(Array(this.count+1).join("1"),2);this.bits_=e+1&t}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const ol=function(e,t,n,r){e.sort(t);const i=function t(r,i){const s=i-r;let o,a;if(0===s)return null;if(1===s)return o=e[r],a=n?n(o):o,new Hu(a,o.node,Hu.BLACK,null,null);{const c=parseInt(s/2,10)+r,u=t(r,c),l=t(c+1,i);return o=e[c],a=n?n(o):o,new Hu(a,o.node,Hu.BLACK,u,l)}},s=function(t){let r=null,s=null,o=e.length;const a=function(t,r){const s=o-t,a=o;o-=t;const u=i(s+1,a),l=e[s],h=n?n(l):l;c(new Hu(h,l.node,r,null,u))},c=function(e){r?(r.left=e,r=e):(s=e,r=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),r=Math.pow(2,t.count-(e+1));n?a(r,Hu.BLACK):(a(r,Hu.BLACK),a(r,Hu.RED))}return s}(new sl(e.length));return new Qu(r||t,s)};let al;const cl={};class ul{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return Object(na.f)(cl&&rl,"ChildrenNode.ts has not been loaded"),al=al||new ul({".priority":cl},{".priority":rl}),al}get(e){const t=Object(na.S)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Qu?t:null}hasIndex(e){return Object(na.m)(this.indexSet_,e.toString())}addIndex(e,t){Object(na.f)(e!==Wu,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let r=!1;const i=t.getIterator(Bu.Wrap);let s,o=i.getNext();for(;o;)r=r||e.isDefinedOn(o.node),n.push(o),o=i.getNext();s=r?ol(n,e.getCompare()):cl;const a=e.toString(),c=Fe({},this.indexSet_);c[a]=e;const u=Fe({},this.indexes_);return u[a]=s,new ul(u,c)}addToIndexes(e,t){const n=Object(na.P)(this.indexes_,((n,r)=>{const i=Object(na.S)(this.indexSet_,r);if(Object(na.f)(i,"Missing index implementation for "+r),n===cl){if(i.isDefinedOn(e.node)){const n=[],r=t.getIterator(Bu.Wrap);let s=r.getNext();for(;s;)s.name!==e.name&&n.push(s),s=r.getNext();return n.push(e),ol(n,i.getCompare())}return cl}{const r=t.get(e.name);let i=n;return r&&(i=i.remove(new Bu(e.name,r))),i.insert(e,e.node)}}));return new ul(n,this.indexSet_)}removeFromIndexes(e,t){const n=Object(na.P)(this.indexes_,(n=>{if(n===cl)return n;{const r=t.get(e.name);return r?n.remove(new Bu(e.name,r)):n}}));return new ul(n,this.indexSet_)}}let ll;class hl{constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Ju(this.priorityNode_),this.children_.isEmpty()&&Object(na.f)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return ll||(ll=new hl(new Qu(st),null,ul.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ll}updatePriority(e){return this.children_.isEmpty()?this:new hl(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?ll:t}}getChild(e){const t=Ke(e);return null===t?this:this.getImmediateChild(t).getChild(We(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if(Object(na.f)(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new Bu(e,t);let r,i;t.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(e,t),i=this.indexMap_.addToIndexes(n,this.children_));const s=r.isEmpty()?ll:this.priorityNode_;return new hl(r,s,i)}}updateChild(e,t){const n=Ke(e);if(null===n)return t;{Object(na.f)(".priority"!==Ke(e)||1===$e(e),".priority must be the last token in a path");const r=this.getImmediateChild(n).updateChild(We(e),t);return this.updateImmediateChild(n,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,r=0,i=!0;if(this.forEachChild(rl,((s,o)=>{t[s]=o.val(e),n++,i&&hl.INTEGER_REGEXP_.test(s)?r=Math.max(r,Number(s)):i=!1})),!e&&i&&r<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+Xu(this.getPriority().val())+":"),this.forEachChild(rl,((t,n)=>{const r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":zc(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const r=this.resolveIndex_(n);if(r){const n=r.getPredecessorKey(new Bu(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Bu(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Bu(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal((e=>t(e.name,e.node))):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(e=>e));{const n=this.children_.getIteratorFrom(e.name,Bu.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)<0;)n.getNext(),r=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(e=>e));{const n=this.children_.getReverseIteratorFrom(e.name,Bu.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)>0;)n.getNext(),r=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===dl?-1:0}withIndex(e){if(e===Wu||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new hl(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===Wu||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(rl),n=t.getIterator(rl);let r=e.getNext(),i=n.getNext();for(;r&&i;){if(r.name!==i.name||!r.node.equals(i.node))return!1;r=e.getNext(),i=n.getNext()}return null===r&&null===i}return!1}return!1}}resolveIndex_(e){return e===Wu?null:this.indexMap_.get(e.toString())}}hl.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const dl=new class extends hl{constructor(){super(new Qu(st),hl.EMPTY_NODE,ul.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return hl.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(Bu,{MIN:{value:new Bu(eu,hl.EMPTY_NODE)},MAX:{value:new Bu(tu,dl)}}),$u.__EMPTY_NODE=hl.EMPTY_NODE,nl.__childrenNodeConstructor=hl,Yu=dl,function(e){tl=e}(dl);const fl=!0;!function(e){el=e}(ot);class pl extends zu{constructor(e){super(),this.indexPath_=e,Object(na.f)(!Xe(e)&&".priority"!==Ke(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?nu(e.name,t.name):i}makePost(e,t){const n=ot(e),r=hl.EMPTY_NODE.updateChild(this.indexPath_,n);return new Bu(t,r)}maxPost(){const e=hl.EMPTY_NODE.updateChild(this.indexPath_,dl);return new Bu(tu,e)}toString(){return He(this.indexPath_,0).join("/")}}const gl=new class extends zu{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?nu(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Bu.MIN}maxPost(){return Bu.MAX}makePost(e,t){const n=ot(e);return new Bu(t,n)}toString(){return".value"}};class ml{constructor(e){this.index_=e}updateChild(e,t,n,r,i,s){Object(na.f)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const o=e.getImmediateChild(t);return o.getChild(r).equals(n.getChild(r))&&o.isEmpty()===n.isEmpty()?e:(null!=s&&(n.isEmpty()?e.hasChild(t)?s.trackChildChange(ut(t,o)):Object(na.f)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?s.trackChildChange(ct(t,n)):s.trackChildChange(lt(t,n,o))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}updateFullNode(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(rl,((e,r)=>{t.hasChild(e)||n.trackChildChange(ut(e,r))})),t.isLeafNode()||t.forEachChild(rl,((t,r)=>{if(e.hasChild(t)){const i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(lt(t,r,i))}else n.trackChildChange(ct(t,r))}))),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?hl.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class _l{constructor(e){this.indexedFilter_=new ml(e.getIndex()),this.index_=e.getIndex(),this.startPost_=_l.getStartPost_(e),this.endPost_=_l.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,n=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&n}updateChild(e,t,n,r,i,s){return this.matches(new Bu(t,n))||(n=hl.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,s)}updateFullNode(e,t,n){t.isLeafNode()&&(t=hl.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(hl.EMPTY_NODE);const i=this;return t.forEachChild(rl,((e,t)=>{i.matches(new Bu(e,t))||(r=r.updateImmediateChild(e,hl.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class yl{constructor(e){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{const t=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?t<=0:t<0},this.withinEndPost=e=>{const t=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?t<=0:t<0},this.rangedFilter_=new _l(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,n,r,i,s){return this.rangedFilter_.matches(new Bu(t,n))||(n=hl.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,s):this.fullLimitUpdateChild_(e,t,n,i,s)}updateFullNode(e,t,n){let r;if(t.isLeafNode()||t.isEmpty())r=hl.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;r=hl.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;e.hasNext()&&n<this.limit_;){const t=e.getNext();if(this.withinDirectionalStart(t)){if(!this.withinDirectionalEnd(t))break;r=r.updateImmediateChild(t.name,t.node),n++}}}else{let e;r=t.withIndex(this.index_),r=r.updatePriority(hl.EMPTY_NODE),e=this.reverse_?r.getReverseIterator(this.index_):r.getIterator(this.index_);let n=0;for(;e.hasNext();){const t=e.getNext();n<this.limit_&&this.withinDirectionalStart(t)&&this.withinDirectionalEnd(t)?n++:r=r.updateImmediateChild(t.name,hl.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,n,r,i){let s;if(this.reverse_){const e=this.index_.getCompare();s=(t,n)=>e(n,t)}else s=this.index_.getCompare();const o=e;Object(na.f)(o.numChildren()===this.limit_,"");const a=new Bu(t,n),c=this.reverse_?o.getFirstChild(this.index_):o.getLastChild(this.index_),u=this.rangedFilter_.matches(a);if(o.hasChild(t)){const e=o.getImmediateChild(t);let l=r.getChildAfterChild(this.index_,c,this.reverse_);for(;null!=l&&(l.name===t||o.hasChild(l.name));)l=r.getChildAfterChild(this.index_,l,this.reverse_);const h=null==l?1:s(l,a);if(u&&!n.isEmpty()&&h>=0)return null!=i&&i.trackChildChange(lt(t,n,e)),o.updateImmediateChild(t,n);{null!=i&&i.trackChildChange(ut(t,e));const n=o.updateImmediateChild(t,hl.EMPTY_NODE);return null!=l&&this.rangedFilter_.matches(l)?(null!=i&&i.trackChildChange(ct(l.name,l.node)),n.updateImmediateChild(l.name,l.node)):n}}return n.isEmpty()?e:u&&s(c,a)>=0?(null!=i&&(i.trackChildChange(ut(c.name,c.node)),i.trackChildChange(ct(t,n))),o.updateImmediateChild(t,n).updateImmediateChild(c.name,hl.EMPTY_NODE)):e}}class vl{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=rl}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return Object(na.f)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return Object(na.f)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:eu}hasEnd(){return this.endSet_}getIndexEndValue(){return Object(na.f)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return Object(na.f)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:tu}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return Object(na.f)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===rl}copy(){const e=new vl;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}class wl extends Ru{constructor(e,t,n,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=r,this.log_=Qc("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(Object(na.f)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,n,r){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const s=wl.getListenId_(e,n),o={};this.listens_[s]=o;const a=pt(e._queryParams);this.restRequest_(i+".json",a,((e,t)=>{let a=t;if(404===e&&(a=null,e=null),null===e&&this.onDataUpdate_(i,a,!1,n),Object(na.S)(this.listens_,s)===o){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",r(t,null)}}))}unlisten(e,t){const n=wl.getListenId_(e,t);delete this.listens_[n]}get(e){const t=pt(e._queryParams),n=e._path.toString(),r=new na.a;return this.restRequest_(n+".json",t,((e,t)=>{let i=t;404===e&&(i=null,e=null),null===e?(this.onDataUpdate_(n,i,!1,null),r.resolve(i)):r.reject(new Error(i))})),r.promise}refreshAuthToken(e){}restRequest_(e,t={},n){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((([r,i])=>{r&&r.accessToken&&(t.auth=r.accessToken),i&&i.token&&(t.ac=i.token);const s=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Object(na.Q)(t);this.log_("Sending REST request for "+s);const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(n&&4===o.readyState){this.log_("REST Response for "+s+" received. status:",o.status,"response:",o.responseText);let e=null;if(o.status>=200&&o.status<300){try{e=Object(na.O)(o.responseText)}catch(e){Jc("Failed to parse JSON response for "+s+": "+o.responseText)}n(null,e)}else 401!==o.status&&404!==o.status&&Jc("Got unsuccessful REST response for "+s+" Status: "+o.status),n(o.status);n=null}},o.open("GET",s,!0),o.send()}))}}class bl{constructor(){this.rootNode_=hl.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}class Il{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Fe({},e);return this.last_&&Ve(this.last_,((e,n)=>{t[e]=t[e]-n})),this.last_=e,t}}class Tl{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Il(e);const n=1e4+2e4*Math.random();hu(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;Ve(e,((e,r)=>{r>0&&Object(na.m)(this.statsToReport_,e)&&(t[e]=r,n=!0)})),n&&this.server_.reportStats(t),hu(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var El;!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(El||(El={}));class kl{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=El.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(Xe(this.path)){if(null!=this.affectedTree.value)return Object(na.f)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new ju(e));return new kl(ze(),t,this.revert)}}return Object(na.f)(Ke(this.path)===e,"operationForChild called for unrelated child."),new kl(We(this.path),this.affectedTree,this.revert)}}class Cl{constructor(e,t){this.source=e,this.path=t,this.type=El.LISTEN_COMPLETE}operationForChild(e){return Xe(this.path)?new Cl(this.source,ze()):new Cl(this.source,We(this.path))}}class Sl{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=El.OVERWRITE}operationForChild(e){return Xe(this.path)?new Sl(this.source,ze(),this.snap.getImmediateChild(e)):new Sl(this.source,We(this.path),this.snap)}}class Ol{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=El.MERGE}operationForChild(e){if(Xe(this.path)){const t=this.children.subtree(new ju(e));return t.isEmpty()?null:t.value?new Sl(this.source,ze(),t.value):new Ol(this.source,ze(),t)}return Object(na.f)(Ke(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Ol(this.source,We(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Al{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Xe(e))return this.isFullyInitialized()&&!this.filtered_;const t=Ke(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class Nl{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}let Pl;class Rl{constructor(e,t=(()=>(Pl||(Pl=new Qu(ru)),Pl))()){this.value=e,this.children=t}static fromObject(e){let t=new Rl(null);return Ve(e,((e,n)=>{t=t.set(new ju(e),n)})),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:ze(),value:this.value};if(Xe(e))return null;{const n=Ke(e),r=this.children.get(n);if(null!==r){const i=r.findRootMostMatchingPathAndValue(We(e),t);if(null!=i){return{path:Ye(new ju(n),i.path),value:i.value}}return null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,(()=>!0))}subtree(e){if(Xe(e))return this;{const t=Ke(e),n=this.children.get(t);return null!==n?n.subtree(We(e)):new Rl(null)}}set(e,t){if(Xe(e))return new Rl(t,this.children);{const n=Ke(e),r=(this.children.get(n)||new Rl(null)).set(We(e),t),i=this.children.insert(n,r);return new Rl(this.value,i)}}remove(e){if(Xe(e))return this.children.isEmpty()?new Rl(null):new Rl(null,this.children);{const t=Ke(e),n=this.children.get(t);if(n){const r=n.remove(We(e));let i;return i=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&i.isEmpty()?new Rl(null):new Rl(this.value,i)}return this}}get(e){if(Xe(e))return this.value;{const t=Ke(e),n=this.children.get(t);return n?n.get(We(e)):null}}setTree(e,t){if(Xe(e))return t;{const n=Ke(e),r=(this.children.get(n)||new Rl(null)).setTree(We(e),t);let i;return i=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),new Rl(this.value,i)}}fold(e){return this.fold_(ze(),e)}fold_(e,t){const n={};return this.children.inorderTraversal(((r,i)=>{n[r]=i.fold_(Ye(e,r),t)})),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,ze(),t)}findOnPath_(e,t,n){const r=!!this.value&&n(t,this.value);if(r)return r;if(Xe(e))return null;{const r=Ke(e),i=this.children.get(r);return i?i.findOnPath_(We(e),Ye(t,r),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,ze(),t)}foreachOnPath_(e,t,n){if(Xe(e))return this;{this.value&&n(t,this.value);const r=Ke(e),i=this.children.get(r);return i?i.foreachOnPath_(We(e),Ye(t,r),n):new Rl(null)}}foreach(e){this.foreach_(ze(),e)}foreach_(e,t){this.children.inorderTraversal(((n,r)=>{r.foreach_(Ye(e,n),t)})),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal(((t,n)=>{n.value&&e(t,n.value)}))}}class Dl{constructor(e){this.writeTree_=e}static empty(){return new Dl(new Rl(null))}}class xl{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;Object(na.f)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),Object(na.f)(".priority"!==n,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(n);if(r){const i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,lt(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,ut(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,ct(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw Object(na.g)("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,lt(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}const Ml=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class Ll{constructor(e,t,n=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new Al(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Ht(this.writes_,e,t)}}getChildAfterChild(e,t,n){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Ct(this.viewCache_),i=Gt(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]}}class jl{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,r=new ml(n.getIndex()),i=(s=n).loadsAllData()?new ml(s.getIndex()):s.hasLimit()?new yl(s):new _l(s);var s;this.processor_=function(e){return{filter:e}}(i);const o=t.serverCache,a=t.eventCache,c=r.updateFullNode(hl.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(hl.EMPTY_NODE,a.getNode(),null),l=new Al(c,o.isFullyInitialized(),r.filtersNodes()),h=new Al(u,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=It(h,l),this.eventGenerator_=new Nl(this.query_)}get query(){return this.query_}}let Fl,Ul;class Vl{constructor(){this.views=new Map}}let ql=1;class Bl{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Rl(null),this.pendingWriteTree_={visibleWrites:Dl.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}class zl{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new zl(t)}node(){return this.node_}}class Kl{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Ye(this.path_,e);return new Kl(this.syncTree_,t)}node(){return Sn(this.syncTree_,this.path_)}}const $l=function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e},Wl=function(e,t,n){return e&&"object"==typeof e?(Object(na.f)(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?Gl(e[".sv"],t,n):"object"==typeof e[".sv"]?Hl(e[".sv"],t):void Object(na.f)(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},Gl=function(e,t,n){if("timestamp"===e)return n.timestamp;Object(na.f)(!1,"Unexpected server value: "+e)},Hl=function(e,t){e.hasOwnProperty("increment")||Object(na.f)(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const n=e.increment;"number"!=typeof n&&Object(na.f)(!1,"Unexpected increment value: "+n);const r=t.node();if(Object(na.f)(null!=r,"Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return n;const i=r.getValue();return"number"!=typeof i?n:i+n},Ql=function(e,t,n,r){return Un(t,new Kl(n,e),r)},Yl=function(e,t,n){return Un(e,new zl(t),n)};class Xl{constructor(e="",t=null,n={children:{},childCount:0}){this.name=e,this.parent=t,this.node=n}}const Jl=/[\[\].#$\/\u0000-\u001F\u007F]/,Zl=/[\[\].#$\u0000-\u001F\u007F]/,eh=10485760,th=function(e){return"string"==typeof e&&0!==e.length&&!Jl.test(e)},nh=function(e){return"string"==typeof e&&0!==e.length&&!Zl.test(e)},rh=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!Zc(e)||e&&"object"==typeof e&&Object(na.m)(e,".sv")},ih=function(e,t,n,r){r&&void 0===t||sh(Object(na.s)(e,"value"),t,n)},sh=function e(t,n,r){const i=r instanceof ju?new Fu(r,t):r;if(void 0===n)throw new Error(t+"contains undefined "+rt(i));if("function"==typeof n)throw new Error(t+"contains a function "+rt(i)+" with contents = "+n.toString());if(Zc(n))throw new Error(t+"contains "+n.toString()+" "+rt(i));if("string"==typeof n&&n.length>eh/3&&Object(na.T)(n)>eh)throw new Error(t+"contains a string greater than "+eh+" utf8 bytes "+rt(i)+" ('"+n.substring(0,50)+"...')");if(n&&"object"==typeof n){let r=!1,s=!1;if(Ve(n,((n,o)=>{if(".value"===n)r=!0;else if(".priority"!==n&&".sv"!==n&&(s=!0,!th(n)))throw new Error(t+" contains an invalid key ("+n+") "+rt(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');var a,c;c=n,(a=i).parts_.length>0&&(a.byteLength_+=1),a.parts_.push(c),a.byteLength_+=Object(na.T)(c),nt(a),e(t,o,i),function(e){const t=e.parts_.pop();e.byteLength_-=Object(na.T)(t),e.parts_.length>0&&(e.byteLength_-=1)}(i)})),r&&s)throw new Error(t+' contains ".value" child '+rt(i)+" in addition to actual children.")}},oh=function(e,t,n,r){if(r&&void 0===t)return;const i=Object(na.s)(e,"values");if(!t||"object"!=typeof t||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");const s=[];Ve(t,((e,t)=>{const r=new ju(e);if(sh(i,t,Ye(n,r)),".priority"===Ge(r)&&!rh(t))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(r)})),function(e,t){let n,r;for(n=0;n<t.length;n++){r=t[n];const i=He(r);for(let t=0;t<i.length;t++)if(".priority"===i[t]&&t===i.length-1);else if(!th(i[t]))throw new Error(e+"contains an invalid key ("+i[t]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}t.sort(Ze);let i=null;for(n=0;n<t.length;n++){if(r=t[n],null!==i&&tt(i,r))throw new Error(e+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,s)},ah=function(e,t,n){if(!n||void 0!==t){if(Zc(t))throw new Error(Object(na.s)(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!rh(t))throw new Error(Object(na.s)(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},ch=function(e,t,n,r){if(!(r&&void 0===n||th(n)))throw new Error(Object(na.s)(e,t)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},uh=function(e,t,n,r){if(!(r&&void 0===n||nh(n)))throw new Error(Object(na.s)(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},lh=function(e,t,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),uh(e,t,n,r)},hh=function(e,t){if(".info"===Ke(t))throw new Error(e+" failed = Can't modify data under /.info/")},dh=function(e,t){const n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!th(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),nh(e)}(n))throw new Error(Object(na.s)(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class fh{constructor(){this.eventLists_=[],this.recursionDepth_=0}}const ph="repo_interrupt",gh=25;class mh{constructor(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new fh,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=mt(),this.transactionQueueTree_=new Xl,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}const _h=function(e,t){const n=yh(e),r=n.namespace;"firebase.com"===n.domain&&Xc(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||Xc("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Jc("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");return{repoInfo:new wu(n.host,n.secure,r,"ws"===n.scheme||"wss"===n.scheme,t,"",r!==n.subdomain),path:new ju(n.pathString)}},yh=function(e){let t="",n="",r="",i="",s="",o=!0,a="https",c=443;if("string"==typeof e){let u=e.indexOf("//");u>=0&&(a=e.substring(0,u-1),e=e.substring(u+2));let l=e.indexOf("/");-1===l&&(l=e.length);let h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(l,h)),l<h&&(i=function(e){let t="";const n=e.split("/");for(let e=0;e<n.length;e++)if(n[e].length>0){let r=n[e];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch(e){}t+="/"+r}return t}(e.substring(l,h)));const d=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const r=n.split("=");2===r.length?t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Jc(`Invalid query segment '${n}' in query '${e}'`)}return t}(e.substring(Math.min(e.length,h)));u=t.indexOf(":"),u>=0?(o="https"===a||"wss"===a,c=parseInt(t.substring(u+1),10)):u=t.length;const f=t.slice(0,u);if("localhost"===f.toLowerCase())n="localhost";else if(f.split(".").length<=2)n=f;else{const e=t.indexOf(".");r=t.substring(0,e).toLowerCase(),n=t.substring(e+1),s=r}"ns"in d&&(s=d.ns)}return{host:t,port:c,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}},vh="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",wh=function(){let e=0;const t=[];return function(n){const r=n===e;let i;e=n;const s=new Array(8);for(i=7;i>=0;i--)s[i]=vh.charAt(n%64),n=Math.floor(n/64);Object(na.f)(0===n,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&63===t[i];i--)t[i]=0;t[i]++}else for(i=0;i<12;i++)t[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)o+=vh.charAt(t[i]);return Object(na.f)(20===o.length,"nextPushId: Length should be 20."),o}}();class bh{constructor(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Object(na.V)(this.snapshot.exportVal())}}class Ih{constructor(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class Th{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return Object(na.f)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class Eh{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new na.a;return ar(this._repo,this._path,e.wrapCallback((()=>{}))),e.promise}remove(){hh("OnDisconnect.remove",this._path);const e=new na.a;return cr(this._repo,this._path,null,e.wrapCallback((()=>{}))),e.promise}set(e){hh("OnDisconnect.set",this._path),ih("OnDisconnect.set",e,this._path,!1);const t=new na.a;return cr(this._repo,this._path,e,t.wrapCallback((()=>{}))),t.promise}setWithPriority(e,t){hh("OnDisconnect.setWithPriority",this._path),ih("OnDisconnect.setWithPriority",e,this._path,!1),ah("OnDisconnect.setWithPriority",t,!1);const n=new na.a;return function(e,t,n,r,i){const s=ot(n,r);e.server_.onDisconnectPut(t.toString(),s.val(!0),((n,r)=>{"ok"===n&&_t(e.onDisconnect_,t,s),dr(0,i,n,r)}))}(this._repo,this._path,e,t,n.wrapCallback((()=>{}))),n.promise}update(e){hh("OnDisconnect.update",this._path),oh("OnDisconnect.update",e,this._path,!1);const t=new na.a;return function(e,t,n,r){if(Object(na.E)(n))return Hc("onDisconnect().update() called with empty data.  Don't do anything."),void dr(0,r,"ok",void 0);e.server_.onDisconnectMerge(t.toString(),n,((i,s)=>{"ok"===i&&Ve(n,((n,r)=>{const i=ot(r);_t(e.onDisconnect_,Ye(t,n),i)})),dr(0,r,i,s)}))}(this._repo,this._path,e,t.wrapCallback((()=>{}))),t.promise}}class kh{constructor(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}get key(){return Xe(this._path)?null:Ge(this._path)}get ref(){return new Ch(this._repo,this._path)}get _queryIdentifier(){const e=gt(this._queryParams),t=su(e);return"{}"===t?"default":t}get _queryObject(){return gt(this._queryParams)}isEqual(e){if(!((e=Object(na.z)(e))instanceof kh))return!1;const t=this._repo===e._repo,n=et(this._path,e._path);return t&&n&&this._queryIdentifier===e._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}class Ch extends kh{constructor(e,t){super(e,t,new vl,!1)}get parent(){const e=Qe(this._path);return null===e?null:new Ch(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class Sh{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new ju(e),n=Sr(this.ref,e);return new Sh(this._node.getChild(t),n,rl)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){if(this._node.isLeafNode())return!1;return!!this._node.forEachChild(this._index,((t,n)=>e(new Sh(n,Sr(this.ref,t),rl))))}hasChild(e){const t=new ju(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}class Oh{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const n=t._queryParams.getIndex();return new bh("value",this,new Sh(e.snapshotNode,new Ch(t._repo,t._path),n))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Ih(this,e,t):null}matches(e){return e instanceof Oh&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class Ah{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new Ih(this,e,t):null}createEvent(e,t){Object(na.f)(null!=e.childName,"Child events should have a childName.");const n=Sr(new Ch(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new bh(e.type,this,new Sh(e.snapshotNode,n,r),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof Ah&&(this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)))}hasAnyCallback(){return!!this.callbackContext}}class Nh{}class Ph extends Nh{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){ih("endAt",this._value,e._path,!0);const t=dt(e._queryParams,this._value,this._key);if(Er(t),Tr(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new kh(e._repo,e._path,t,e._orderByCalled)}}class Rh extends Nh{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){ih("endBefore",this._value,e._path,!1);const t=function(e,t,n){let r;return r=dt(e,t,e.index_===Wu||n?n:eu),r.endBeforeSet_=!0,r}(e._queryParams,this._value,this._key);if(Er(t),Tr(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new kh(e._repo,e._path,t,e._orderByCalled)}}class Dh extends Nh{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){ih("startAt",this._value,e._path,!0);const t=ht(e._queryParams,this._value,this._key);if(Er(t),Tr(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new kh(e._repo,e._path,t,e._orderByCalled)}}class xh extends Nh{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){ih("startAfter",this._value,e._path,!1);const t=function(e,t,n){let r;return r=ht(e,t,e.index_===Wu||n?n:tu),r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(Er(t),Tr(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new kh(e._repo,e._path,t,e._orderByCalled)}}class Mh extends Nh{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new kh(e._repo,e._path,function(e,t){const n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="l",n}(e._queryParams,this._limit),e._orderByCalled)}}class Lh extends Nh{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new kh(e._repo,e._path,function(e,t){const n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="r",n}(e._queryParams,this._limit),e._orderByCalled)}}class jh extends Nh{constructor(e){super(),this._path=e}_apply(e){Ir(e,"orderByChild");const t=new ju(this._path);if(Xe(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const n=new pl(t),r=ft(e._queryParams,n);return Tr(r),new kh(e._repo,e._path,r,!0)}}class Fh extends Nh{_apply(e){Ir(e,"orderByKey");const t=ft(e._queryParams,Wu);return Tr(t),new kh(e._repo,e._path,t,!0)}}class Uh extends Nh{_apply(e){Ir(e,"orderByPriority");const t=ft(e._queryParams,rl);return Tr(t),new kh(e._repo,e._path,t,!0)}}class Vh extends Nh{_apply(e){Ir(e,"orderByValue");const t=ft(e._queryParams,gl);return Tr(t),new kh(e._repo,e._path,t,!0)}}class qh extends Nh{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){if(ih("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Ph(this._value,this._key)._apply(new Dh(this._value,this._key)._apply(e))}}!function(e){Object(na.f)(!Fl,"__referenceConstructor has already been defined"),Fl=e}(Ch),function(e){Object(na.f)(!Ul,"__referenceConstructor has already been defined"),Ul=e}(Ch);const Bh="FIREBASE_DATABASE_EMULATOR_HOST",zh={};let Kh=!1;class $h{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Zn(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Ch(this._repo,ze())),this._rootInternal}_delete(){return null!==this._rootInternal&&(!function(e,t){const n=zh[t];n&&n[e.key]===e||Xc(`Database ${t}(${e.repoInfo_}) has already been deleted.`),lr(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&Xc("Cannot call "+e+" on a deleted database.")}}const Wh={".sv":"timestamp"};class Gh{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}qu.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},qu.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};var Hh;Ue(ea.SDK_VERSION),Object(ea._registerComponent)(new ra.a("database",((e,{instanceIdentifier:t})=>Ur(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t)),"PUBLIC").setMultipleInstances(!0)),Object(ea.registerVersion)(Dc,xc,Hh),Object(ea.registerVersion)(Dc,xc,"esm2017");const Qh=new ta.b("@firebase/database-compat"),Yh=function(e){Qh.warn("FIREBASE WARNING: "+e)};class Xh{constructor(e){this._delegate=e}cancel(e){Object(na.X)("OnDisconnect.cancel",0,1,arguments.length),Object(na.Y)("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then((()=>e(null)),(t=>e(t))),t}remove(e){Object(na.X)("OnDisconnect.remove",0,1,arguments.length),Object(na.Y)("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then((()=>e(null)),(t=>e(t))),t}set(e,t){Object(na.X)("OnDisconnect.set",1,2,arguments.length),Object(na.Y)("OnDisconnect.set","onComplete",t,!0);const n=this._delegate.set(e);return t&&n.then((()=>t(null)),(e=>t(e))),n}setWithPriority(e,t,n){Object(na.X)("OnDisconnect.setWithPriority",2,3,arguments.length),Object(na.Y)("OnDisconnect.setWithPriority","onComplete",n,!0);const r=this._delegate.setWithPriority(e,t);return n&&r.then((()=>n(null)),(e=>n(e))),r}update(e,t){if(Object(na.X)("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const t={};for(let n=0;n<e.length;++n)t[""+n]=e[n];e=t,Yh("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Object(na.Y)("OnDisconnect.update","onComplete",t,!0);const n=this._delegate.update(e);return t&&n.then((()=>t(null)),(e=>t(e))),n}}class Jh{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return Object(na.X)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class Zh{constructor(e,t){this._database=e,this._delegate=t}val(){return Object(na.X)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return Object(na.X)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return Object(na.X)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return Object(na.X)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return Object(na.X)("DataSnapshot.child",0,1,arguments.length),e=String(e),uh("DataSnapshot.child","path",e,!1),new Zh(this._database,this._delegate.child(e))}hasChild(e){return Object(na.X)("DataSnapshot.hasChild",1,1,arguments.length),uh("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return Object(na.X)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return Object(na.X)("DataSnapshot.forEach",1,1,arguments.length),Object(na.Y)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach((t=>e(new Zh(this._database,t))))}hasChildren(){return Object(na.X)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return Object(na.X)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return Object(na.X)("DataSnapshot.ref",0,0,arguments.length),new td(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class ed{constructor(e,t){this.database=e,this._delegate=t}on(e,t,n,r){var i;Object(na.X)("Query.on",2,4,arguments.length),Object(na.Y)("Query.on","callback",t,!1);const s=ed.getCancelAndContextArgs_("Query.on",n,r),o=(e,n)=>{t.call(s.context,new Zh(this.database,e),n)};o.userCallback=t,o.context=s.context;const a=null===(i=s.cancel)||void 0===i?void 0:i.bind(s.context);switch(e){case"value":return Rr(this._delegate,o,a),t;case"child_added":return Dr(this._delegate,o,a),t;case"child_removed":return Lr(this._delegate,o,a),t;case"child_changed":return xr(this._delegate,o,a),t;case"child_moved":return Mr(this._delegate,o,a),t;default:throw new Error(Object(na.s)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,n){if(Object(na.X)("Query.off",0,3,arguments.length),function(e,t,n){if(!n||void 0!==t)switch(t){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Object(na.s)(e,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}("Query.off",e,!0),Object(na.Y)("Query.off","callback",t,!0),Object(na.Z)("Query.off","context",n,!0),t){const r=()=>{};r.userCallback=t,r.context=n,jr(this._delegate,e,r)}else jr(this._delegate,e)}get(){return Nr(this._delegate).then((e=>new Zh(this.database,e)))}once(e,t,n,r){Object(na.X)("Query.once",1,4,arguments.length),Object(na.Y)("Query.once","callback",t,!0);const i=ed.getCancelAndContextArgs_("Query.once",n,r),s=new na.a,o=(e,n)=>{const r=new Zh(this.database,e);t&&t.call(i.context,r,n),s.resolve(r)};o.userCallback=t,o.context=i.context;const a=e=>{i.cancel&&i.cancel.call(i.context,e),s.reject(e)};switch(e){case"value":Rr(this._delegate,o,a,{onlyOnce:!0});break;case"child_added":Dr(this._delegate,o,a,{onlyOnce:!0});break;case"child_removed":Lr(this._delegate,o,a,{onlyOnce:!0});break;case"child_changed":xr(this._delegate,o,a,{onlyOnce:!0});break;case"child_moved":Mr(this._delegate,o,a,{onlyOnce:!0});break;default:throw new Error(Object(na.s)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return s.promise}limitToFirst(e){return Object(na.X)("Query.limitToFirst",1,1,arguments.length),new ed(this.database,Fr(this._delegate,function(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new Mh(e)}(e)))}limitToLast(e){return Object(na.X)("Query.limitToLast",1,1,arguments.length),new ed(this.database,Fr(this._delegate,function(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new Lh(e)}(e)))}orderByChild(e){return Object(na.X)("Query.orderByChild",1,1,arguments.length),new ed(this.database,Fr(this._delegate,function(e){if("$key"===e)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===e)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===e)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return uh("orderByChild","path",e,!1),new jh(e)}(e)))}orderByKey(){return Object(na.X)("Query.orderByKey",0,0,arguments.length),new ed(this.database,Fr(this._delegate,new Fh))}orderByPriority(){return Object(na.X)("Query.orderByPriority",0,0,arguments.length),new ed(this.database,Fr(this._delegate,new Uh))}orderByValue(){return Object(na.X)("Query.orderByValue",0,0,arguments.length),new ed(this.database,Fr(this._delegate,new Vh))}startAt(e=null,t){return Object(na.X)("Query.startAt",0,2,arguments.length),new ed(this.database,Fr(this._delegate,function(e=null,t){return ch("startAt","key",t,!0),new Dh(e,t)}(e,t)))}startAfter(e=null,t){return Object(na.X)("Query.startAfter",0,2,arguments.length),new ed(this.database,Fr(this._delegate,function(e,t){return ch("startAfter","key",t,!0),new xh(e,t)}(e,t)))}endAt(e=null,t){return Object(na.X)("Query.endAt",0,2,arguments.length),new ed(this.database,Fr(this._delegate,function(e,t){return ch("endAt","key",t,!0),new Ph(e,t)}(e,t)))}endBefore(e=null,t){return Object(na.X)("Query.endBefore",0,2,arguments.length),new ed(this.database,Fr(this._delegate,function(e,t){return ch("endBefore","key",t,!0),new Rh(e,t)}(e,t)))}equalTo(e,t){return Object(na.X)("Query.equalTo",1,2,arguments.length),new ed(this.database,Fr(this._delegate,function(e,t){return ch("equalTo","key",t,!0),new qh(e,t)}(e,t)))}toString(){return Object(na.X)("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return Object(na.X)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(Object(na.X)("Query.isEqual",1,1,arguments.length),!(e instanceof ed)){throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.")}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,n){const r={cancel:void 0,context:void 0};if(t&&n)r.cancel=t,Object(na.Y)(e,"cancel",r.cancel,!0),r.context=n,Object(na.Z)(e,"context",r.context,!0);else if(t)if("object"==typeof t&&null!==t)r.context=t;else{if("function"!=typeof t)throw new Error(Object(na.s)(e,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=t}return r}get ref(){return new td(this.database,new Ch(this._delegate._repo,this._delegate._path))}}class td extends ed{constructor(e,t){super(e,new kh(t._repo,t._path,new vl,!1)),this.database=e,this._delegate=t}getKey(){return Object(na.X)("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return Object(na.X)("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new td(this.database,Sr(this._delegate,e))}getParent(){Object(na.X)("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new td(this.database,e):null}getRoot(){return Object(na.X)("Reference.root",0,0,arguments.length),new td(this.database,this._delegate.root)}set(e,t){Object(na.X)("Reference.set",1,2,arguments.length),Object(na.Y)("Reference.set","onComplete",t,!0);const n=Or(this._delegate,e);return t&&n.then((()=>t(null)),(e=>t(e))),n}update(e,t){if(Object(na.X)("Reference.update",1,2,arguments.length),Array.isArray(e)){const t={};for(let n=0;n<e.length;++n)t[""+n]=e[n];e=t,Yh("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}hh("Reference.update",this._delegate._path),Object(na.Y)("Reference.update","onComplete",t,!0);const n=Ar(this._delegate,e);return t&&n.then((()=>t(null)),(e=>t(e))),n}setWithPriority(e,t,n){Object(na.X)("Reference.setWithPriority",2,3,arguments.length),Object(na.Y)("Reference.setWithPriority","onComplete",n,!0);const r=function(e,t,n){if(hh("setWithPriority",e._path),ih("setWithPriority",t,e._path,!1),ah("setWithPriority",n,!1),".length"===e.key||".keys"===e.key)throw"setWithPriority failed: "+e.key+" is a read-only object.";const r=new na.a;return or(e._repo,e._path,t,n,r.wrapCallback((()=>{}))),r.promise}(this._delegate,e,t);return n&&r.then((()=>n(null)),(e=>n(e))),r}remove(e){Object(na.X)("Reference.remove",0,1,arguments.length),Object(na.Y)("Reference.remove","onComplete",e,!0);const t=(hh("remove",(n=this._delegate)._path),Or(n,null));var n;return e&&t.then((()=>e(null)),(t=>e(t))),t}transaction(e,t,n){Object(na.X)("Reference.transaction",1,3,arguments.length),Object(na.Y)("Reference.transaction","transactionUpdate",e,!1),Object(na.Y)("Reference.transaction","onComplete",t,!0),function(e,t,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error(Object(na.s)(e,t)+"must be a boolean.")}("Reference.transaction","applyLocally",n,!0);const r=Wr(this._delegate,e,{applyLocally:n}).then((e=>new Jh(e.committed,new Zh(this.database,e.snapshot))));return t&&r.then((e=>t(null,e.committed,e.snapshot)),(e=>t(e,!1,null))),r}setPriority(e,t){Object(na.X)("Reference.setPriority",1,2,arguments.length),Object(na.Y)("Reference.setPriority","onComplete",t,!0);const n=function(e,t){e=Object(na.z)(e),hh("setPriority",e._path),ah("setPriority",t,!1);const n=new na.a;return or(e._repo,Ye(e._path,".priority"),t,null,n.wrapCallback((()=>{}))),n.promise}(this._delegate,e);return t&&n.then((()=>t(null)),(e=>t(e))),n}push(e,t){Object(na.X)("Reference.push",0,2,arguments.length),Object(na.Y)("Reference.push","onComplete",t,!0);const n=function(e,t){e=Object(na.z)(e),hh("push",e._path),ih("push",t,e._path,!0);const n=er(e._repo),r=wh(n),i=Sr(e,r),s=Sr(e,r);let o;return o=null!=t?Or(s,t).then((()=>s)):Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}(this._delegate,e),r=n.then((e=>new td(this.database,e)));t&&r.then((()=>t(null)),(e=>t(e)));const i=new td(this.database,n);return i.then=r.then.bind(r),i.catch=r.catch.bind(r,void 0),i}onDisconnect(){return hh("Reference.onDisconnect",this._delegate._path),new Xh(new Eh(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class nd{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:qr,forceLongPolling:Br}}useEmulator(e,t,n={}){zr(this._delegate,e,t,n)}ref(e){if(Object(na.X)("database.ref",0,1,arguments.length),e instanceof td){const t=Cr(this._delegate,e.toString());return new td(this,t)}{const t=kr(this._delegate,e);return new td(this,t)}}refFromURL(e){Object(na.X)("database.refFromURL",1,1,arguments.length);const t=Cr(this._delegate,e);return new td(this,t)}goOffline(){return Object(na.X)("database.goOffline",0,0,arguments.length),e=this._delegate,(e=Object(na.z)(e))._checkNotDeleted("goOffline"),void lr(e._repo);var e}goOnline(){return Object(na.X)("database.goOnline",0,0,arguments.length),Kr(this._delegate)}}nd.ServerValue={TIMESTAMP:Wh,increment:e=>function(e){return{".sv":{increment:e}}}(e)};var rd=Object.freeze({__proto__:null,initStandalone:function({app:e,url:t,version:n,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){Ue(n);const a=new ra.b("database-standalone"),c=new ra.c("auth-internal",a);let u;return c.setComponent(new ra.a("auth-internal",(()=>r),"PRIVATE")),i&&(u=new ra.c("app-check-internal",a),u.setComponent(new ra.a("app-check-internal",(()=>i),"PRIVATE"))),{instance:new nd(Ur(e,c,u,t,o),e),namespace:s}}});const id=nd.ServerValue;var sd;(sd=Zo.a).INTERNAL.registerComponent(new ra.a("database-compat",((e,{instanceIdentifier:t})=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("database").getImmediate({identifier:t});return new nd(r,n)}),"PUBLIC").setServiceProps({Reference:td,Query:ed,Database:nd,DataSnapshot:Zh,enableLogging:$r,INTERNAL:rd,ServerValue:id}).setMultipleInstances(!0)),sd.registerVersion("@firebase/database-compat","1.0.1");var od=n("zaJb");class ad{constructor(e){this._delegate=e}static fromBase64String(e){return Yr(),new ad(od.b.fromBase64String(e))}static fromUint8Array(e){return Qr(),new ad(od.b.fromUint8Array(e))}toBase64(){return Yr(),this._delegate.toBase64()}toUint8Array(){return Qr(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}class cd{enableIndexedDbPersistence(e,t){return Object(od.F)(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return Object(od.G)(e._delegate)}clearIndexedDbPersistence(e){return Object(od.x)(e._delegate)}}class ud{constructor(e,t,n){this._delegate=t,this._persistenceProvider=n,this.INTERNAL={delete:()=>this.terminate()},e instanceof od.m||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();e.merge||t.host===e.host||Object(od.s)("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Gr(Gr({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,n={}){Object(od.A)(this._delegate,e,t,n)}enableNetwork(){return Object(od.H)(this._delegate)}disableNetwork(){return Object(od.D)(this._delegate)}enablePersistence(e){let t=!1,n=!1;return e&&(t=!!e.synchronizeTabs,n=!!e.experimentalForceOwningTab,Object(od.t)("synchronizeTabs",t,"experimentalForceOwningTab",n)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return Object(od.mb)(this._delegate)}onSnapshotsInSync(e){return Object(od.Z)(this._delegate,e)}get app(){if(!this._appCompat)throw new od.g("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new wd(this,Object(od.y)(this._delegate,e))}catch(e){throw Jr(e,"collection()","Firestore.collection()")}}doc(e){try{return new pd(this,Object(od.E)(this._delegate,e))}catch(e){throw Jr(e,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new _d(this,Object(od.z)(this._delegate,e))}catch(e){throw Jr(e,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return Object(od.eb)(this._delegate,(t=>e(new hd(this,t))))}batch(){return Object(od.K)(this._delegate),new dd(new od.l(this._delegate,(e=>Object(od.L)(this._delegate,e))))}loadBundle(e){return Object(od.W)(this._delegate,e)}namedQuery(e){return Object(od.X)(this._delegate,e).then((e=>e?new _d(this,e):null))}}class ld extends od.a{constructor(e){super(),this.firestore=e}convertBytes(e){return new ad(new od.b(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return pd.forKey(t,this.firestore,null)}}class hd{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new ld(e)}get(e){const t=ti(e);return this._delegate.get(t).then((e=>new gd(this._firestore,new od.e(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,t.converter))))}set(e,t,n){const r=ti(e);return n?(Hr("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n,...r){const i=ti(e);return 2===arguments.length?this._delegate.update(i,t):this._delegate.update(i,t,n,...r),this}delete(e){const t=ti(e);return this._delegate.delete(t),this}}class dd{constructor(e){this._delegate=e}set(e,t,n){const r=ti(e);return n?(Hr("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n,...r){const i=ti(e);return 2===arguments.length?this._delegate.update(i,t):this._delegate.update(i,t,n,...r),this}delete(e){const t=ti(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class fd{constructor(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}fromFirestore(e,t){const n=new od.i(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new md(this._firestore,n),null!=t?t:{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const n=fd.INSTANCES;let r=n.get(e);r||(r=new WeakMap,n.set(e,r));let i=r.get(t);return i||(i=new fd(e,new ld(e),t),r.set(t,i)),i}}fd.INSTANCES=new WeakMap;class pd{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new ld(e)}static forPath(e,t,n){if(e.length%2!=0)throw new od.g("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new pd(t,new od.d(t._delegate,n,new od.n(e)))}static forKey(e,t,n){return new pd(t,new od.d(t._delegate,n,e))}get id(){return this._delegate.id}get parent(){return new wd(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new wd(this.firestore,Object(od.y)(this._delegate,e))}catch(e){throw Jr(e,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=Object(na.z)(e))instanceof od.d&&Object(od.db)(this._delegate,e)}set(e,t){t=Hr("DocumentReference.set",t);try{return t?Object(od.gb)(this._delegate,e,t):Object(od.gb)(this._delegate,e)}catch(e){throw Jr(e,"setDoc()","DocumentReference.set()")}}update(e,t,...n){try{return 1===arguments.length?Object(od.lb)(this._delegate,e):Object(od.lb)(this._delegate,e,t,...n)}catch(e){throw Jr(e,"updateDoc()","DocumentReference.update()")}}delete(){return Object(od.B)(this._delegate)}onSnapshot(...e){const t=Zr(e),n=ei(e,(e=>new gd(this.firestore,new od.e(this.firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,this._delegate.converter))));return Object(od.Y)(this._delegate,t,n)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?Object(od.N)(this._delegate):"server"===(null==e?void 0:e.source)?Object(od.O)(this._delegate):Object(od.M)(this._delegate),t.then((e=>new gd(this.firestore,new od.e(this.firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,this._delegate.converter))))}withConverter(e){return new pd(this.firestore,this._delegate.withConverter(e?fd.getInstance(this.firestore,e):null))}}class gd{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new pd(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return Object(od.ib)(this._delegate,e._delegate)}}class md extends gd{data(e){const t=this._delegate.data(e);return Object(od.q)(void 0!==t,"Document in a QueryDocumentSnapshot should exist"),t}}class _d{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new ld(e)}where(e,t,n){try{return new _d(this.firestore,Object(od.bb)(this._delegate,Object(od.nb)(e,t,n)))}catch(e){throw Jr(e,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new _d(this.firestore,Object(od.bb)(this._delegate,Object(od.ab)(e,t)))}catch(e){throw Jr(e,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new _d(this.firestore,Object(od.bb)(this._delegate,Object(od.U)(e)))}catch(e){throw Jr(e,"limit()","Query.limit()")}}limitToLast(e){try{return new _d(this.firestore,Object(od.bb)(this._delegate,Object(od.V)(e)))}catch(e){throw Jr(e,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new _d(this.firestore,Object(od.bb)(this._delegate,Object(od.kb)(...e)))}catch(e){throw Jr(e,"startAt()","Query.startAt()")}}startAfter(...e){try{return new _d(this.firestore,Object(od.bb)(this._delegate,Object(od.jb)(...e)))}catch(e){throw Jr(e,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new _d(this.firestore,Object(od.bb)(this._delegate,Object(od.J)(...e)))}catch(e){throw Jr(e,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new _d(this.firestore,Object(od.bb)(this._delegate,Object(od.I)(...e)))}catch(e){throw Jr(e,"endAt()","Query.endAt()")}}isEqual(e){return Object(od.cb)(this._delegate,e._delegate)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?Object(od.Q)(this._delegate):"server"===(null==e?void 0:e.source)?Object(od.R)(this._delegate):Object(od.P)(this._delegate),t.then((e=>new vd(this.firestore,new od.j(this.firestore._delegate,this._userDataWriter,this._delegate,e._snapshot))))}onSnapshot(...e){const t=Zr(e),n=ei(e,(e=>new vd(this.firestore,new od.j(this.firestore._delegate,this._userDataWriter,this._delegate,e._snapshot))));return Object(od.Y)(this._delegate,t,n)}withConverter(e){return new _d(this.firestore,this._delegate.withConverter(e?fd.getInstance(this.firestore,e):null))}}class yd{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new md(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class vd{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new _d(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map((e=>new md(this._firestore,e)))}docChanges(e){return this._delegate.docChanges(e).map((e=>new yd(this._firestore,e)))}forEach(e,t){this._delegate.forEach((n=>{e.call(t,new md(this._firestore,n))}))}isEqual(e){return Object(od.ib)(this._delegate,e._delegate)}}class wd extends _d{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new pd(this.firestore,e):null}doc(e){try{return new pd(this.firestore,void 0===e?Object(od.E)(this._delegate):Object(od.E)(this._delegate,e))}catch(e){throw Jr(e,"doc()","CollectionReference.doc()")}}add(e){return Object(od.u)(this._delegate,e).then((e=>new pd(this.firestore,e)))}isEqual(e){return Object(od.db)(this._delegate,e._delegate)}withConverter(e){return new wd(this.firestore,this._delegate.withConverter(e?fd.getInstance(this.firestore,e):null))}}class bd{constructor(...e){this._delegate=new od.f(...e)}static documentId(){return new bd(od.o.keyField().canonicalString())}isEqual(e){return(e=Object(na.z)(e))instanceof od.f&&this._delegate._internalPath.isEqual(e._internalPath)}}class Id{constructor(e){this._delegate=e}static serverTimestamp(){const e=Object(od.fb)();return e._methodName="FieldValue.serverTimestamp",new Id(e)}static delete(){const e=Object(od.C)();return e._methodName="FieldValue.delete",new Id(e)}static arrayUnion(...e){const t=Object(od.w)(...e);return t._methodName="FieldValue.arrayUnion",new Id(t)}static arrayRemove(...e){const t=Object(od.v)(...e);return t._methodName="FieldValue.arrayRemove",new Id(t)}static increment(e){const t=Object(od.T)(e);return t._methodName="FieldValue.increment",new Id(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const Td={Firestore:ud,GeoPoint:od.h,Timestamp:od.k,Blob:ad,Transaction:hd,WriteBatch:dd,DocumentReference:pd,DocumentSnapshot:gd,Query:_d,QueryDocumentSnapshot:md,QuerySnapshot:vd,CollectionReference:wd,FieldPath:bd,FieldValue:Id,setLogLevel:function(e){Object(od.hb)(e)},CACHE_SIZE_UNLIMITED:od.c};!function(e){var t;t=(e,t)=>new ud(e,t,new cd),e.INTERNAL.registerComponent(new ra.a("firestore-compat",(e=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("firestore").getImmediate();return t(n,r)}),"PUBLIC").setServiceProps(Gr({},Td))),e.registerVersion("@firebase/firestore-compat","0.3.14")}(Zo.a);const Ed="type.googleapis.com/google.protobuf.Int64Value",kd="type.googleapis.com/google.protobuf.UInt64Value",Cd="functions",Sd={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Od extends na.c{constructor(e,t,n){super(`${Cd}/${e}`,t||""),this.details=n}}class Ad{constructor(e,t,n){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=t.getImmediate({optional:!0}),this.auth||e.get().then((e=>this.auth=e),(()=>{})),this.messaging||t.get().then((e=>this.messaging=e),(()=>{})),this.appCheck||n.get().then((e=>this.appCheck=e),(()=>{}))}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return null==e?void 0:e.accessToken}catch(e){return}}async getMessagingToken(){if(this.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return await this.messaging.getToken()}catch(e){return}}async getAppCheckToken(e){if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){return{authToken:await this.getAuthToken(),messagingToken:await this.getMessagingToken(),appCheckToken:await this.getAppCheckToken(e)}}}const Nd="us-central1";class Pd{constructor(e,t,n,r,i=Nd,s){this.app=e,this.fetchImpl=s,this.emulatorOrigin=null,this.contextProvider=new Ad(t,n,r),this.cancelAllRequests=new Promise((e=>{this.deleteService=()=>Promise.resolve(e())}));try{const e=new URL(i);this.customDomain=e.origin,this.region=Nd}catch(e){this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;if(null!==this.emulatorOrigin){return`${this.emulatorOrigin}/${t}/${this.region}/${e}`}return null!==this.customDomain?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}const Rd="@firebase/functions",Dd="0.10.0";!function(e,t){Object(ea._registerComponent)(new ra.a(Cd,((t,{instanceIdentifier:n})=>{const r=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),s=t.getProvider("messaging-internal"),o=t.getProvider("app-check-internal");return new Pd(r,i,s,o,n,e)}),"PUBLIC").setMultipleInstances(!0)),Object(ea.registerVersion)(Rd,Dd,t),Object(ea.registerVersion)(Rd,Dd,"esm2017")}(fetch.bind(self));class xd{constructor(e,t){this.app=e,this._delegate=t,this._region=this._delegate.region,this._customDomain=this._delegate.customDomain}httpsCallable(e,t){return function(e,t,n){return si(Object(na.z)(e),t,n)}(this._delegate,e,t)}httpsCallableFromURL(e,t){return ui(this._delegate,e,t)}useFunctionsEmulator(e){const t=e.match("[a-zA-Z]+://([a-zA-Z0-9.-]+)(?::([0-9]+))?");if(null==t)throw new na.c("functions","No origin provided to useFunctionsEmulator()");if(null==t[2])throw new na.c("functions","Port missing in origin provided to useFunctionsEmulator()");return ci(this._delegate,t[1],Number(t[2]))}useEmulator(e,t){return ci(this._delegate,e,t)}}const Md=(e,{instanceIdentifier:t})=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("functions").getImmediate({identifier:null!=t?t:"us-central1"});return new xd(n,r)};!function(){const e={Functions:xd};Zo.a.INTERNAL.registerComponent(new ra.a("functions-compat",Md,"PUBLIC").setServiceProps(e).setMultipleInstances(!0))}(),Zo.a.registerVersion("@firebase/functions-compat","0.3.5");const Ld=(e,t)=>t.some((t=>e instanceof t));let jd,Fd;const Ud=new WeakMap,Vd=new WeakMap,qd=new WeakMap,Bd=new WeakMap,zd=new WeakMap;let Kd={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Vd.get(e);if("objectStoreNames"===t)return e.objectStoreNames||qd.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return di(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};const $d=e=>zd.get(e),Wd=["get","getKey","getAll","getAllKeys","count"],Gd=["put","add","delete","clear"],Hd=new Map;!function(e){Kd=e(Kd)}((e=>pi(pi({},e),{},{get:(t,n,r)=>yi(t,n)||e.get(t,n,r),has:(t,n)=>!!yi(t,n)||e.has(t,n)})));const Qd="/firebase-messaging-sw.js",Yd="/firebase-cloud-messaging-push-scope",Xd="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Jd="https://fcmregistrations.googleapis.com/v1",Zd="google.c.a.c_id",ef="google.c.a.c_l",tf="google.c.a.ts";var nf,rf;!function(e){e[e.DATA_MESSAGE=1]="DATA_MESSAGE",e[e.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"}(nf||(nf={})),function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(rf||(rf={}));const sf="fcm_token_details_db",of=5,af="fcm_token_object_Store",cf="firebase-messaging-database",uf=1,lf="firebase-messaging-store";let hf=null;const df=new na.b("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."}),ff=6048e5;xi("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),xi("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class pf{constructor(e,t,n){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const r=function(e){if(!e||!e.options)throw Mi("App Configuration Object");if(!e.name)throw Mi("App Name");const t=["projectId","apiKey","appId","messagingSenderId"],{options:n}=e;for(const e of t)if(!n[e])throw Mi(e);return{appName:e.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:r,installations:t,analyticsProvider:n}}_delete(){return Promise.resolve()}}const gf="@firebase/messaging",mf="0.12.4",_f=e=>{const t=new pf(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",(e=>Ui(t,e))),t},yf=e=>{const t=e.getProvider("messaging").getImmediate();return{getToken:e=>ji(t,e)}};Object(ea._registerComponent)(new ra.a("messaging",_f,"PUBLIC")),Object(ea._registerComponent)(new ra.a("messaging-internal",yf,"PRIVATE")),Object(ea.registerVersion)(gf,mf),Object(ea.registerVersion)(gf,mf,"esm2017");const vf="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",wf="https://fcmregistrations.googleapis.com/v1",bf="FCM_MSG",If="google.c.a.c_id",Tf=3,Ef=1;var kf,Cf;!function(e){e[e.DATA_MESSAGE=1]="DATA_MESSAGE",e[e.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"}(kf||(kf={})),function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(Cf||(Cf={}));const Sf="fcm_token_details_db",Of=5,Af="fcm_token_object_Store",Nf="firebase-messaging-database",Pf=1,Rf="firebase-messaging-store";let Df=null;const xf=new na.b("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."}),Mf=6048e5;rs("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),rs("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class Lf{constructor(e,t,n){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const r=function(e){if(!e||!e.options)throw as("App Configuration Object");if(!e.name)throw as("App Name");const t=["projectId","apiKey","appId","messagingSenderId"],{options:n}=e;for(const e of t)if(!n[e])throw as(e);return{appName:e.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:r,installations:t,analyticsProvider:n}}_delete(){return Promise.resolve()}}const jf=e=>{const t=new Lf(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return self.addEventListener("push",(e=>{e.waitUntil(is(e,t))})),self.addEventListener("pushsubscriptionchange",(e=>{e.waitUntil(async function(e,t){var n,r;const{newSubscription:i}=e;if(!i)return void await es(t);const s=await Wi(t.firebaseDependencies);await es(t),t.vapidKey=null!==(r=null===(n=null==s?void 0:s.subscriptionOptions)||void 0===n?void 0:n.vapidKey)&&void 0!==r?r:vf,await Zi(t)}(e,t))})),self.addEventListener("notificationclick",(e=>{e.waitUntil(ss(e))})),t};Object(ea._registerComponent)(new ra.a("messaging-sw",jf,"PUBLIC"));class Ff{constructor(e,t){this.app=e,this._delegate=t,this.app=e,this._delegate=t}async getToken(e){return async function(e,t){return ji(e=Object(na.z)(e),t)}(this._delegate,e)}async deleteToken(){return Vi(this._delegate)}onMessage(e){return qi(this._delegate,e)}onBackgroundMessage(e){return cs(this._delegate,e)}}const Uf={isSupported:function(){return self&&"ServiceWorkerGlobalScope"in self?Object(na.G)()&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):"undefined"!=typeof window&&Object(na.G)()&&Object(na.e)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}};Zo.a.INTERNAL.registerComponent(new ra.a("messaging-compat",(e=>self&&"ServiceWorkerGlobalScope"in self?new Ff(e.getProvider("app-compat").getImmediate(),e.getProvider("messaging-sw").getImmediate()):new Ff(e.getProvider("app-compat").getImmediate(),e.getProvider("messaging").getImmediate())),"PUBLIC").setServiceProps(Uf)),Zo.a.registerVersion("@firebase/messaging-compat","0.2.4");const Vf="firebasestorage.googleapis.com",qf="storageBucket";class Bf extends na.c{constructor(e,t,n=0){super(ls(e),`Firebase Storage: ${t} (${ls(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Bf.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return ls(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}var zf,Kf;!function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(zf||(zf={}));class $f{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=$f.makeFromUrl(e,t)}catch(t){return new $f(e,"")}if(""===n.path)return n;throw new Bf(zf.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}static makeFromUrl(e,t){function n(e){e.path_=decodeURIComponent(e.path)}let r=null;const i="([A-Za-z0-9.\\-_]+)",s=new RegExp("^gs://"+i+"(/(.*))?$","i"),o=t.replace(/[.]/g,"\\."),a=[{regex:s,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${o}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:n},{regex:new RegExp(`^https?://${t===Vf?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:n}];for(let t=0;t<a.length;t++){const n=a[t],i=n.regex.exec(e);if(i){let e=i[n.indices.path];e||(e=""),r=new $f(i[n.indices.bucket],e),n.postModify(r);break}}if(null==r)throw function(e){return new Bf(zf.INVALID_URL,"Invalid URL '"+e+"'.")}(e);return r}}class Wf{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(Kf||(Kf={}));class Gf{constructor(e,t,n,r,i,s,o,a,c,u,l,h=!0){this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=s,this.callback_=o,this.errorCallback_=a,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=l,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise(((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()}))}start_(){const e=(e,t)=>{if(t)return void e(!1,new Hf(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const r=e=>{null!==this.progressCallback_&&this.progressCallback_(e.loaded,e.lengthComputable?e.total:-1)};null!==this.progressCallback_&&n.addUploadProgressListener(r),n.send(this.url_,this.method_,this.body_,this.headers_).then((()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(r),this.pendingConnection_=null;const t=n.getErrorCode()===Kf.NO_ERROR,i=n.getStatus();if(!t||Cs(i,this.additionalRetryCodes_)&&this.retry){const t=n.getErrorCode()===Kf.ABORT;return void e(!1,new Hf(!1,null,t))}const s=-1!==this.successCodes_.indexOf(i);e(!0,new Hf(s,n))}))},t=(e,t)=>{const n=this.resolve_,r=this.reject_,i=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(i,i.getResponse());void 0!==e?n(e):n()}catch(e){r(e)}else if(null!==i){const e=hs();e.serverResponse=i.getErrorText(),r(this.errorCallback_?this.errorCallback_(i,e):e)}else if(t.canceled){r(this.appDelete_?ms():fs())}else{r(ds())}};this.canceled_?t(0,new Hf(!1,null,!0)):this.backoffId_=function(e,t,n){function r(){return 2===f}function i(...e){p||(p=!0,t.apply(null,e))}function s(t){l=setTimeout((()=>{l=null,e(a,r())}),t)}function o(){h&&clearTimeout(h)}function a(e,...t){if(p)return void o();if(e)return o(),void i.call(null,e,...t);if(r()||d)return o(),void i.call(null,e,...t);let n;u<64&&(u*=2),1===f?(f=2,n=0):n=1e3*(u+Math.random()),s(n)}function c(e){g||(g=!0,o(),p||(null!==l?(e||(f=2),clearTimeout(l),s(0)):e||(f=1)))}let u=1,l=null,h=null,d=!1,f=0,p=!1,g=!1;return s(0),h=setTimeout((()=>{d=!0,c(!0)}),n),c}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class Hf{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}const Qf={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Yf{constructor(e,t){this.data=e,this.contentType=t||null}}class Xf{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw ys(Qf.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;var r,i;null!=n&&(this.base64=!!((r=n).length>=(i=";base64").length)&&r.substring(r.length-i.length)===i,this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}class Jf{constructor(e,t){let n=0,r="";bs(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(bs(this.data_)){const n=function(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}(this.data_,e,t);return null===n?null:new Jf(n)}{const n=new Uint8Array(this.data_.buffer,e,t-e);return new Jf(n,!0)}}static getBlob(...e){if(Is()){const t=e.map((e=>e instanceof Jf?e.data_:e));return new Jf(Os.apply(null,t))}{const t=e.map((e=>ws(e)?Ns(Qf.RAW,e).data:e.data_));let n=0;t.forEach((e=>{n+=e.byteLength}));const r=new Uint8Array(n);let i=0;return t.forEach((e=>{for(let t=0;t<e.length;t++)r[i++]=e[t]})),new Jf(r,!0)}}uploadData(){return this.data_}}class Zf{constructor(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||Ms}}let ep=null;const tp="prefixes",np="items";class rp{constructor(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}class ip{constructor(e,t,n,r){this.current=e,this.total=t,this.finalized=!!n,this.metadata=r||null}}const sp=262144,op={STATE_CHANGED:"state_changed"},ap={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};class cp{constructor(e,t,n){if("function"==typeof e||null!=t||null!=n)this.next=e,this.error=null!=t?t:void 0,this.complete=null!=n?n:void 0;else{const t=e;this.next=t.next,this.error=t.error,this.complete=t.complete}}}let up=null;class lp{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Kf.NO_ERROR,this.sendPromise_=new Promise((e=>{this.xhr_.addEventListener("abort",(()=>{this.errorCode_=Kf.ABORT,e()})),this.xhr_.addEventListener("error",(()=>{this.errorCode_=Kf.NETWORK_ERROR,e()})),this.xhr_.addEventListener("load",(()=>{e()}))}))}send(e,t,n,r){if(this.sent_)throw vs("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(const e in r)r.hasOwnProperty(e)&&this.xhr_.setRequestHeader(e,r[e].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw vs("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw vs("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}getResponse(){if(!this.sent_)throw vs("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw vs("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class hp extends lp{initXhr(){this.xhr_.responseType="text"}}class dp{constructor(e,t,n=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=n,this._mappings=Ls(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=e=>{if(this._request=void 0,this._chunkMultiplier=1,e._codeEquals(zf.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const t=this.isExponentialBackoffExpired();if(Cs(e.status,[])){if(!t)return this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,void this.completeTransitions_();e=ds()}this._error=e,this._transition("error")}},this._metadataErrorHandler=e=>{this._request=void 0,e._codeEquals(zf.CANCELED)?this.completeTransitions_():(this._error=e,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t,this._start()})),this._promise.then(null,(()=>{}))}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout((()=>{this.pendingTimeout=void 0,this._continueUpload()}),this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then((([t,n])=>{switch(this._state){case"running":e(t,n);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}}))}_createResumable(){this._resolveToken(((e,t)=>{const n=function(e,t,n,r,i){const s=t.bucketOnlyServerUrl(),o=Hs(t,r,i),a={name:o.fullPath},c=Es(s,e.host,e._protocol),u={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},l=Us(o,n),h=new rp(c,"POST",(function(e){let t;Ys(e);try{t=e.getResponseHeader("X-Goog-Upload-URL")}catch(e){qs(!1)}return qs(ws(t)),t}),e.maxUploadRetryTime);return h.urlParams=a,h.headers=u,h.body=l,h.errorHandler=Ks(t),h}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(n,eo,e,t);this._request=r,r.getPromise().then((e=>{this._request=void 0,this._uploadUrl=e,this._needToFetchStatus=!1,this.completeTransitions_()}),this._errorHandler)}))}_fetchStatus(){const e=this._uploadUrl;this._resolveToken(((t,n)=>{const r=function(e,t,n,r){const i=new rp(n,"POST",(function(e){const t=Ys(e,["active","final"]);let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Size-Received")}catch(e){qs(!1)}n||qs(!1);const i=Number(n);return qs(!isNaN(i)),new ip(i,r.size(),"final"===t)}),e.maxUploadRetryTime);return i.headers={"X-Goog-Upload-Command":"query"},i.errorHandler=Ks(t),i}(this._ref.storage,this._ref._location,e,this._blob),i=this._ref.storage._makeRequest(r,eo,t,n);this._request=i,i.getPromise().then((e=>{this._request=void 0,this._updateProgress(e.current),this._needToFetchStatus=!1,e.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()}),this._errorHandler)}))}_continueUpload(){const e=sp*this._chunkMultiplier,t=new ip(this._transferred,this._blob.size()),n=this._uploadUrl;this._resolveToken(((r,i)=>{let s;try{s=Xs(this._ref._location,this._ref.storage,n,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(e){return this._error=e,void this._transition("error")}const o=this._ref.storage._makeRequest(s,eo,r,i,!1);this._request=o,o.getPromise().then((e=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(e.current),e.finalized?(this._metadata=e.metadata,this._transition("success")):this.completeTransitions_()}),this._errorHandler)}))}_increaseMultiplier(){2*(sp*this._chunkMultiplier)<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken(((e,t)=>{const n=Ws(this._ref.storage,this._ref._location,this._mappings),r=this._ref.storage._makeRequest(n,eo,e,t);this._request=r,r.getPromise().then((e=>{this._request=void 0,this._metadata=e,this._transition("success")}),this._metadataErrorHandler)}))}_oneShotUpload(){this._resolveToken(((e,t)=>{const n=Qs(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(n,eo,e,t);this._request=r,r.getPromise().then((e=>{this._request=void 0,this._metadata=e,this._updateProgress(this._blob.size()),this._transition("success")}),this._errorHandler)}))}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=fs(),this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=Js(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,n,r){const i=new cp(t||void 0,n||void 0,r||void 0);return this._addObserver(i),()=>{this._removeObserver(i)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise();this._observers.slice().forEach((e=>{this._notifyObserver(e)}))}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(Js(this._state)){case ap.SUCCESS:Zs(this._resolve.bind(null,this.snapshot))();break;case ap.CANCELED:case ap.ERROR:Zs(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(Js(this._state)){case ap.RUNNING:case ap.PAUSED:e.next&&Zs(e.next.bind(e,this.snapshot))();break;case ap.SUCCESS:e.complete&&Zs(e.complete.bind(e))();break;default:e.error&&Zs(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}class fp{constructor(e,t){this._service=e,this._location=t instanceof $f?t:$f.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new fp(e,t)}get root(){const e=new $f(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return xs(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new $f(this._location.bucket,e);return new fp(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw _s(e)}}class pp{constructor(e,t,n,r,i){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=i,this._bucket=null,this._host=Vf,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?$f.makeFromBucketSpec(r,this._host):lo(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._bucket=null!=this._url?$f.makeFromBucketSpec(this._url,e):lo(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Ts("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Ts("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach((e=>e.cancel())),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new fp(this,e)}_makeRequest(e,t,n,r,i=!0){if(this._deleted)return new Wf(ms());{const s=function(e,t,n,r,i,s,o=!0){const a=ks(e.urlParams),c=e.url+a,u=us({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(u,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(u,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!=t?t:"AppManager")}(u,s),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(u,r),new Gf(c,e.method,u,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i,o)}(e,this._appId,n,r,t,this._firebaseVersion,i);return this._requests.add(s),s.getPromise().then((()=>this._requests.delete(s)),(()=>this._requests.delete(s))),s}}async makeRequestWithTokens(e,t){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}const gp="@firebase/storage",mp="0.11.2",_p="storage";Object(ea._registerComponent)(new ra.a(_p,mo,"PUBLIC").setMultipleInstances(!0)),Object(ea.registerVersion)(gp,mp,""),Object(ea.registerVersion)(gp,mp,"esm2017");class yp{constructor(e,t,n){this._delegate=e,this.task=t,this.ref=n}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class vp{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new yp(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then((t=>{if(e)return e(new yp(t,this,this._ref))}),t)}on(e,t,n,r){let i;return t&&(i="function"==typeof t?e=>t(new yp(e,this,this._ref)):{next:t.next?e=>t.next(new yp(e,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,i,n||void 0,r||void 0)}}class wp{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map((e=>new bp(e,this._service)))}get items(){return this._delegate.items.map((e=>new bp(e,this._service)))}get nextPageToken(){return this._delegate.nextPageToken||null}}class bp{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const t=function(e,t){return ao(e,t)}(this._delegate,e);return new bp(t,this.storage)}get root(){return new bp(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return null==e?null:new bp(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new vp(ho(this._delegate,e,t),this)}putString(e,t=Qf.RAW,n){this._throwIfRoot("putString");const r=Ns(t,e),i=_o({},n);return null==i.contentType&&null!=r.contentType&&(i.contentType=r.contentType),new vp(new dp(this._delegate,new Jf(r.data,!0),i),this)}listAll(){return(e=this._delegate,to(e=Object(na.z)(e))).then((e=>new wp(e,this.storage)));var e}list(e){return function(e,t){return ro(e=Object(na.z)(e),t)}(this._delegate,e||void 0).then((e=>new wp(e,this.storage)))}getMetadata(){return fo(this._delegate)}updateMetadata(e){return function(e,t){return io(e=Object(na.z)(e),t)}(this._delegate,e)}getDownloadURL(){return e=this._delegate,so(e=Object(na.z)(e));var e}delete(){return this._throwIfRoot("delete"),e=this._delegate,oo(e=Object(na.z)(e));var e}_throwIfRoot(e){if(""===this._delegate._location.path)throw _s(e)}}class Ip{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(yo(e))throw gs("ref() expected a child path but got a URL, use refFromURL instead.");return new bp(po(this._delegate,e),this)}refFromURL(e){if(!yo(e))throw gs("refFromURL() expected a full URL but got a child path, use ref() instead.");try{$f.makeFromUrl(e,this._delegate.host)}catch(e){throw gs("refFromUrl() expected a valid full URL but got an invalid one.")}return new bp(po(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,n={}){go(this._delegate,e,t,n)}}!function(e){const t={TaskState:ap,TaskEvent:op,StringFormat:Qf,Storage:Ip,Reference:bp};e.INTERNAL.registerComponent(new ra.a("storage-compat",vo,"PUBLIC").setServiceProps(t).setMultipleInstances(!0)),e.registerVersion("@firebase/storage-compat","0.3.2")}(Zo.a);const Tp="@firebase/performance",Ep="0.6.4",kp=Ep,Cp="FB-PERF-TRACE-MEASURE",Sp="_wt_",Op="_fcp",Ap="_fid",Np="@firebase/performance/config",Pp="@firebase/performance/configexpire",Rp="Performance",Dp=new na.b("performance",Rp,{"trace started":"Trace {$traceName} was started before.","trace stopped":"Trace {$traceName} is not running.","nonpositive trace startTime":"Trace {$traceName} startTime should be positive.","nonpositive trace duration":"Trace {$traceName} duration should be positive.","no window":"Window is not available.","no app id":"App id is not available.","no project id":"Project id is not available.","no api key":"Api key is not available.","invalid cc log":"Attempted to queue invalid cc event","FB not default":"Performance can only start when Firebase app instance is the default one.","RC response not ok":"RC response is not ok","invalid attribute name":"Attribute name {$attributeName} is invalid.","invalid attribute value":"Attribute value {$attributeValue} is invalid.","invalid custom metric name":"Custom metric name {$customMetricName} is invalid","invalid String merger input":"Input for String merger is invalid, contact support team to resolve.","already initialized":"initializePerformance() has already been called with different options. To avoid this error, call initializePerformance() with the same options as when it was originally called, or call getPerformance() to return the already initialized instance."}),xp=new ta.b(Rp);let Mp,Lp,jp,Fp;xp.logLevel=ta.a.INFO;class Up{constructor(e){if(this.window=e,!e)throw Dp.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=e.localStorage),e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay)}getUrl(){return this.windowLocation.href.split("?")[0]}mark(e){this.performance&&this.performance.mark&&this.performance.mark(e)}measure(e,t,n){this.performance&&this.performance.measure&&this.performance.measure(e,t,n)}getEntriesByType(e){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(e):[]}getEntriesByName(e){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(e):[]}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return fetch&&Promise&&Object(na.e)()?!!Object(na.G)()||(xp.info("IndexedDB is not supported by current browswer"),!1):(xp.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)}setupObserver(e,t){if(!this.PerformanceObserver)return;const n=new this.PerformanceObserver((e=>{for(const n of e.getEntries())t(n)}));n.observe({entryTypes:[e]})}static getInstance(){return void 0===Mp&&(Mp=new Up(Lp)),Mp}}class Vp{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=Io("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=Io("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return void 0===Fp&&(Fp=new Vp),Fp}}var qp;!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.VISIBLE=1]="VISIBLE",e[e.HIDDEN=2]="HIDDEN"}(qp||(qp={}));const Bp=["firebase_","google_","ga_"],zp=new RegExp("^[a-zA-Z]\\w*$"),Kp="0.0.1",$p={loggingEnabled:!0},Wp="FIREBASE_INSTALLATIONS_AUTH",Gp="Could not fetch config, will use default configs";let Hp,Qp=1;const Yp=1e4,Xp=3,Jp=1e3;let Zp,eg=Xp,tg=[],ng=!1;const rg=["_fp",Op,Ap];class ig{constructor(e,t,n=!1,r){this.performanceController=e,this.name=t,this.isAuto=n,this.state=1,this.customAttributes={},this.counters={},this.api=Up.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark=`FB-PERF-TRACE-START-${this.randomId}-${this.name}`,this.traceStopMark=`FB-PERF-TRACE-STOP-${this.randomId}-${this.name}`,this.traceMeasure=r||`${Cp}-${this.randomId}-${this.name}`,r&&this.calculateTraceMetrics())}start(){if(1!==this.state)throw Dp.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(2!==this.state)throw Dp.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),Mo(this)}record(e,t,n){if(e<=0)throw Dp.create("nonpositive trace startTime",{traceName:this.name});if(t<=0)throw Dp.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*t),this.startTimeUs=Math.floor(1e3*e),n&&n.attributes&&(this.customAttributes=wo({},n.attributes)),n&&n.metrics)for(const e of Object.keys(n.metrics))isNaN(Number(n.metrics[e]))||(this.counters[e]=Math.floor(Number(n.metrics[e])));Mo(this)}incrementMetric(e,t=1){this.putMetric(e,void 0===this.counters[e]?t:this.counters[e]+t)}putMetric(e,t){if(r=this.name,0===(n=e).length||n.length>100||!(r&&r.startsWith(Sp)&&rg.indexOf(n)>-1)&&n.startsWith("_"))throw Dp.create("invalid custom metric name",{customMetricName:e});var n,r;this.counters[e]=function(e){const t=Math.floor(e);return t<e&&xp.info(`Metric value should be an Integer, setting the value as : ${t}.`),t}(null!=t?t:0)}getMetric(e){return this.counters[e]||0}putAttribute(e,t){const n=!(0===(r=e).length||r.length>40||Bp.some((e=>r.startsWith(e)))||!r.match(zp));var r;const i=function(e){return 0!==e.length&&e.length<=100}(t);if(n&&i)this.customAttributes[e]=t;else{if(!n)throw Dp.create("invalid attribute name",{attributeName:e});if(!i)throw Dp.create("invalid attribute value",{attributeValue:t})}}getAttribute(e){return this.customAttributes[e]}removeAttribute(e){void 0!==this.customAttributes[e]&&delete this.customAttributes[e]}getAttributes(){return wo({},this.customAttributes)}setStartTime(e){this.startTimeUs=e}setDuration(e){this.durationUs=e}calculateTraceMetrics(){const e=this.api.getEntriesByName(this.traceMeasure),t=e&&e[0];t&&(this.durationUs=Math.floor(1e3*t.duration),this.startTimeUs=Math.floor(1e3*(t.startTime+this.api.getTimeOrigin())))}static createOobTrace(e,t,n,r){const i=Up.getInstance().getUrl();if(!i)return;const s=new ig(e,Sp+i,!0),o=Math.floor(1e3*Up.getInstance().getTimeOrigin());s.setStartTime(o),t&&t[0]&&(s.setDuration(Math.floor(1e3*t[0].duration)),s.putMetric("domInteractive",Math.floor(1e3*t[0].domInteractive)),s.putMetric("domContentLoadedEventEnd",Math.floor(1e3*t[0].domContentLoadedEventEnd)),s.putMetric("loadEventEnd",Math.floor(1e3*t[0].loadEventEnd)));if(n){const e=n.find((e=>"first-paint"===e.name));e&&e.startTime&&s.putMetric("_fp",Math.floor(1e3*e.startTime));const t=n.find((e=>"first-contentful-paint"===e.name));t&&t.startTime&&s.putMetric(Op,Math.floor(1e3*t.startTime)),r&&s.putMetric(Ap,Math.floor(1e3*r))}Mo(s)}static createUserTimingTrace(e,t){Mo(new ig(e,t,!1,t))}}const sg=5e3;class og{constructor(e,t){this.app=e,this.installations=t,this.initialized=!1}_init(e){this.initialized||(void 0!==(null==e?void 0:e.dataCollectionEnabled)&&(this.dataCollectionEnabled=e.dataCollectionEnabled),void 0!==(null==e?void 0:e.instrumentationEnabled)&&(this.instrumentationEnabled=e.instrumentationEnabled),Up.getInstance().requiredApisAvailable()?Object(na.ab)().then((e=>{e&&(ng||(Ro(5500),ng=!0),No(this).then((()=>Vo(this)),(()=>Vo(this))),this.initialized=!0)})).catch((e=>{xp.info(`Environment doesn't support IndexedDB: ${e}`)})):xp.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(e){Vp.getInstance().instrumentationEnabled=e}get instrumentationEnabled(){return Vp.getInstance().instrumentationEnabled}set dataCollectionEnabled(e){Vp.getInstance().dataCollectionEnabled=e}get dataCollectionEnabled(){return Vp.getInstance().dataCollectionEnabled}}const ag=(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();if("[DEFAULT]"!==n.name)throw Dp.create("FB not default");if("undefined"==typeof window)throw Dp.create("no window");!function(e){Lp=e}(window);const i=new og(n,r);return i._init(t),i};Object(ea._registerComponent)(new ra.a("performance",ag,"PUBLIC")),Object(ea.registerVersion)(Tp,Ep),Object(ea.registerVersion)(Tp,Ep,"esm2017");class cg{constructor(e,t){this.app=e,this._delegate=t}get instrumentationEnabled(){return this._delegate.instrumentationEnabled}set instrumentationEnabled(e){this._delegate.instrumentationEnabled=e}get dataCollectionEnabled(){return this._delegate.dataCollectionEnabled}set dataCollectionEnabled(e){this._delegate.dataCollectionEnabled=e}trace(e){return t=this._delegate,n=e,t=Object(na.z)(t),new ig(t,n);var t,n}}var ug;(ug=Zo.a).INTERNAL.registerComponent(new ra.a("performance-compat",Bo,"PUBLIC")),ug.registerVersion("@firebase/performance-compat","0.2.4");const lg="@firebase/remote-config",hg="0.4.4";class dg{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}const fg="remote-config",pg=new na.b("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"}),gg=["1","true","t","yes","y","on"];class mg{constructor(e,t=""){this._source=e,this._value=t}asString(){return this._value}asBoolean(){return"static"!==this._source&&gg.indexOf(this._value.toLowerCase())>=0}asNumber(){if("static"===this._source)return 0;let e=Number(this._value);return isNaN(e)&&(e=0),e}getSource(){return this._source}}class _g{constructor(e,t,n,r){this.client=e,this.storage=t,this.storageCache=n,this.logger=r}isCachedDataFresh(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const n=Date.now()-t,r=n<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${n}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${r}.`),r}async fetch(e){const[t,n]=await Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()]);if(n&&this.isCachedDataFresh(e.cacheMaxAgeMillis,t))return n;e.eTag=n&&n.eTag;const r=await this.client.fetch(e),i=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===r.status&&i.push(this.storage.setLastSuccessfulFetchResponse(r)),await Promise.all(i),r}}class yg{constructor(e,t,n,r,i,s){this.firebaseInstallations=e,this.sdkVersion=t,this.namespace=n,this.projectId=r,this.apiKey=i,this.appId=s}async fetch(e){const[t,n]=await Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()]),r=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${this.projectId}/namespaces/${this.namespace}:fetch?key=${this.apiKey}`,i={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},s={sdk_version:this.sdkVersion,app_instance_id:t,app_instance_id_token:n,app_id:this.appId,language_code:Qo()},o={method:"POST",headers:i,body:JSON.stringify(s)},a=fetch(r,o),c=new Promise(((t,n)=>{e.signal.addEventListener((()=>{const e=new Error("The operation was aborted.");e.name="AbortError",n(e)}))}));let u;try{await Promise.race([a,c]),u=await a}catch(e){let t="fetch-client-network";throw"AbortError"===(null==e?void 0:e.name)&&(t="fetch-timeout"),pg.create(t,{originalErrorMessage:null==e?void 0:e.message})}let l=u.status;const h=u.headers.get("ETag")||void 0;let d,f;if(200===u.status){let e;try{e=await u.json()}catch(e){throw pg.create("fetch-client-parse",{originalErrorMessage:null==e?void 0:e.message})}d=e.entries,f=e.state}if("INSTANCE_STATE_UNSPECIFIED"===f?l=500:"NO_CHANGE"===f?l=304:"NO_TEMPLATE"!==f&&"EMPTY_CONFIG"!==f||(d={}),304!==l&&200!==l)throw pg.create("fetch-status",{httpStatus:l});return{status:l,eTag:h,config:d}}}class vg{constructor(e,t){this.client=e,this.storage=t}async fetch(e){const t=await this.storage.getThrottleMetadata()||{backoffCount:0,throttleEndTimeMillis:Date.now()};return this.attemptFetch(e,t)}async attemptFetch(e,{throttleEndTimeMillis:t,backoffCount:n}){await function(e,t){return new Promise(((n,r)=>{const i=Math.max(t-Date.now(),0),s=setTimeout(n,i);e.addEventListener((()=>{clearTimeout(s),r(pg.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(e.signal,t);try{const t=await this.client.fetch(e);return await this.storage.deleteThrottleMetadata(),t}catch(t){if(!function(e){if(!(e instanceof na.c&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(t))throw t;const r={throttleEndTimeMillis:Date.now()+Object(na.l)(n),backoffCount:n+1};return await this.storage.setThrottleMetadata(r),this.attemptFetch(e,r)}}}class wg{constructor(e,t,n,r,i){this.app=e,this._client=t,this._storageCache=n,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}const bg="app_namespace_store";class Ig{constructor(e,t,n,r=function(){return new Promise(((e,t)=>{try{const n=indexedDB.open("firebase_remote_config",1);n.onerror=e=>{t(Yo(e,"storage-open"))},n.onsuccess=t=>{e(t.target.result)},n.onupgradeneeded=e=>{0===e.oldVersion&&e.target.result.createObjectStore(bg,{keyPath:"compositeKey"})}}catch(e){t(pg.create("storage-open",{originalErrorMessage:null==e?void 0:e.message}))}}))}()){this.appId=e,this.appName=t,this.namespace=n,this.openDbPromise=r}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}async get(e){const t=await this.openDbPromise;return new Promise(((n,r)=>{const i=t.transaction([bg],"readonly").objectStore(bg),s=this.createCompositeKey(e);try{const e=i.get(s);e.onerror=e=>{r(Yo(e,"storage-get"))},e.onsuccess=e=>{const t=e.target.result;n(t?t.value:void 0)}}catch(e){r(pg.create("storage-get",{originalErrorMessage:null==e?void 0:e.message}))}}))}async set(e,t){const n=await this.openDbPromise;return new Promise(((r,i)=>{const s=n.transaction([bg],"readwrite").objectStore(bg),o=this.createCompositeKey(e);try{const e=s.put({compositeKey:o,value:t});e.onerror=e=>{i(Yo(e,"storage-set"))},e.onsuccess=()=>{r()}}catch(e){i(pg.create("storage-set",{originalErrorMessage:null==e?void 0:e.message}))}}))}async delete(e){const t=await this.openDbPromise;return new Promise(((n,r)=>{const i=t.transaction([bg],"readwrite").objectStore(bg),s=this.createCompositeKey(e);try{const e=i.delete(s);e.onerror=e=>{r(Yo(e,"storage-delete"))},e.onsuccess=()=>{n()}}catch(e){r(pg.create("storage-delete",{originalErrorMessage:null==e?void 0:e.message}))}}))}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}}class Tg{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}async loadFromStorage(){const e=this.storage.getLastFetchStatus(),t=this.storage.getLastSuccessfulFetchTimestampMillis(),n=this.storage.getActiveConfig(),r=await e;r&&(this.lastFetchStatus=r);const i=await t;i&&(this.lastSuccessfulFetchTimestampMillis=i);const s=await n;s&&(this.activeConfig=s)}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}Object(ea._registerComponent)(new ra.a(fg,(function(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();if("undefined"==typeof window)throw pg.create("registration-window");if(!Object(na.G)())throw pg.create("indexed-db-unavailable");const{projectId:i,apiKey:s,appId:o}=n.options;if(!i)throw pg.create("registration-project-id");if(!s)throw pg.create("registration-api-key");if(!o)throw pg.create("registration-app-id");const a=new Ig(o,n.name,t=t||"firebase"),c=new Tg(a),u=new ta.b(lg);u.logLevel=ta.a.ERROR;const l=new yg(r,ea.SDK_VERSION,t,i,s,o),h=new vg(l,a),d=new _g(h,a,c,u),f=new wg(n,d,c,a,u);return $o(f),f}),"PUBLIC").setMultipleInstances(!0)),Object(ea.registerVersion)(lg,hg),Object(ea.registerVersion)(lg,hg,"esm2017");class Eg{constructor(e,t){this.app=e,this._delegate=t}get defaultConfig(){return this._delegate.defaultConfig}set defaultConfig(e){this._delegate.defaultConfig=e}get fetchTimeMillis(){return this._delegate.fetchTimeMillis}get lastFetchStatus(){return this._delegate.lastFetchStatus}get settings(){return this._delegate.settings}set settings(e){this._delegate.settings=e}activate(){return Ko(this._delegate)}ensureInitialized(){return $o(this._delegate)}fetch(){return Wo(this._delegate)}fetchAndActivate(){return async function(e){return e=Object(na.z)(e),await Wo(e),Ko(e)}(this._delegate)}getAll(){return Go(this._delegate)}getBoolean(e){return function(e,t){return Ho(Object(na.z)(e),t).asBoolean()}(this._delegate,e)}getNumber(e){return function(e,t){return Ho(Object(na.z)(e),t).asNumber()}(this._delegate,e)}getString(e){return function(e,t){return Ho(Object(na.z)(e),t).asString()}(this._delegate,e)}getValue(e){return Ho(this._delegate,e)}setLogLevel(e){!function(e,t){const n=Object(na.z)(e);switch(t){case"debug":n._logger.logLevel=ta.a.DEBUG;break;case"silent":n._logger.logLevel=ta.a.SILENT;break;default:n._logger.logLevel=ta.a.ERROR}}(this._delegate,e)}}!function(e){e.INTERNAL.registerComponent(new ra.a("remoteConfig-compat",Jo,"PUBLIC").setMultipleInstances(!0).setServiceProps({isSupported:Xo})),e.registerVersion("@firebase/remote-config-compat","0.2.4")}(Zo.a);Zo.a.registerVersion("firebase","10.1.0","app-compat");console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the module builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nCommonJS Modules:\nconst firebase = require('firebase/app');\nrequire('firebase/<PACKAGE>');\n\nES Modules:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n\nTypescript:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n"),Zo.a.registerVersion("firebase","10.1.0","compat")},xsHj:function(e,t,n){"use strict";function r(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(x||(x=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(q(this),t),s(M.get(this))}:function(...t){return s(e.apply(q(this),t))}:function(t,...n){const r=e.call(q(this),t,...n);return j.set(r,t.sort?t.sort():[t]),s(r)}}function i(e){return"function"==typeof e?r(e):(e instanceof IDBTransaction&&function(e){if(L.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)}));L.set(e,t)}(e),R(e,D||(D=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,V):e)}function s(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",o)},i=()=>{t(s(e.result)),r()},o=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",o)}));return t.then((t=>{t instanceof IDBCursor&&M.set(t,e)})).catch((()=>{})),U.set(t,e),t}(e);if(F.has(e))return F.get(e);const t=i(e);return t!==e&&(F.set(e,t),U.set(t,e)),t}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(K.get(t))return K.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=z.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!B.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,i?"readwrite":"readonly");let o=s.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),i&&s.done]))[0]};return K.set(t,s),s}function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(this,arguments)}function h(e,t){try{e.container.addComponent(t)}catch(n){H.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function d(e,t){e.container.addOrOverwriteComponent(t)}function f(e){const t=e.name;if(J.has(t))return H.debug(`There were multiple attempts to register component ${t}.`),!1;J.set(t,e);for(const t of X.values())h(t,e);return!0}function p(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function g(e,t,n=Q){p(e,t).clearInstance(n)}function m(){J.clear()}function _(e,t={}){let n=e;if("object"!=typeof t){t={name:t}}const r=l({name:Q,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!=typeof i||!i)throw Z.create("bad-app-name",{appName:String(i)});if(n||(n=Object(P.u)()),!n)throw Z.create("no-options");const s=X.get(i);if(s){if(Object(P.q)(n,s.options)&&Object(P.q)(r,s.config))return s;throw Z.create("duplicate-app",{appName:i})}const o=new A.b(i);for(const e of J.values())o.addComponent(e);const a=new ee(n,r,o);return X.set(i,a),a}function y(e=Q){const t=X.get(e);if(!t&&e===Q&&Object(P.u)())return _();if(!t)throw Z.create("no-app",{appName:e});return t}function v(){return Array.from(X.values())}async function w(e){const t=e.name;X.has(t)&&(X.delete(t),await Promise.all(e.container.getProviders().map((e=>e.delete()))),e.isDeleted=!0)}function b(e,t,n){var r;let i=null!==(r=Y[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${i}" with version "${t}":`];return s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void H.warn(e.join(" "))}f(new A.a(`${i}-version`,(()=>({library:i,version:t})),"VERSION"))}function I(e,t){if(null!==e&&"function"!=typeof e)throw Z.create("invalid-log-argument");Object(N.d)(e,t)}function T(e){Object(N.c)(e)}function E(){return se||(se=function(e,t,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){const a=indexedDB.open(e,t),c=s(a);return r&&a.addEventListener("upgradeneeded",(e=>{r(s(a.result),e.oldVersion,e.newVersion,s(a.transaction),e)})),n&&a.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),c.then((e=>{o&&e.addEventListener("close",(()=>o())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),c}(ne,re,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(ie)}}).catch((e=>{throw Z.create("idb-open",{originalErrorMessage:e.message})}))),se}async function k(e,t){try{const n=(await E()).transaction(ie,"readwrite"),r=n.objectStore(ie);await r.put(t,C(e)),await n.done}catch(e){if(e instanceof P.c)H.warn(e.message);else{const t=Z.create("idb-set",{originalErrorMessage:null==e?void 0:e.message});H.warn(t.message)}}}function C(e){return`${e.name}!${e.options.appId}`}function S(){return(new Date).toISOString().substring(0,10)}function O(e){return Object(P.k)(JSON.stringify({version:2,heartbeats:e})).length}n.r(t),n.d(t,"FirebaseError",(function(){return P.c})),n.d(t,"SDK_VERSION",(function(){return te})),n.d(t,"_DEFAULT_ENTRY_NAME",(function(){return Q})),n.d(t,"_addComponent",(function(){return h})),n.d(t,"_addOrOverwriteComponent",(function(){return d})),n.d(t,"_apps",(function(){return X})),n.d(t,"_clearComponents",(function(){return m})),n.d(t,"_components",(function(){return J})),n.d(t,"_getProvider",(function(){return p})),n.d(t,"_registerComponent",(function(){return f})),n.d(t,"_removeServiceInstance",(function(){return g})),n.d(t,"deleteApp",(function(){return w})),n.d(t,"getApp",(function(){return y})),n.d(t,"getApps",(function(){return v})),n.d(t,"initializeApp",(function(){return _})),n.d(t,"onLog",(function(){return I})),n.d(t,"registerVersion",(function(){return b})),n.d(t,"setLogLevel",(function(){return T}));var A=n("SgqZ"),N=n("li6C"),P=n("8HXZ");const R=(e,t)=>t.some((t=>e instanceof t));let D,x;const M=new WeakMap,L=new WeakMap,j=new WeakMap,F=new WeakMap,U=new WeakMap;let V={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return L.get(e);if("objectStoreNames"===t)return e.objectStoreNames||j.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return s(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};const q=e=>U.get(e),B=["get","getKey","getAll","getAllKeys","count"],z=["put","add","delete","clear"],K=new Map;V=(e=>a(a({},e),{},{get:(t,n,r)=>u(t,n)||e.get(t,n,r),has:(t,n)=>!!u(t,n)||e.has(t,n)}))(V);class ${constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const W="@firebase/app",G="0.9.15",H=new N.b("@firebase/app"),Q="[DEFAULT]",Y={[W]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},X=new Map,J=new Map,Z=new P.b("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class ee{constructor(e,t,n){this._isDeleted=!1,this._options=l({},e),this._config=l({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new A.a("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Z.create("app-deleted",{appName:this._name})}}const te="10.1.0",ne="firebase-heartbeat-database",re=1,ie="firebase-heartbeat-store";let se=null;class oe{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new ae(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=S();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==t&&!this._heartbeatsCache.heartbeats.some((e=>e.date===t)))return this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const e=S(),{heartbeatsToSend:t,unsentEntries:n}=function(e,t=1024){const n=[];let r=e.slice();for(const i of e){const e=n.find((e=>e.agent===i.agent));if(e){if(e.dates.push(i.date),O(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),O(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),r=Object(P.k)(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}class ae{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!Object(P.G)()&&Object(P.ab)().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){return await async function(e){try{const t=await E();return await t.transaction(ie).objectStore(ie).get(C(e))}catch(e){if(e instanceof P.c)H.warn(e.message);else{const t=Z.create("idb-get",{originalErrorMessage:null==e?void 0:e.message});H.warn(t.message)}}}(this.app)||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return k(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return k(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}var ce;ce="",f(new A.a("platform-logger",(e=>new $(e)),"PRIVATE")),f(new A.a("heartbeat",(e=>new oe(e)),"PRIVATE")),b(W,G,ce),b(W,G,"esm2017"),b("fire-js","")},zaJb:function(e,t,n){"use strict";function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function i(){return Ro.logLevel}function s(e){Ro.setLogLevel(e)}function o(e,...t){if(Ro.logLevel<=Co.a.DEBUG){const n=t.map(u);Ro.debug(`Firestore (${Po}): ${e}`,...n)}}function a(e,...t){if(Ro.logLevel<=Co.a.ERROR){const n=t.map(u);Ro.error(`Firestore (${Po}): ${e}`,...n)}}function c(e,...t){if(Ro.logLevel<=Co.a.WARN){const n=t.map(u);Ro.warn(`Firestore (${Po}): ${e}`,...n)}}function u(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function l(e="Unexpected state"){const t=`FIRESTORE (${Po}) INTERNAL ASSERTION FAILED: `+e;throw a(t),new Error(t)}function h(e){e||l()}function d(e){e||l()}function f(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}function p(e,t){return e<t?-1:e>t?1:0}function g(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}function m(e){return e+"\0"}function _(e){return e.fields.find((e=>2===e.kind))}function y(e){return e.fields.filter((e=>2!==e.kind))}function v(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=Wo.fromTimestamp(1e9===r?new $o(n+1,0):new $o(n,r));return new ta(i,Xo.empty(),t)}function w(e){return new ta(e.readTime,e.key,-1)}function b(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=Xo.comparator(e.documentKey,t.documentKey),0!==n?n:p(e.largestBatchId,t.largestBatchId))}async function I(e){if(e.code!==Do.FAILED_PRECONDITION||e.message!==na)throw e;o("LocalStore","Unexpectedly lost primary lease")}function T(e){return"IndexedDbTransactionError"===e.name}function E(e){return new ia(((t,n)=>{e.onsuccess=e=>{t(e.target.result)},e.onerror=e=>{const t=k(e.target.error);n(t)}}))}function k(e){const t=oa.D(Object(So.A)());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new xo("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return la||(la=!0,setTimeout((()=>{throw e}),0)),e}}return e}function C(e){return null==e}function S(e){return 0===e&&1/e==-1/0}function O(e){return"number"==typeof e&&Number.isInteger(e)&&!S(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}function A(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=P(t)),t=N(e.get(n),t);return P(t)}function N(e,t){let n=t;const r=e.length;for(let t=0;t<r;t++){const r=e.charAt(t);switch(r){case"\0":n+="";break;case"":n+="";break;default:n+=r}}return n}function P(e){return e+""}function R(e){const t=e.length;if(h(t>=2),2===t)return h(""===e.charAt(0)&&""===e.charAt(1)),Ho.emptyPath();const n=t-2,r=[];let i="";for(let s=0;s<t;){const t=e.indexOf("",s);switch((t<0||t>n)&&l(),e.charAt(t+1)){case"":const n=e.substring(s,t);let o;0===i.length?o=n:(i+=n,o=i,i=""),r.push(o);break;case"":i+=e.substring(s,t),i+="\0";break;case"":i+=e.substring(s,t+1);break;default:l()}s=t+2}return new Ho(r)}function D(e,t){return[e,A(t)]}function x(e,t,n){return[e,A(t),n]}function M(e,t){return oa.O(e.ue,t)}function L(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function j(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function F(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function U(e){return e.hasNext()?e.getNext():void 0}function V(){return"undefined"!=typeof atob}function q(e){if(h(!!e),"string"==typeof e){let t=0;const n=Ka.exec(e);if(h(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:B(e.seconds),nanos:B(e.nanos)}}function B(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function z(e){return"string"==typeof e?za.fromBase64String(e):za.fromUint8Array(e)}function K(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function $(e){const t=e.mapValue.fields.__previous_value__;return K(t)?$(t):t}function W(e){const t=q(e.mapValue.fields.__local_write_time__.timestampValue);return new $o(t.seconds,t.nanos)}function G(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?K(e)?4:ae(e)?9007199254740991:10:l()}function H(e,t){if(e===t)return!0;const n=G(e);if(n!==G(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return W(e).isEqual(W(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=q(e.timestampValue),r=q(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return z(e.bytesValue).isEqual(z(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return B(e.geoPointValue.latitude)===B(t.geoPointValue.latitude)&&B(e.geoPointValue.longitude)===B(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return B(e.integerValue)===B(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=B(e.doubleValue),r=B(t.doubleValue);return n===r?S(n)===S(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return g(e.arrayValue.values||[],t.arrayValue.values||[],H);case 10:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(L(n)!==L(r))return!1;for(const e in n)if(n.hasOwnProperty(e)&&(void 0===r[e]||!H(n[e],r[e])))return!1;return!0}(e,t);default:return l()}}function Q(e,t){return void 0!==(e.values||[]).find((e=>H(e,t)))}function Y(e,t){if(e===t)return 0;const n=G(e),r=G(t);if(n!==r)return p(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return p(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=B(e.integerValue||e.doubleValue),r=B(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return X(e.timestampValue,t.timestampValue);case 4:return X(W(e),W(t));case 5:return p(e.stringValue,t.stringValue);case 6:return function(e,t){const n=z(e),r=z(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let e=0;e<n.length&&e<r.length;e++){const t=p(n[e],r[e]);if(0!==t)return t}return p(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=p(B(e.latitude),B(t.latitude));return 0!==n?n:p(B(e.longitude),B(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],r=t.values||[];for(let e=0;e<n.length&&e<r.length;++e){const t=Y(n[e],r[e]);if(t)return t}return p(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===Ga.mapValue&&t===Ga.mapValue)return 0;if(e===Ga.mapValue)return 1;if(t===Ga.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let e=0;e<r.length&&e<s.length;++e){const t=p(r[e],s[e]);if(0!==t)return t;const o=Y(n[r[e]],i[s[e]]);if(0!==o)return o}return p(r.length,s.length)}(e.mapValue,t.mapValue);default:throw l()}}function X(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return p(e,t);const n=q(e),r=q(t),i=p(n.seconds,r.seconds);return 0!==i?i:p(n.nanos,r.nanos)}function J(e){return Z(e)}function Z(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=q(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return z(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return Xo.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Z(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${Z(e.fields[i])}`;return n+"}"}(e.mapValue):l()}function ee(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function te(e){return!!e&&"integerValue"in e}function ne(e){return!!e&&"arrayValue"in e}function re(e){return!!e&&"nullValue"in e}function ie(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function se(e){return!!e&&"mapValue"in e}function oe(e){if(e.geoPointValue)return{geoPointValue:r({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:r({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return j(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=oe(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=oe(e.arrayValue.values[n]);return t}return r({},e)}function ae(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}function ce(e){return"nullValue"in e?Ha:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?ee(Wa.empty(),Xo.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?{mapValue:{}}:l()}function ue(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?ee(Wa.empty(),Xo.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?{mapValue:{}}:"mapValue"in e?Ga:l()}function le(e,t){const n=Y(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function he(e,t){const n=Y(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}function de(e){const t=[];return j(e.fields,((e,n)=>{const r=new Yo([e]);if(se(n)){const e=de(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new qa(t)}function fe(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?Xo.comparator(Xo.fromName(o.referenceValue),n.key):Y(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function pe(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!H(e.position[n],t.position[n]))return!1;return!0}function ge(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function me(e){return"and"===e.op}function _e(e){return"or"===e.op}function ye(e){return ve(e)&&me(e)}function ve(e){for(const t of e.filters)if(t instanceof tc)return!1;return!0}function we(e){if(e instanceof ec)return e.field.canonicalString()+e.op.toString()+J(e.value);if(ye(e))return e.filters.map((e=>we(e))).join(",");{const t=e.filters.map((e=>we(e))).join(",");return`${e.op}(${t})`}}function be(e,t){return e instanceof ec?function(e,t){return t instanceof ec&&e.op===t.op&&e.field.isEqual(t.field)&&H(e.value,t.value)}(e,t):e instanceof tc?function(e,t){return t instanceof tc&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,r)=>e&&be(n,t.filters[r])),!0)}(e,t):void l()}function Ie(e,t){const n=e.filters.concat(t);return tc.create(n,e.op)}function Te(e){return e instanceof ec?function(e){return`${e.field.canonicalString()} ${e.op} ${J(e.value)}`}(e):e instanceof tc?function(e){return e.op.toString()+" {"+e.getFilters().map(Te).join(" ,")+"}"}(e):"Filter"}function Ee(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>Xo.fromName(e.referenceValue)))}function ke(e,t=null,n=[],r=[],i=null,s=null,o=null){return new uc(e,t,n,r,i,s,o)}function Ce(e){const t=e;if(null===t.he){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>we(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),C(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>J(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>J(e))).join(",")),t.he=e}return t.he}function Se(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!ge(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!be(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!pe(e.startAt,t.startAt)&&pe(e.endAt,t.endAt)}function Oe(e){return Xo.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function Ae(e,t){return e.filters.filter((e=>e instanceof ec&&e.field.isEqual(t)))}function Ne(e,t,n){let r=Ha,i=!0;for(const n of Ae(e,t)){let e=Ha,t=!0;switch(n.op){case"<":case"<=":e=ce(n.value);break;case"==":case"in":case">=":e=n.value;break;case">":e=n.value,t=!1;break;case"!=":case"not-in":e=Ha}le({value:r,inclusive:i},{value:e,inclusive:t})<0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];le({value:r,inclusive:i},{value:e,inclusive:n.inclusive})<0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}function Pe(e,t,n){let r=Ga,i=!0;for(const n of Ae(e,t)){let e=Ga,t=!0;switch(n.op){case">=":case">":e=ue(n.value),t=!1;break;case"==":case"in":case"<=":e=n.value;break;case"<":e=n.value,t=!1;break;case"!=":case"not-in":e=Ga}he({value:r,inclusive:i},{value:e,inclusive:t})>0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];he({value:r,inclusive:i},{value:e,inclusive:n.inclusive})>0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}function Re(e,t,n,r,i,s,o,a){return new lc(e,t,n,r,i,s,o,a)}function De(e){return new lc(e)}function xe(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Me(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function Le(e){for(const t of e.filters){const e=t.getFirstInequalityField();if(null!==e)return e}return null}function je(e){return null!==e.collectionGroup}function Fe(e){const t=e;if(null===t.Pe){t.Pe=[];const e=Le(t),n=Me(t);if(null!==e&&null===n)e.isKeyField()||t.Pe.push(new Ja(e)),t.Pe.push(new Ja(Yo.keyField(),"asc"));else{let e=!1;for(const n of t.explicitOrderBy)t.Pe.push(n),n.field.isKeyField()&&(e=!0);if(!e){const e=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.Pe.push(new Ja(Yo.keyField(),e))}}}return t.Pe}function Ue(e){const t=e;if(!t.Ie)if("F"===t.limitType)t.Ie=ke(t.path,t.collectionGroup,Fe(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const n of Fe(t)){e.push(new Ja(n.field,"desc"===n.dir?"asc":"desc"))}const n=t.endAt?new Xa(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Xa(t.startAt.position,t.startAt.inclusive):null;t.Ie=ke(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}return t.Ie}function Ve(e,t){t.getFirstInequalityField(),Le(e);const n=e.filters.concat([t]);return new lc(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function qe(e,t,n){return new lc(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Be(e,t){return Se(Ue(e),Ue(t))&&e.limitType===t.limitType}function ze(e){return`${Ce(Ue(e))}|lt:${e.limitType}`}function Ke(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>Te(e))).join(", ")}]`),C(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>J(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>J(e))).join(",")),`Target(${t})`}(Ue(e))}; limitType=${e.limitType})`}function $e(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Xo.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Fe(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=fe(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Fe(e),t))&&!(e.endAt&&!function(e,t,n){const r=fe(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Fe(e),t))}(e,t)}function We(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Ge(e){return(t,n)=>{let r=!1;for(const i of Fe(e)){const e=He(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function He(e,t,n){const r=e.field.isKeyField()?Xo.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?Y(r,i):l()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return l()}}function Qe(){return dc}function Ye(...e){let t=fc;for(const n of e)t=t.insert(n.key,n);return t}function Xe(e){let t=fc;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function Je(){return et()}function Ze(){return et()}function et(){return new hc((e=>e.toString()),((e,t)=>e.isEqual(t)))}function tt(...e){let t=gc;for(const n of e)t=t.add(n);return t}function nt(){return mc}function rt(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:S(t)?"-0":t}}function it(e){return{integerValue:""+e}}function st(e,t){return O(t)?it(t):rt(e,t)}function ot(e,t,n){return e instanceof yc?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&K(t)&&(t=$(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof vc?ut(e,t):e instanceof wc?lt(e,t):function(e,t){const n=ct(e,t),r=ht(n)+ht(e.Te);return te(n)&&te(e.Te)?it(r):rt(e.serializer,r)}(e,t)}function at(e,t,n){return e instanceof vc?ut(e,t):e instanceof wc?lt(e,t):n}function ct(e,t){return e instanceof bc?function(e){return te(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}function ut(e,t){const n=dt(t);for(const t of e.elements)n.some((e=>H(e,t)))||n.push(t);return{arrayValue:{values:n}}}function lt(e,t){let n=dt(t);for(const t of e.elements)n=n.filter((e=>!H(e,t)));return{arrayValue:{values:n}}}function ht(e){return B(e.integerValue||e.doubleValue)}function dt(e){return ne(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}function ft(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}function pt(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Oc(e.key,Ec.none()):new Cc(e.key,e.data,Ec.none());{const n=e.data,r=Qa.empty();let i=new Ua(Yo.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new Sc(e.key,r,new qa(i.toArray()),Ec.none())}}function gt(e,t,n){e instanceof Cc?function(e,t,n){const r=e.value.clone(),i=wt(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Sc?function(e,t,n){if(!ft(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=wt(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(vt(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function mt(e,t,n,r){return e instanceof Cc?function(e,t,n,r){if(!ft(e.precondition,t))return n;const i=e.value.clone(),s=bt(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Sc?function(e,t,n,r){if(!ft(e.precondition,t))return n;const i=bt(e.fieldTransforms,r,t),s=t.data;return s.setAll(vt(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return ft(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function _t(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=ct(r.transform,e||null);null!=i&&(null===n&&(n=Qa.empty()),n.set(r.field,i))}return n||null}function yt(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&g(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof vc&&t instanceof vc||e instanceof wc&&t instanceof wc?g(e.elements,t.elements,H):e instanceof bc&&t instanceof bc?H(e.Te,t.Te):e instanceof yc&&t instanceof yc}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}function vt(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function wt(e,t,n){const r=new Map;h(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,at(o,a,n[i]))}return r}function bt(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,ot(e,s,t))}return r}function It(e){switch(e){default:return l();case Do.CANCELLED:case Do.UNKNOWN:case Do.DEADLINE_EXCEEDED:case Do.RESOURCE_EXHAUSTED:case Do.INTERNAL:case Do.UNAVAILABLE:case Do.UNAUTHENTICATED:return!1;case Do.INVALID_ARGUMENT:case Do.NOT_FOUND:case Do.ALREADY_EXISTS:case Do.PERMISSION_DENIED:case Do.FAILED_PRECONDITION:case Do.ABORTED:case Do.OUT_OF_RANGE:case Do.UNIMPLEMENTED:case Do.DATA_LOSS:return!0}}function Tt(e){if(void 0===e)return a("GRPC error has no .code"),Do.UNKNOWN;switch(e){case xc.OK:return Do.OK;case xc.CANCELLED:return Do.CANCELLED;case xc.UNKNOWN:return Do.UNKNOWN;case xc.DEADLINE_EXCEEDED:return Do.DEADLINE_EXCEEDED;case xc.RESOURCE_EXHAUSTED:return Do.RESOURCE_EXHAUSTED;case xc.INTERNAL:return Do.INTERNAL;case xc.UNAVAILABLE:return Do.UNAVAILABLE;case xc.UNAUTHENTICATED:return Do.UNAUTHENTICATED;case xc.INVALID_ARGUMENT:return Do.INVALID_ARGUMENT;case xc.NOT_FOUND:return Do.NOT_FOUND;case xc.ALREADY_EXISTS:return Do.ALREADY_EXISTS;case xc.PERMISSION_DENIED:return Do.PERMISSION_DENIED;case xc.FAILED_PRECONDITION:return Do.FAILED_PRECONDITION;case xc.ABORTED:return Do.ABORTED;case xc.OUT_OF_RANGE:return Do.OUT_OF_RANGE;case xc.UNIMPLEMENTED:return Do.UNIMPLEMENTED;case xc.DATA_LOSS:return Do.DATA_LOSS;default:return l()}}function Et(){return new TextEncoder}function kt(e){const t=Et().encode(e),n=new Oo.f;return n.update(t),new Uint8Array(n.digest())}function Ct(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new Oo.e([n,r],0),new Oo.e([i,s],0)]}function St(){return new La(Xo.comparator)}function Ot(){return new La(Xo.comparator)}function At(e,t){return e.useProto3Json||C(t)?t:{value:t}}function Nt(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Pt(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Rt(e,t){return Nt(e,t.toTimestamp())}function Dt(e){return h(!!e),Wo.fromTimestamp(function(e){const t=q(e);return new $o(t.seconds,t.nanos)}(e))}function xt(e,t){return function(e){return new Ho(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function Mt(e){const t=Ho.fromString(e);return h(rn(t)),t}function Lt(e,t){return xt(e.databaseId,t.path)}function jt(e,t){const n=Mt(t);if(n.get(1)!==e.databaseId.projectId)throw new xo(Do.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new xo(Do.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Xo(qt(n))}function Ft(e,t){return xt(e.databaseId,t)}function Ut(e){const t=Mt(e);return 4===t.length?Ho.emptyPath():qt(t)}function Vt(e){return new Ho(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function qt(e){return h(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Bt(e,t,n){return{name:Lt(e,t),fields:n.value.mapValue.fields}}function zt(e,t,n){const r=jt(e,t.name),i=Dt(t.updateTime),s=t.createTime?Dt(t.createTime):Wo.min(),o=new Qa({mapValue:{fields:t.fields}}),a=Ya.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function Kt(e,t){let n;if(t instanceof Cc)n={update:Bt(e,t.key,t.value)};else if(t instanceof Oc)n={delete:Lt(e,t.key)};else if(t instanceof Sc)n={update:Bt(e,t.key,t.data),updateMask:nn(t.fieldMask)};else{if(!(t instanceof Ac))return l();n={verify:Lt(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof yc)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof vc)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof wc)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof bc)return{fieldPath:t.field.canonicalString(),increment:n.Te};throw l()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Rt(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:l()}(e,t.precondition)),n}function $t(e,t){const n=t.currentDocument?function(e){return void 0!==e.updateTime?Ec.updateTime(Dt(e.updateTime)):void 0!==e.exists?Ec.exists(e.exists):Ec.none()}(t.currentDocument):Ec.none(),r=t.updateTransforms?t.updateTransforms.map((t=>function(e,t){let n=null;if("setToServerValue"in t)h("REQUEST_TIME"===t.setToServerValue),n=new yc;else if("appendMissingElements"in t){n=new vc(t.appendMissingElements.values||[])}else if("removeAllFromArray"in t){n=new wc(t.removeAllFromArray.values||[])}else"increment"in t?n=new bc(e,t.increment):l();const r=Yo.fromServerFormat(t.fieldPath);return new Ic(r,n)}(e,t))):[];if(t.update){const i=jt(e,t.update.name),s=new Qa({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){return new qa((e.fieldPaths||[]).map((e=>Yo.fromServerFormat(e))))}(t.updateMask);return new Sc(i,s,e,n,r)}return new Cc(i,s,n,r)}if(t.delete){const r=jt(e,t.delete);return new Oc(r,n)}if(t.verify){const r=jt(e,t.verify);return new Ac(r,n)}return l()}function Wt(e,t){return{documents:[Ft(e,t.path)]}}function Gt(e,t){const n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=Ft(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=Ft(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(e){if(0!==e.length)return tn(tc.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);const s=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:Zt(e.field),direction:Yt(e.dir)}}(e)))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=At(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function Ht(e){let t=Ut(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){h(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=Qt(e);return t instanceof tc&&ye(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map((e=>function(e){return new Ja(en(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,C(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){return new Xa(e.values||[],!!e.before)}(n.startAt));let u=null;return n.endAt&&(u=function(e){return new Xa(e.values||[],!e.before)}(n.endAt)),Re(t,i,o,s,a,"F",c,u)}function Qt(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=en(e.unaryFilter.field);return ec.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=en(e.unaryFilter.field);return ec.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=en(e.unaryFilter.field);return ec.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=en(e.unaryFilter.field);return ec.create(i,"!=",{nullValue:"NULL_VALUE"});default:return l()}}(e):void 0!==e.fieldFilter?function(e){return ec.create(en(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return l()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return tc.create(e.compositeFilter.filters.map((e=>Qt(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return l()}}(e.compositeFilter.op))}(e):l()}function Yt(e){return Hc[e]}function Xt(e){return Qc[e]}function Jt(e){return Yc[e]}function Zt(e){return{fieldPath:e.canonicalString()}}function en(e){return Yo.fromServerFormat(e.fieldPath)}function tn(e){return e instanceof ec?function(e){if("=="===e.op){if(ie(e.value))return{unaryFilter:{field:Zt(e.field),op:"IS_NAN"}};if(re(e.value))return{unaryFilter:{field:Zt(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(ie(e.value))return{unaryFilter:{field:Zt(e.field),op:"IS_NOT_NAN"}};if(re(e.value))return{unaryFilter:{field:Zt(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Zt(e.field),op:Xt(e.op),value:e.value}}}(e):e instanceof tc?function(e){const t=e.getFilters().map((e=>tn(e)));return 1===t.length?t[0]:{compositeFilter:{op:Jt(e.op),filters:t}}}(e):l()}function nn(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function rn(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}function sn(e,t){const n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:on(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(e,t){return{name:Lt(e,t.key),fields:t.data.value.mapValue.fields,updateTime:Nt(e,t.version.toTimestamp()),createTime:Nt(e,t.createTime.toTimestamp())}}(e.ct,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:an(t.version)};else{if(!t.isUnknownDocument())return l();r.unknownDocument={path:n.path.toArray(),version:an(t.version)}}return r}function on(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function an(e){const t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function cn(e){const t=new $o(e.seconds,e.nanoseconds);return Wo.fromTimestamp(t)}function un(e,t){const n=(t.baseMutations||[]).map((t=>$t(e.ct,t)));for(let e=0;e<t.mutations.length-1;++e){if(e+1<t.mutations.length&&void 0!==t.mutations[e+1].transform){t.mutations[e].updateTransforms=t.mutations[e+1].transform.fieldTransforms,t.mutations.splice(e+1,1),++e}}const r=t.mutations.map((t=>$t(e.ct,t))),i=$o.fromMillis(t.localWriteTimeMs);return new Nc(t.batchId,i,n,r)}function ln(e){const t=cn(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?cn(e.lastLimboFreeSnapshotVersion):Wo.min();let r;return r=function(e){return void 0!==e.documents}(e.query)?function(e){return h(1===e.documents.length),Ue(De(Ut(e.documents[0])))}(e.query):function(e){return Ue(Ht(e))}(e.query),new Jc(r,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,t,n,za.fromBase64String(e.resumeToken))}function hn(e,t){const n=an(t.snapshotVersion),r=an(t.lastLimboFreeSnapshotVersion);let i;i=Oe(t.target)?Wt(e.ct,t.target):Gt(e.ct,t.target);const s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:Ce(t.target),readTime:n,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function dn(e){const t=Ht({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?qe(t,t.limit,"L"):t}function fn(e,t){return new Rc(t.largestBatchId,$t(e.ct,t.overlayMutation))}function pn(e,t){const n=t.path.lastSegment();return[e,A(t.path.popLast()),n]}function gn(e,t,n,r){return{indexId:e,uid:t.uid||"",sequenceNumber:n,readTime:an(r.readTime),documentKey:A(r.documentKey.path),largestBatchId:r.largestBatchId}}function mn(e){return M(e,"bundles")}function _n(e){return M(e,"namedQueries")}function yn(e){return M(e,"documentOverlays")}function vn(e){if(0===e)return 8;let t=0;return e>>4==0&&(t+=4,e<<=4),e>>6==0&&(t+=2,e<<=2),e>>7==0&&(t+=1),t}function wn(e){const t=64-function(e){let t=0;for(let n=0;n<8;++n){const r=vn(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}function bn(e,t){let n=e.indexId-t.indexId;return 0!==n?n:(n=In(e.arrayValue,t.arrayValue),0!==n?n:(n=In(e.directionalValue,t.directionalValue),0!==n?n:Xo.comparator(e.documentKey,t.documentKey)))}function In(e,t){for(let n=0;n<e.length&&n<t.length;++n){const r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}function Tn(e){var t,n;if(h(e instanceof ec||e instanceof tc),e instanceof ec){if(e instanceof oc){const r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map((t=>ec.create(e.field,"==",t))))||[];return tc.create(r,"or")}return e}const r=e.filters.map((e=>Tn(e)));return tc.create(r,e.op)}function En(e){if(0===e.getFilters().length)return[];const t=On(Tn(e));return h(Sn(t)),kn(t)||Cn(t)?[t]:t.getFilters()}function kn(e){return e instanceof ec}function Cn(e){return e instanceof tc&&ye(e)}function Sn(e){return kn(e)||Cn(e)||function(e){if(e instanceof tc&&_e(e)){for(const t of e.getFilters())if(!kn(t)&&!Cn(t))return!1;return!0}return!1}(e)}function On(e){if(h(e instanceof ec||e instanceof tc),e instanceof ec)return e;if(1===e.filters.length)return On(e.filters[0]);const t=e.filters.map((e=>On(e)));let n=tc.create(t,e.op);return n=Pn(n),Sn(n)?n:(h(n instanceof tc),h(me(n)),h(n.filters.length>1),n.filters.reduce(((e,t)=>An(e,t))))}function An(e,t){let n;return h(e instanceof ec||e instanceof tc),h(t instanceof ec||t instanceof tc),n=e instanceof ec?t instanceof ec?function(e,t){return tc.create([e,t],"and")}(e,t):Nn(e,t):t instanceof ec?Nn(t,e):function(e,t){if(h(e.filters.length>0&&t.filters.length>0),me(e)&&me(t))return Ie(e,t.getFilters());const n=_e(e)?e:t,r=_e(e)?t:e,i=n.filters.map((e=>An(e,r)));return tc.create(i,"or")}(e,t),Pn(n)}function Nn(e,t){if(me(t))return Ie(t,e.getFilters());{const n=t.filters.map((t=>An(e,t)));return tc.create(n,"or")}}function Pn(e){if(h(e instanceof ec||e instanceof tc),e instanceof ec)return e;const t=e.getFilters();if(1===t.length)return Pn(t[0]);if(ve(e))return e;const n=t.map((e=>Pn(e))),r=[];return n.forEach((t=>{t instanceof ec?r.push(t):t instanceof tc&&(t.op===e.op?r.push(...t.filters):r.push(t))})),1===r.length?r[0]:tc.create(r,e.op)}function Rn(e){return M(e,"collectionParents")}function Dn(e){return M(e,"indexEntries")}function xn(e){return M(e,"indexConfiguration")}function Mn(e){return M(e,"indexState")}function Ln(e){h(0!==e.length);let t=e[0].indexState.offset,n=t.largestBatchId;for(let r=1;r<e.length;r++){const i=e[r].indexState.offset;b(i,t)<0&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new ta(t.readTime,t.documentKey,n)}function jn(e,t,n){const r=e.store("mutations"),i=e.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=r.Z({range:o},((e,t,n)=>(a++,n.delete())));s.push(c.next((()=>{h(1===a)})));const u=[];for(const e of n.mutations){const r=x(t,e.key.path,n.batchId);s.push(i.delete(r)),u.push(e.key)}return ia.waitFor(s).next((()=>u))}function Fn(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw l();t=e.noDocument}return JSON.stringify(t).length}function Un(e,t,n){const r=D(t,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return qn(e).Z({range:s,Y:!0},((e,n,r)=>{const[s,a,c]=e;s===t&&a===i&&(o=!0),r.done()})).next((()=>o))}function Vn(e){return M(e,"mutations")}function qn(e){return M(e,"documentMutations")}function Bn(e){return M(e,"mutationQueues")}function zn(e){return M(e,"targets")}function Kn(e){return M(e,"targetGlobal")}function $n(e){return M(e,"targetDocuments")}function Wn([e,t],[n,r]){const i=p(e,n);return 0===i?p(t,r):i}function Gn(e,t){return new wu(e,t)}function Hn(e,t){return $n(e).put(function(e,t){return{targetId:0,path:A(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}function Qn(e){return new Tu(e)}function Yn(e){return M(e,"remoteDocumentGlobal")}function Xn(e){return M(e,"remoteDocumentsV14")}function Jn(e){const t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function Zn(e,t){const n=t.documentKey.path.toArray();return[e,on(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function er(e,t){const n=e.path.toArray(),r=t.path.toArray();let i=0;for(let e=0;e<n.length-2&&e<r.length-2;++e)if(i=p(n[e],r[e]),i)return i;return i=p(n.length,r.length),i||(i=p(n[n.length-2],r[r.length-2]),i||p(n[n.length-1],r[r.length-1]))}function tr(e){e.createObjectStore("targetDocuments",{keyPath:wa}).createIndex("documentTargetsIndex",ba,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",va,{unique:!0}),e.createObjectStore("targetGlobal")}function nr(e){return M(e,"owner")}function rr(e){return M(e,"clientMetadata")}function ir(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}function sr(e,t,n,r){return new zu(e,t,n,r)}async function or(e,t){const n=e;return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((i=>(r=i,n.es(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const i=[],s=[];let o=tt();for(const e of r){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next((e=>({ts:e,removedBatchIds:i,addedBatchIds:s})))}))}))}function ar(e){const t=e;return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.kr.getLastRemoteSnapshotVersion(e)))}function cr(e,t,n){let r=tt(),i=tt();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=Qe();return n.forEach(((n,s)=>{const a=e.get(n);s.isFoundDocument()!==a.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(Wo.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):o("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)})),{ns:r,rs:i}}))}function ur(e,t){const n=e;return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function lr(e,t){const n=e;return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.kr.getTargetData(e,t).next((i=>i?(r=i,ia.resolve(r)):n.kr.allocateTargetId(e).next((i=>(r=new Jc(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.kr.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.Ji.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ji=n.Ji.insert(e.targetId,e),n.Yi.set(t,e.targetId)),e}))}async function hr(e,t,n){const r=e,i=r.Ji.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!T(e))throw e;o("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}r.Ji=r.Ji.remove(t),r.Yi.delete(i.target)}function dr(e,t,n){const r=e;let i=Wo.min(),s=tt();return r.persistence.runTransaction("Execute query","readonly",(e=>function(e,t,n){const r=e,i=r.Yi.get(n);return void 0!==i?ia.resolve(r.Ji.get(i)):r.kr.getTargetData(t,n)}(r,e,Ue(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.kr.getMatchingKeysForTargetId(e,t.targetId).next((e=>{s=e}))})).next((()=>r.Hi.getDocumentsMatchingQuery(e,t,n?i:Wo.min(),n?s:tt()))).next((e=>(gr(r,We(t),e),{documents:e,ss:s})))))}function fr(e,t){const n=e,r=n.kr,i=n.Ji.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(e=>r.ut(e,t).next((e=>e?e.target:null))))}function pr(e,t){const n=e,r=n.Zi.get(t)||Wo.min();return n.persistence.runTransaction("Get new document changes","readonly",(e=>n.Xi.getAllFromCollectionGroup(e,t,v(r,-1),Number.MAX_SAFE_INTEGER))).then((e=>(gr(n,t,e),e)))}function gr(e,t,n){let r=e.Zi.get(t)||Wo.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.Zi.set(t,r)}async function mr(e,t,n=tt()){const r=await lr(e,Ue(dn(t.bundledQuery))),i=e;return i.persistence.runTransaction("Save named query","readwrite",(e=>{const s=Dt(t.readTime);if(r.snapshotVersion.compareTo(s)>=0)return i.Qr.saveNamedQuery(e,t);const o=r.withResumeToken(za.EMPTY_BYTE_STRING,s);return i.Ji=i.Ji.insert(o.targetId,o),i.kr.updateTargetData(e,o).next((()=>i.kr.removeMatchingKeysForTargetId(e,r.targetId))).next((()=>i.kr.addMatchingKeys(e,n,r.targetId))).next((()=>i.Qr.saveNamedQuery(e,t)))}))}function _r(e,t){return`firestore_clients_${e}_${t}`}function yr(e,t,n){let r=`firestore_mutations_${e}_${n}`;return t.isAuthenticated()&&(r+=`_${t.uid}`),r}function vr(e,t){return`firestore_targets_${e}_${t}`}function wr(){return null===Zu?Zu=268435456+Math.round(2147483648*Math.random()):Zu++,"0x"+Zu.toString(16)}function br(){return"undefined"!=typeof window?window:null}function Ir(){return"undefined"!=typeof document?document:null}function Tr(e){return new Xc(e,!0)}async function Er(e){if(Rr(e))for(const t of e.w_)await t(!0)}async function kr(e){for(const t of e.w_)await t(!1)}function Cr(e,t){const n=e;n.p_.has(t.targetId)||(n.p_.set(t.targetId,t),Pr(n)?Nr(n):Yr(n).Uo()&&Or(n,t))}function Sr(e,t){const n=e,r=Yr(n);n.p_.delete(t),r.Uo()&&Ar(n,t),0===n.p_.size&&(r.Uo()?r.zo():Rr(n)&&n.b_.set("Unknown"))}function Or(e,t){if(e.D_.Be(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Wo.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Yr(e).i_(t)}function Ar(e,t){e.D_.Be(t),Yr(e).s_(t)}function Nr(e){e.D_=new Gc({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ut:t=>e.p_.get(t)||null,rt:()=>e.datastore.serializer.databaseId}),Yr(e).start(),e.b_.A_()}function Pr(e){return Rr(e)&&!Yr(e).$o()&&e.p_.size>0}function Rr(e){return 0===e.y_.size}function Dr(e){e.D_=void 0}async function xr(e){e.p_.forEach((t=>{Or(e,t)}))}async function Mr(e,t){Dr(e),Pr(e)?(e.b_.m_(t),Nr(e)):e.b_.set("Unknown")}async function Lr(e,t,n){if(e.b_.set("Online"),t instanceof $c&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.p_.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.p_.delete(r),e.D_.removeTarget(r))}(e,t)}catch(n){o("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await jr(e,n)}else if(t instanceof zc?e.D_.We(t):t instanceof Kc?e.D_.Ze(t):e.D_.je(t),!n.isEqual(Wo.min()))try{const t=await ar(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.D_.st(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.p_.get(r);i&&e.p_.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const r=e.p_.get(t);if(!r)return;e.p_.set(t,r.withResumeToken(za.EMPTY_BYTE_STRING,r.snapshotVersion)),Ar(e,t);const i=new Jc(r.target,t,n,r.sequenceNumber);Or(e,i)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){o("RemoteStore","Failed to raise snapshot:",t),await jr(e,t)}}async function jr(e,t,n){if(!T(t))throw t;e.y_.add(1),await kr(e),e.b_.set("Offline"),n||(n=()=>ar(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{o("RemoteStore","Retrying IndexedDB access"),await n(),e.y_.delete(1),await Er(e)}))}function Fr(e,t){return t().catch((n=>jr(e,n,t)))}async function Ur(e){const t=e,n=Xr(t);let r=t.g_.length>0?t.g_[t.g_.length-1].batchId:-1;for(;Vr(t);)try{const e=await ur(t.localStore,r);if(null===e){0===t.g_.length&&n.zo();break}r=e.batchId,qr(t,e)}catch(e){await jr(t,e)}Br(t)&&zr(t)}function Vr(e){return Rr(e)&&e.g_.length<10}function qr(e,t){e.g_.push(t);const n=Xr(e);n.Uo()&&n.__&&n.a_(t.mutations)}function Br(e){return Rr(e)&&!Xr(e).$o()&&e.g_.length>0}function zr(e){Xr(e).start()}async function Kr(e){Xr(e).l_()}async function $r(e){const t=Xr(e);for(const n of e.g_)t.a_(n.mutations)}async function Wr(e,t,n){const r=e.g_.shift(),i=Pc.from(r,t,n);await Fr(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await Ur(e)}async function Gr(e,t){t&&Xr(e).__&&await async function(e,t){if(function(e){return It(e)&&e!==Do.ABORTED}(t.code)){const n=e.g_.shift();Xr(e).Go(),await Fr(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await Ur(e)}}(e,t),Br(e)&&zr(e)}async function Hr(e,t){const n=e;n.asyncQueue.verifyOperationInProgress(),o("RemoteStore","RemoteStore received new credentials");const r=Rr(n);n.y_.add(3),await kr(n),r&&n.b_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.y_.delete(3),await Er(n)}async function Qr(e,t){const n=e;t?(n.y_.delete(2),await Er(n)):t||(n.y_.add(2),await kr(n),n.b_.set("Unknown"))}function Yr(e){return e.v_||(e.v_=function(e,t,n){const r=e;return r.P_(),new ol(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{_o:xr.bind(null,e),uo:Mr.bind(null,e),r_:Lr.bind(null,e)}),e.w_.push((async t=>{t?(e.v_.Go(),Pr(e)?Nr(e):e.b_.set("Unknown")):(await e.v_.stop(),Dr(e))}))),e.v_}function Xr(e){return e.C_||(e.C_=function(e,t,n){const r=e;return r.P_(),new al(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{_o:Kr.bind(null,e),uo:Gr.bind(null,e),c_:$r.bind(null,e),u_:Wr.bind(null,e)}),e.w_.push((async t=>{t?(e.C_.Go(),await Ur(e)):(await e.C_.stop(),e.g_.length>0&&(o("RemoteStore",`Stopping write stream with ${e.g_.length} pending writes`),e.g_=[]))}))),e.C_}function Jr(e,t){if(a("AsyncQueue",`${t}: ${e}`),T(e))return new xo(Do.UNAVAILABLE,`${t}: ${e}`);throw e}async function Zr(e,t){const n=e,r=t.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new gl),i)try{s.x_=await n.onListen(r)}catch(e){const n=Jr(e,`Initialization of query '${Ke(t.query)}' failed`);return void t.onError(n)}n.queries.set(r,s),s.listeners.push(t),t.N_(n.onlineState),s.x_&&t.B_(s.x_)&&ri(n)}async function ei(e,t){const n=e,r=t.query;let i=!1;const s=n.queries.get(r);if(s){const e=s.listeners.indexOf(t);e>=0&&(s.listeners.splice(e,1),i=0===s.listeners.length)}if(i)return n.queries.delete(r),n.onUnlisten(r)}function ti(e,t){const n=e;let r=!1;for(const e of t){const t=n.queries.get(e.query);if(t){for(const n of t.listeners)n.B_(e)&&(r=!0);t.x_=e}}r&&ri(n)}function ni(e,t,n){const r=e,i=r.queries.get(t);if(i)for(const e of i.listeners)e.onError(n);r.queries.delete(t)}function ri(e){e.O_.forEach((e=>{e.next()}))}function ii(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}async function si(e,t){const n=Pi(e);let r,i;const s=n.Ea.get(t);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Pa();else{const e=await lr(n.localStore,Ue(t)),s=n.sharedClientState.addLocalQueryTarget(e.targetId);r=e.targetId,i=await oi(n,t,r,"current"===s,e.resumeToken),n.isPrimaryClient&&Cr(n.remoteStore,e)}return i}async function oi(e,t,n,r,i){e.wa=(t,n,r)=>async function(e,t,n,r){let i=t.view.sa(n);i.zi&&(i=await dr(e.localStore,t.query,!1).then((({documents:e})=>t.view.sa(e,i))));const s=r&&r.targetChanges.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,s);return _i(e,t.targetId,o.ca),o.snapshot}(e,t,n,r);const s=await dr(e.localStore,t,!0),o=new Tl(t,s.ss),a=o.sa(s.documents),c=Bc.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),u=o.applyChanges(a,e.isPrimaryClient,c);_i(e,n,u.ca);const l=new El(t,n,o);return e.Ea.set(t,l),e.da.has(n)?e.da.get(n).push(t):e.da.set(n,[t]),u.snapshot}async function ai(e,t){const n=e,r=n.Ea.get(t),i=n.da.get(r.targetId);if(i.length>1)return n.da.set(r.targetId,i.filter((e=>!Be(e,t)))),void n.Ea.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await hr(n.localStore,r.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(r.targetId),Sr(n.remoteStore,r.targetId),gi(n,r.targetId)})).catch(I)):(gi(n,r.targetId),await hr(n.localStore,r.targetId,!0))}async function ci(e,t){const n=e;try{const e=await function(e,t){const n=e,r=t.snapshotVersion;let i=n.Ji;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const s=n.Xi.newChangeBuffer({trackRemovals:!0});i=n.Ji;const o=[];t.targetChanges.forEach(((s,a)=>{const c=i.get(a);if(!c)return;o.push(n.kr.removeMatchingKeys(e,s.removedDocuments,a).next((()=>n.kr.addMatchingKeys(e,s.addedDocuments,a))));let u=c.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?u=u.withResumeToken(za.EMPTY_BYTE_STRING,Wo.min()).withLastLimboFreeSnapshotVersion(Wo.min()):s.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(s.resumeToken,r)),i=i.insert(a,u),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,u,s)&&o.push(n.kr.updateTargetData(e,u))}));let a=Qe(),c=tt();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(cr(e,s,t.documentUpdates).next((e=>{a=e.ns,c=e.rs}))),!r.isEqual(Wo.min())){const t=n.kr.getLastRemoteSnapshotVersion(e).next((()=>n.kr.setTargetsMetadata(e,e.currentSequenceNumber,r)));o.push(t)}return ia.waitFor(o).next((()=>s.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,a,c))).next((()=>a))})).then((e=>(n.Ji=i,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.Va.get(t);r&&(h(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.Ia=!0:e.modifiedDocuments.size>0?h(r.Ia):e.removedDocuments.size>0&&(h(r.Ia),r.Ia=!1))})),await wi(n,e,t)}catch(e){await I(e)}}function ui(e,t,n){const r=e;if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Ea.forEach(((n,r)=>{const i=r.view.N_(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){const n=e;n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const e of n.listeners)e.N_(t)&&(r=!0)})),r&&ri(n)}(r.eventManager,t),e.length&&r.Ta.r_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function li(e,t,n){const r=e;r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Va.get(t),s=i&&i.key;if(s){let e=new La(Xo.comparator);e=e.insert(s,Ya.newNoDocument(s,Wo.min()));const n=tt().add(s),i=new qc(Wo.min(),new Map,new La(p),e,n);await ci(r,i),r.Ra=r.Ra.remove(s),r.Va.delete(t),vi(r)}else await hr(r.localStore,t,!1).then((()=>gi(r,t,n))).catch(I)}async function hi(e,t){const n=e,r=t.batch.batchId;try{const e=await function(e,t){const n=e;return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),i=n.Xi.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=ia.resolve();return s.forEach((e=>{o=o.next((()=>r.getEntry(t,e))).next((t=>{const s=n.docVersions.get(e);h(null!==s),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((()=>e.mutationQueue.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=tt();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(n.localStore,t);pi(n,r,null),fi(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await wi(n,e)}catch(e){await I(e)}}async function di(e,t,n){const r=e;try{const e=await function(e,t){const n=e;return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(h(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);pi(r,t,n),fi(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await wi(r,e)}catch(n){await I(n)}}function fi(e,t){(e.ga.get(t)||[]).forEach((e=>{e.resolve()})),e.ga.delete(t)}function pi(e,t,n){const r=e;let i=r.fa[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.fa[r.currentUser.toKey()]=i}}function gi(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.da.get(t))e.Ea.delete(r),n&&e.Ta.Sa(r,n);e.da.delete(t),e.isPrimaryClient&&e.ma.Ar(t).forEach((t=>{e.ma.containsKey(t)||mi(e,t)}))}function mi(e,t){e.Aa.delete(t.path.canonicalString());const n=e.Ra.get(t);null!==n&&(Sr(e.remoteStore,n),e.Ra=e.Ra.remove(t),e.Va.delete(n),vi(e))}function _i(e,t,n){for(const r of n)r instanceof bl?(e.ma.addReference(r.key,t),yi(e,r)):r instanceof Il?(o("SyncEngine","Document no longer in limbo: "+r.key),e.ma.removeReference(r.key,t),e.ma.containsKey(r.key)||mi(e,r.key)):l()}function yi(e,t){const n=t.key,r=n.path.canonicalString();e.Ra.get(n)||e.Aa.has(r)||(o("SyncEngine","New document in limbo: "+n),e.Aa.add(r),vi(e))}function vi(e){for(;e.Aa.size>0&&e.Ra.size<e.maxConcurrentLimboResolutions;){const t=e.Aa.values().next().value;e.Aa.delete(t);const n=new Xo(Ho.fromString(t)),r=e.pa.next();e.Va.set(r,new kl(n)),e.Ra=e.Ra.insert(n,r),Cr(e.remoteStore,new Jc(Ue(De(n.path)),r,"TargetPurposeLimboResolution",fa.ae))}}async function wi(e,t,n){const r=e,i=[],s=[],a=[];r.Ea.isEmpty()||(r.Ea.forEach(((e,o)=>{a.push(r.wa(o,t,n).then((e=>{if((e||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(o.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){i.push(e);const t=qu.qi(o.targetId,e);s.push(t)}})))})),await Promise.all(a),r.Ta.r_(i),await async function(e,t){const n=e;try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>ia.forEach(t,(t=>ia.forEach(t.Li,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>ia.forEach(t.ki,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!T(e))throw e;o("LocalStore","Failed to update sequence numbers: "+e)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=n.Ji.get(t),r=e.withLastLimboFreeSnapshotVersion(e.snapshotVersion);n.Ji=n.Ji.insert(t,r)}}}(r.localStore,s))}async function bi(e,t){const n=e;if(!n.currentUser.isEqual(t)){o("SyncEngine","User change. New user:",t.toKey());const e=await or(n.localStore,t);n.currentUser=t,function(e,t){e.ga.forEach((e=>{e.forEach((e=>{e.reject(new xo(Do.CANCELLED,t))}))})),e.ga.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await wi(n,e.ts)}}function Ii(e,t){const n=e,r=n.Va.get(t);if(r&&r.Ia)return tt().add(r.key);{let e=tt();const r=n.da.get(t);if(!r)return e;for(const t of r){const r=n.Ea.get(t);e=e.unionWith(r.view.ia)}return e}}async function Ti(e,t){const n=e,r=await dr(n.localStore,t.query,!0),i=t.view.ha(r);return n.isPrimaryClient&&_i(n,t.targetId,i.ca),i}async function Ei(e,t){const n=e;return pr(n.localStore,t).then((e=>wi(n,e)))}async function ki(e,t,n,r){const i=e,s=await function(e,t){const n=e,r=n.mutationQueue;return n.persistence.runTransaction("Lookup mutation documents","readonly",(e=>r.Dn(e,t).next((t=>t?n.localDocuments.getDocuments(e,t):ia.resolve(null)))))}(i.localStore,t);null!==s?("pending"===n?await Ur(i.remoteStore):"acknowledged"===n||"rejected"===n?(pi(i,t,r||null),fi(i,t),function(e,t){e.mutationQueue.Cn(t)}(i.localStore,t)):l(),await wi(i,s)):o("SyncEngine","Cannot apply mutation batch with id: "+t)}async function Ci(e,t){const n=e,r=[],i=[];for(const e of t){let t;const s=n.da.get(e);if(s&&0!==s.length){t=await lr(n.localStore,Ue(s[0]));for(const e of s){const t=n.Ea.get(e),r=await Ti(n,t);r.snapshot&&i.push(r.snapshot)}}else{const r=await fr(n.localStore,e);t=await lr(n.localStore,r),await oi(n,Si(r),e,!1,t.resumeToken)}r.push(t)}return n.Ta.r_(i),r}function Si(e){return Re(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function Oi(e){return function(e){return e.persistence.Ni()}(e.localStore)}async function Ai(e,t,n,r){const i=e;if(i.ya)return void o("SyncEngine","Ignoring unexpected query state notification.");const s=i.da.get(t);if(s&&s.length>0)switch(n){case"current":case"not-current":{const e=await pr(i.localStore,We(s[0])),r=qc.createSynthesizedRemoteEventForCurrentChange(t,"current"===n,za.EMPTY_BYTE_STRING);await wi(i,e,r);break}case"rejected":await hr(i.localStore,t,!0),gi(i,t,r);break;default:l()}}async function Ni(e,t,n){const r=Pi(e);if(r.ya){for(const e of t){if(r.da.has(e)){o("SyncEngine","Adding an already active target "+e);continue}const t=await fr(r.localStore,e),n=await lr(r.localStore,t);await oi(r,Si(t),n.targetId,!1,n.resumeToken),Cr(r.remoteStore,n)}for(const e of n)r.da.has(e)&&await hr(r.localStore,e,!1).then((()=>{Sr(r.remoteStore,e),gi(r,e)})).catch(I)}}function Pi(e){const t=e;return t.remoteStore.remoteSyncer.applyRemoteEvent=ci.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Ii.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=li.bind(null,t),t.Ta.r_=ti.bind(null,t.eventManager),t.Ta.Sa=ni.bind(null,t.eventManager),t}function Ri(e){const t=e;return t.remoteStore.remoteSyncer.applySuccessfulWrite=hi.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=di.bind(null,t),t}function Di(e,t=10240){let n=0;return{async read(){if(n<e.byteLength){const r={value:e.slice(n,n+t),done:!1};return n+=t,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}async function xi(e,t){e.asyncQueue.verifyOperationInProgress(),o("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await or(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function Mi(e,t){e.asyncQueue.verifyOperationInProgress();const n=await ji(e);o("FirestoreClient","Initializing OnlineComponentProvider");const r=await e.getConfiguration();await t.initialize(n,r),e.setCredentialChangeListener((e=>Hr(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>Hr(t.remoteStore,n))),e._onlineComponents=t}function Li(e){return"FirebaseError"===e.name?e.code===Do.FAILED_PRECONDITION||e.code===Do.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}async function ji(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){o("FirestoreClient","Using user provided OfflineComponentProvider");try{await xi(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!Li(n))throw n;c("Error using user provided cache. Falling back to memory cache: "+n),await xi(e,new Sl)}}else o("FirestoreClient","Using default OfflineComponentProvider"),await xi(e,new Sl);return e._offlineComponents}async function Fi(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(o("FirestoreClient","Using user provided OnlineComponentProvider"),await Mi(e,e._uninitializedComponentsProvider._online)):(o("FirestoreClient","Using default OnlineComponentProvider"),await Mi(e,new Nl))),e._onlineComponents}function Ui(e){return ji(e).then((e=>e.persistence))}function Vi(e){return ji(e).then((e=>e.localStore))}function qi(e){return Fi(e).then((e=>e.remoteStore))}function Bi(e){return Fi(e).then((e=>e.syncEngine))}function zi(e){return Fi(e).then((e=>e.datastore))}async function Ki(e){const t=await Fi(e),n=t.eventManager;return n.onListen=si.bind(null,t.syncEngine),n.onUnlisten=ai.bind(null,t.syncEngine),n}function $i(e,t,n={}){const r=new Mo;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new Pl({next:s=>{t.enqueueAndForget((()=>ei(e,o)));const a=s.docs.has(n);!a&&s.fromCache?i.reject(new xo(Do.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&s.fromCache&&r&&"server"===r.source?i.reject(new xo(Do.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(s)},error:e=>i.reject(e)}),o=new _l(De(n.path),s,{includeMetadataChanges:!0,W_:!0});return Zr(e,o)}(await Ki(e),e.asyncQueue,t,n,r))),r.promise}function Wi(e,t,n={}){const r=new Mo;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new Pl({next:n=>{t.enqueueAndForget((()=>ei(e,o))),n.fromCache&&"server"===r.source?i.reject(new xo(Do.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),o=new _l(n,s,{includeMetadataChanges:!0,W_:!0});return Zr(e,o)}(await Ki(e),e.asyncQueue,t,n,r))),r.promise}function Gi(e,t,n,r){const i=function(e,t){let n;return n="string"==typeof e?Et().encode(e):e,function(e,t){return new Rl(e,t)}(function(e,t){if(e instanceof Uint8Array)return Di(e,t);if(e instanceof ArrayBuffer)return Di(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(n),t)}(n,Tr(t));e.asyncQueue.enqueueAndForget((async()=>{!function(e,t,n){const r=e;(async function(e,t,n){try{const r=await t.getMetadata();if(await function(e,t){const n=e,r=Dt(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(e=>n.Qr.getBundleMetadata(e,t.id))).then((e=>!!e&&e.createTime.compareTo(r)>=0))}(e.localStore,r))return await t.close(),n._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(r)),Promise.resolve(new Set);n._updateProgress(ii(r));const i=new wl(r,e.localStore,t.serializer);let s=await t.ba();for(;s;){const e=await i.H_(s);e&&n._updateProgress(e),s=await t.ba()}const o=await i.complete();return await wi(e,o.Z_,void 0),await function(e,t){const n=e;return n.persistence.runTransaction("Save bundle","readwrite",(e=>n.Qr.saveBundleMetadata(e,t)))}(e.localStore,r),n._completeWith(o.progress),Promise.resolve(o.Y_)}catch(e){return c("SyncEngine",`Loading bundle failed with ${e}`),n._failWith(e),Promise.resolve(new Set)}})(r,t,n).then((e=>{r.sharedClientState.notifyBundleLoaded(e)}))}(await Bi(e),i,r)}))}function Hi(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}function Qi(e,t,n){if(!n)throw new xo(Do.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function Yi(e,t,n,r){if(!0===t&&!0===r)throw new xo(Do.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function Xi(e){if(!Xo.isDocumentKey(e))throw new xo(Do.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Ji(e){if(Xo.isDocumentKey(e))throw new xo(Do.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Zi(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":l()}function es(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new xo(Do.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Zi(e);throw new xo(Do.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function ts(e,t){if(t<=0)throw new xo(Do.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}function ns(e,t,n,i={}){var s;const o=(e=es(e,Fl))._getSettings(),a=`${t}:${n}`;if("firestore.googleapis.com"!==o.host&&o.host!==a&&c("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(r(r({},o),{host:a,ssl:!1})),i.mockUserToken){let t,n;if("string"==typeof i.mockUserToken)t=i.mockUserToken,n=No.MOCK_USER;else{t=Object(So.n)(i.mockUserToken,null===(s=e._app)||void 0===s?void 0:s.options.projectId);const r=i.mockUserToken.sub||i.mockUserToken.user_id;if(!r)throw new xo(Do.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new No(r)}e._authCredentials=new Fo(new Lo(t,n))}}function rs(e,t,...n){if(e=Object(So.z)(e),Qi("collection","path",t),e instanceof Fl){const r=Ho.fromString(t,...n);return Ji(r),new ql(e,null,r)}{if(!(e instanceof Vl||e instanceof ql))throw new xo(Do.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(Ho.fromString(t,...n));return Ji(r),new ql(e.firestore,null,r)}}function is(e,t){if(e=es(e,Fl),Qi("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new xo(Do.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Ul(e,null,function(e){return new lc(Ho.emptyPath(),e)}(t))}function ss(e,t,...n){if(e=Object(So.z)(e),1===arguments.length&&(t=Ko.V()),Qi("doc","path",t),e instanceof Fl){const r=Ho.fromString(t,...n);return Xi(r),new Vl(e,null,new Xo(r))}{if(!(e instanceof Vl||e instanceof ql))throw new xo(Do.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(Ho.fromString(t,...n));return Xi(r),new Vl(e.firestore,e instanceof ql?e.converter:null,new Xo(r))}}function os(e,t){return e=Object(So.z)(e),t=Object(So.z)(t),(e instanceof Vl||e instanceof ql)&&(t instanceof Vl||t instanceof ql)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function as(e,t){return e=Object(So.z)(e),t=Object(So.z)(t),e instanceof Ul&&t instanceof Ul&&e.firestore===t.firestore&&Be(e._query,t._query)&&e.converter===t.converter}function cs(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const e of t)if(e in n&&"function"==typeof n[e])return!0;return!1}(e,["next","error","complete"])}function us(e,t){const n="object"==typeof e?e:Object(Eo.getApp)(),r="string"==typeof e?e:t||"(default)",i=Object(Eo._getProvider)(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const e=Object(So.w)("firestore");e&&ns(i,...e)}return i}function ls(e){return e._firestoreClient||hs(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function hs(e){var t,n,r;const i=e._freezeSettings(),s=function(e,t,n,r){return new $a(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,Hi(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._firestoreClient=new Ml(e._authCredentials,e._appCheckCredentials,e._queue,s),(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function ds(e,t){bs(e=es(e,$l));const n=ls(e);if(n._uninitializedComponentsProvider)throw new xo(Do.FAILED_PRECONDITION,"SDK cache is already specified.");c("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=e._freezeSettings(),i=new Nl;return ps(n,i,new Ol(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}function fs(e){bs(e=es(e,$l));const t=ls(e);if(t._uninitializedComponentsProvider)throw new xo(Do.FAILED_PRECONDITION,"SDK cache is already specified.");c("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=e._freezeSettings(),r=new Nl;return ps(t,r,new Al(r,n.cacheSizeBytes))}function ps(e,t,n){const r=new Mo;return e.asyncQueue.enqueue((async()=>{try{await xi(e,n),await Mi(e,t),r.resolve()}catch(e){const t=e;if(!Li(t))throw t;c("Error enabling indexeddb cache. Falling back to memory cache: "+t),r.reject(t)}})).then((()=>r.promise))}function gs(e){if(e._initialized&&!e._terminated)throw new xo(Do.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const t=new Mo;return e._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await async function(e){if(!oa.v())return Promise.resolve();const t=e+"main";await oa.delete(t)}(ir(e._databaseId,e._persistenceKey)),t.resolve()}catch(e){t.reject(e)}})),t.promise}function ms(e){return function(e){const t=new Mo;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t){const n=e;Rr(n.remoteStore)||o("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const e=await function(e){const t=e;return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(e=>t.mutationQueue.getHighestUnacknowledgedBatchId(e)))}(n.localStore);if(-1===e)return void t.resolve();const r=n.ga.get(e)||[];r.push(t),n.ga.set(e,r)}catch(e){const n=Jr(e,"Initialization of waitForPendingWrites() operation failed");t.reject(n)}}(await Bi(e),t))),t.promise}(ls(e=es(e,$l)))}function _s(e){return function(e){return e.asyncQueue.enqueue((async()=>{const t=await Ui(e),n=await qi(e);return t.setNetworkEnabled(!0),function(e){const t=e;return t.y_.delete(0),Er(t)}(n)}))}(ls(e=es(e,$l)))}function ys(e){return function(e){return e.asyncQueue.enqueue((async()=>{const t=await Ui(e),n=await qi(e);return t.setNetworkEnabled(!1),async function(e){const t=e;t.y_.add(0),await kr(t),t.b_.set("Offline")}(n)}))}(ls(e=es(e,$l)))}function vs(e,t){const n=ls(e=es(e,$l)),r=new zl;return Gi(n,e._databaseId,t,r),r}function ws(e,t){return function(e,t){return e.asyncQueue.enqueue((async()=>function(e,t){const n=e;return n.persistence.runTransaction("Get named query","readonly",(e=>n.Qr.getNamedQuery(e,t)))}(await Vi(e),t)))}(ls(e=es(e,$l)),t).then((t=>t?new Ul(e,null,t.query):null))}function bs(e){if(e._initialized||e._terminated)throw new xo(Do.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}function Is(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw l()}}function Ts(e){const t=e._freezeSettings(),n=Tr(e._databaseId);return new eh(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Es(e,t,n,r,i,s={}){const o=e.Ru(s.merge||s.mergeFields?2:0,t,n,i);Rs("Data must be an object, but it was:",o,r);const a=Ns(r,o);let c,u;if(s.merge)c=new qa(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=Ds(t,r,n);if(!o.contains(i))throw new xo(Do.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);Ls(e,i)||e.push(i)}c=new qa(e),u=o.fieldTransforms.filter((e=>c.covers(e.field)))}else c=null,u=o.fieldTransforms;return new Xl(new Qa(a),c,u)}function ks(e,t,n){return new Zl({uu:3,Au:t.settings.Au,methodName:e._methodName,hu:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}function Cs(e,t,n,r){const i=e.Ru(1,t,n);Rs("Data must be an object, but it was:",i,r);const s=[],o=Qa.empty();j(r,((e,r)=>{const a=xs(t,e,n);r=Object(So.z)(r);const c=i.Iu(a);if(r instanceof th)s.push(a);else{const e=As(r,c);null!=e&&(s.push(a),o.set(a,e))}}));const a=new qa(s);return new Jl(o,a,i.fieldTransforms)}function Ss(e,t,n,r,i,s){const o=e.Ru(1,t,n),a=[Ds(t,r,n)],c=[i];if(s.length%2!=0)throw new xo(Do.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let e=0;e<s.length;e+=2)a.push(Ds(t,s[e])),c.push(s[e+1]);const u=[],l=Qa.empty();for(let e=a.length-1;e>=0;--e)if(!Ls(u,a[e])){const t=a[e];let n=c[e];n=Object(So.z)(n);const r=o.Iu(t);if(n instanceof th)u.push(t);else{const e=As(n,r);null!=e&&(u.push(t),l.set(t,e))}}const h=new qa(u);return new Jl(l,h,o.fieldTransforms)}function Os(e,t,n,r=!1){return As(n,e.Ru(r?4:3,t))}function As(e,t){if(Ps(e=Object(So.z)(e)))return Rs("Unsupported field value:",t,e),Ns(e,t);if(e instanceof Hl)return function(e,t){if(!Is(t.uu))throw t.Eu(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Eu(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.hu&&4!==t.uu)throw t.Eu("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=As(i,t.Tu(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=Object(So.z)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return st(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=$o.fromDate(e);return{timestampValue:Nt(t.serializer,n)}}if(e instanceof $o){const n=new $o(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Nt(t.serializer,n)}}if(e instanceof Ql)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Wl)return{bytesValue:Pt(t.serializer,e._byteString)};if(e instanceof Vl){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Eu(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:xt(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.Eu(`Unsupported field value: ${Zi(e)}`)}(e,t)}function Ns(e,t){const n={};return F(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):j(e,((e,r)=>{const i=As(r,t.lu(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function Ps(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof $o||e instanceof Ql||e instanceof Wl||e instanceof Vl||e instanceof Hl)}function Rs(e,t,n){if(!Ps(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=Zi(n);throw t.Eu("an object"===r?e+" a custom object":e+" "+r)}}function Ds(e,t,n){if((t=Object(So.z)(t))instanceof Gl)return t._internalPath;if("string"==typeof t)return xs(e,t);throw Ms("Field path arguments must be of type string or ",e,!1,void 0,n)}function xs(e,t,n){if(t.search(oh)>=0)throw Ms(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Gl(...t.split("."))._internalPath}catch(r){throw Ms(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Ms(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new xo(Do.INVALID_ARGUMENT,a+e+c)}function Ls(e,t){return e.some((e=>e.isEqual(t)))}function js(e,t){return"string"==typeof t?xs(e,t):t instanceof Gl?t._internalPath:t._delegate._internalPath}function Fs(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new xo(Do.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}function Us(e,t,...n){let r=[];t instanceof uh&&r.push(t),r=r.concat(n),function(e){const t=e.filter((e=>e instanceof dh)).length,n=e.filter((e=>e instanceof hh)).length;if(t>1||t>0&&n>0)throw new xo(Do.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const t of r)e=t._apply(e);return e}function Vs(e,t,n){const r=t,i=js("where",e);return hh._create(i,r,n)}function qs(e,t="asc"){const n=t,r=js("orderBy",e);return fh._create(r,n)}function Bs(e){return ts("limit",e),ph._create("limit",e,"F")}function zs(e){return ts("limitToLast",e),ph._create("limitToLast",e,"L")}function Ks(...e){return gh._create("startAt",e,!0)}function $s(...e){return gh._create("startAfter",e,!1)}function Ws(...e){return mh._create("endBefore",e,!1)}function Gs(...e){return mh._create("endAt",e,!0)}function Hs(e,t,n,r){if(n[0]=Object(So.z)(n[0]),n[0]instanceof ah)return function(e,t,n,r,i){if(!r)throw new xo(Do.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${n}().`);const s=[];for(const n of Fe(e))if(n.field.isKeyField())s.push(ee(t,r.key));else{const e=r.data.field(n.field);if(K(e))throw new xo(Do.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+n.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=n.field.canonicalString();throw new xo(Do.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${e}' (used as the orderBy) does not exist.`)}s.push(e)}return new Xa(s,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);{const i=Ts(e.firestore);return function(e,t,n,r,i,s){const o=e.explicitOrderBy;if(i.length>o.length)throw new xo(Do.INVALID_ARGUMENT,`Too many arguments provided to ${r}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const a=[];for(let s=0;s<i.length;s++){const c=i[s];if(o[s].field.isKeyField()){if("string"!=typeof c)throw new xo(Do.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${r}(), but got a ${typeof c}`);if(!je(e)&&-1!==c.indexOf("/"))throw new xo(Do.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${r}() must be a plain document ID, but '${c}' contains a slash.`);const n=e.path.child(Ho.fromString(c));if(!Xo.isDocumentKey(n))throw new xo(Do.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${r}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const i=new Xo(n);a.push(ee(t,i))}else{const e=Os(n,r,c);a.push(e)}}return new Xa(a,s)}(e._query,e.firestore._databaseId,i,t,n,r)}}function Qs(e,t,n){if("string"==typeof(n=Object(So.z)(n))){if(""===n)throw new xo(Do.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!je(t)&&-1!==n.indexOf("/"))throw new xo(Do.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(Ho.fromString(n));if(!Xo.isDocumentKey(r))throw new xo(Do.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ee(e,new Xo(r))}if(n instanceof Vl)return ee(e,n._key);throw new xo(Do.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Zi(n)}.`)}function Ys(e,t){if(!Array.isArray(e)||0===e.length)throw new xo(Do.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Xs(e,t){if(t.isInequality()){const n=Le(e),r=t.field;if(null!==n&&!n.isEqual(r))throw new xo(Do.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${r.toString()}'`);const i=Me(e);null!==i&&Js(e,r,i)}const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw new xo(Do.INVALID_ARGUMENT,n===t.op?`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`:`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}function Js(e,t,n){if(!n.isEqual(t))throw new xo(Do.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}function Zs(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}function eo(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return l()}}function to(e,t){return e instanceof wh&&t instanceof wh?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof Ih&&t instanceof Ih&&e._firestore===t._firestore&&as(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}function no(e){e=es(e,Vl);const t=es(e.firestore,$l);return $i(ls(t),e._key).then((n=>mo(t,e,n)))}function ro(e){e=es(e,Vl);const t=es(e.firestore,$l),n=ls(t),r=new Th(t);return function(e,t){const n=new Mo;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){try{const r=await function(e,t){const n=e;return n.persistence.runTransaction("read document","readonly",(e=>n.localDocuments.getDocument(e,t)))}(e,t);r.isFoundDocument()?n.resolve(r):r.isNoDocument()?n.resolve(null):n.reject(new xo(Do.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(e){const r=Jr(e,`Failed to get document '${t} from cache`);n.reject(r)}}(await Vi(e),t,n))),n.promise}(n,e._key).then((n=>new wh(t,r,e._key,n,new vh(null!==n&&n.hasLocalMutations,!0),e.converter)))}function io(e){e=es(e,Vl);const t=es(e.firestore,$l);return $i(ls(t),e._key,{source:"server"}).then((n=>mo(t,e,n)))}function so(e){e=es(e,Ul);const t=es(e.firestore,$l),n=ls(t),r=new Th(t);return Fs(e._query),Wi(n,e._query).then((n=>new Ih(t,r,e,n)))}function oo(e){e=es(e,Ul);const t=es(e.firestore,$l),n=ls(t),r=new Th(t);return function(e,t){const n=new Mo;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){try{const r=await dr(e,t,!0),i=new Tl(t,r.ss),s=i.sa(r.documents),o=i.applyChanges(s,!1);n.resolve(o.snapshot)}catch(e){const r=Jr(e,`Failed to execute query '${t} against cache`);n.reject(r)}}(await Vi(e),t,n))),n.promise}(n,e._query).then((n=>new Ih(t,r,e,n)))}function ao(e){e=es(e,Ul);const t=es(e.firestore,$l),n=ls(t),r=new Th(t);return Wi(n,e._query,{source:"server"}).then((n=>new Ih(t,r,e,n)))}function co(e,t,n){e=es(e,Vl);const r=es(e.firestore,$l),i=Zs(e.converter,t,n);return go(r,[Es(Ts(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,Ec.none())])}function uo(e,t,n,...r){e=es(e,Vl);const i=es(e.firestore,$l),s=Ts(i);let o;return o="string"==typeof(t=Object(So.z)(t))||t instanceof Gl?Ss(s,"updateDoc",e._key,t,n,r):Cs(s,"updateDoc",e._key,t),go(i,[o.toMutation(e._key,Ec.exists(!0))])}function lo(e){return go(es(e.firestore,$l),[new Oc(e._key,Ec.none())])}function ho(e,t){const n=es(e.firestore,$l),r=ss(e),i=Zs(e.converter,t);return go(n,[Es(Ts(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,Ec.exists(!1))]).then((()=>r))}function fo(e,...t){var n,r,i;e=Object(So.z)(e);let s={includeMetadataChanges:!1},o=0;"object"!=typeof t[o]||cs(t[o])||(s=t[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(cs(t[o])){const e=t[o];t[o]=null===(n=e.next)||void 0===n?void 0:n.bind(e),t[o+1]=null===(r=e.error)||void 0===r?void 0:r.bind(e),t[o+2]=null===(i=e.complete)||void 0===i?void 0:i.bind(e)}let c,u,l;if(e instanceof Vl)u=es(e.firestore,$l),l=De(e._key.path),c={next:n=>{t[o]&&t[o](mo(u,e,n))},error:t[o+1],complete:t[o+2]};else{const n=es(e,Ul);u=es(n.firestore,$l),l=n._query;const r=new Th(u);c={next:e=>{t[o]&&t[o](new Ih(u,r,n,e))},error:t[o+1],complete:t[o+2]},Fs(e._query)}return function(e,t,n,r){const i=new Pl(r),s=new _l(t,i,n);return e.asyncQueue.enqueueAndForget((async()=>Zr(await Ki(e),s))),()=>{i.Ca(),e.asyncQueue.enqueueAndForget((async()=>ei(await Ki(e),s)))}}(ls(u),l,a,c)}function po(e,t){return function(e,t){const n=new Pl(t);return e.asyncQueue.enqueueAndForget((async()=>function(e,t){e.O_.add(t),t.next()}(await Ki(e),n))),()=>{n.Ca(),e.asyncQueue.enqueueAndForget((async()=>function(e,t){e.O_.delete(t)}(await Ki(e),n)))}}(ls(e=es(e,$l)),cs(t)?t:{next:t})}function go(e,t){return function(e,t){const n=new Mo;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=Ri(e);try{const e=await function(e,t){const n=e,r=$o.now(),i=t.reduce(((e,t)=>e.add(t.key)),tt());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let a=Qe(),c=tt();return n.Xi.getEntries(e,i).next((e=>{a=e,a.forEach(((e,t)=>{t.isValidDocument()||(c=c.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,a))).next((i=>{s=i;const o=[];for(const e of t){const t=_t(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new Sc(e.key,t,de(t.value.mapValue),Ec.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)})).next((t=>{o=t;const r=t.applyToLocalDocumentSet(s,c);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:o.batchId,changes:Xe(s)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.fa[e.currentUser.toKey()];r||(r=new La(p)),r=r.insert(t,n),e.fa[e.currentUser.toKey()]=r}(r,e.batchId,n),await wi(r,e.changes),await Ur(r.remoteStore)}catch(e){const t=Jr(e,"Failed to persist write");n.reject(t)}}(await Bi(e),t,n))),n.promise}(ls(e),t)}function mo(e,t,n){const r=n.docs.get(t._key),i=new Th(e);return new wh(e,i,t._key,r,new vh(n.hasPendingWrites,n.fromCache),t.converter)}function _o(e,t){if((e=Object(So.z)(e)).firestore!==t)throw new xo(Do.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function yo(e,t,n){e=es(e,$l);const i=r(r({},Eh),n);return function(e){if(e.maxAttempts<1)throw new xo(Do.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(e,t,n){const r=new Mo;return e.asyncQueue.enqueueAndForget((async()=>{const i=await zi(e);new xl(e.asyncQueue,i,n,t,r).run()})),r.promise}(ls(e),(n=>t(new Ch(e,n))),i)}function vo(){return new th("deleteField")}function wo(){return new nh("serverTimestamp")}function bo(...e){return new rh("arrayUnion",e)}function Io(...e){return new ih("arrayRemove",e)}function To(e){return new sh("increment",e)}n.d(t,"a",(function(){return _h})),n.d(t,"b",(function(){return Wl})),n.d(t,"c",(function(){return Kl})),n.d(t,"d",(function(){return Vl})),n.d(t,"e",(function(){return wh})),n.d(t,"f",(function(){return Gl})),n.d(t,"g",(function(){return xo})),n.d(t,"h",(function(){return Ql})),n.d(t,"i",(function(){return bh})),n.d(t,"j",(function(){return Ih})),n.d(t,"k",(function(){return $o})),n.d(t,"l",(function(){return kh})),n.d(t,"m",(function(){return Wa})),n.d(t,"n",(function(){return Xo})),n.d(t,"o",(function(){return Yo})),n.d(t,"p",(function(){return es})),n.d(t,"q",(function(){return d})),n.d(t,"r",(function(){return V})),n.d(t,"s",(function(){return c})),n.d(t,"t",(function(){return Yi})),n.d(t,"u",(function(){return ho})),n.d(t,"v",(function(){return Io})),n.d(t,"w",(function(){return bo})),n.d(t,"x",(function(){return gs})),n.d(t,"y",(function(){return rs})),n.d(t,"z",(function(){return is})),n.d(t,"A",(function(){return ns})),n.d(t,"B",(function(){return lo})),n.d(t,"C",(function(){return vo})),n.d(t,"D",(function(){return ys})),n.d(t,"E",(function(){return ss})),n.d(t,"F",(function(){return ds})),n.d(t,"G",(function(){return fs})),n.d(t,"H",(function(){return _s})),n.d(t,"I",(function(){return Gs})),n.d(t,"J",(function(){return Ws})),n.d(t,"K",(function(){return ls})),n.d(t,"L",(function(){return go})),n.d(t,"M",(function(){return no})),n.d(t,"N",(function(){return ro})),n.d(t,"O",(function(){return io})),n.d(t,"P",(function(){return so})),n.d(t,"Q",(function(){return oo})),n.d(t,"R",(function(){return ao})),n.d(t,"S",(function(){return us})),n.d(t,"T",(function(){return To})),n.d(t,"U",(function(){return Bs})),n.d(t,"V",(function(){return zs})),n.d(t,"W",(function(){return vs})),n.d(t,"X",(function(){return ws})),n.d(t,"Y",(function(){return fo})),n.d(t,"Z",(function(){return po})),n.d(t,"ab",(function(){return qs})),n.d(t,"bb",(function(){return Us})),n.d(t,"cb",(function(){return as})),n.d(t,"db",(function(){return os})),n.d(t,"eb",(function(){return yo})),n.d(t,"fb",(function(){return wo})),n.d(t,"gb",(function(){return co})),n.d(t,"hb",(function(){return s})),n.d(t,"ib",(function(){return to})),n.d(t,"jb",(function(){return $s})),n.d(t,"kb",(function(){return Ks})),n.d(t,"lb",(function(){return uo})),n.d(t,"mb",(function(){return ms})),n.d(t,"nb",(function(){return Vs}));var Eo=n("xsHj"),ko=n("SgqZ"),Co=n("li6C"),So=n("8HXZ"),Oo=n("Ldkf");const Ao="@firebase/firestore";class No{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}No.UNAUTHENTICATED=new No(null),No.GOOGLE_CREDENTIALS=new No("google-credentials-uid"),No.FIRST_PARTY=new No("first-party-uid"),No.MOCK_USER=new No("mock-user");let Po="10.1.0";const Ro=new Co.b("@firebase/firestore"),Do={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class xo extends So.c{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Mo{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Lo{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class jo{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(No.UNAUTHENTICATED)))}shutdown(){}}class Fo{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Uo{constructor(e){this.t=e,this.currentUser=No.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var n=this;let r=this.i;const i=e=>this.i!==r?(r=this.i,t(e)):Promise.resolve();let s=new Mo;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Mo,e.enqueueRetryable((()=>i(this.currentUser)))};const a=()=>{const t=s;e.enqueueRetryable((async function(){await t.promise,await i(n.currentUser)}))},c=e=>{o("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit((e=>c(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?c(e):(o("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Mo)}}),0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(o("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(h("string"==typeof t.accessToken),new Lo(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return h(null===e||"string"==typeof e),new No(e)}}class Vo{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=No.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class qo{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new Vo(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(No.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Bo{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class zo{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const n=e=>{null!=e.error&&o("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.R;return this.R=e.token,o("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{o("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?r(e):o("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(h("string"==typeof e.token),this.R=e.token,new Bo(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}class Ko{static V(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const r=f(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%62))}return n}}class $o{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new xo(Do.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new xo(Do.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new xo(Do.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new xo(Do.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return $o.fromMillis(Date.now())}static fromDate(e){return $o.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new $o(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?p(this.nanoseconds,e.nanoseconds):p(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Wo{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Wo(e)}static min(){return new Wo(new $o(0,0))}static max(){return new Wo(new $o(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Go{constructor(e,t,n){void 0===t?t=0:t>e.length&&l(),void 0===n?n=e.length-t:n>e.length-t&&l(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Go.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Go?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Ho extends Go{construct(e,t,n){return new Ho(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new xo(Do.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new Ho(t)}static emptyPath(){return new Ho([])}}const Qo=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Yo extends Go{construct(e,t,n){return new Yo(e,t,n)}static isValidIdentifier(e){return Qo.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Yo.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Yo(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new xo(Do.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new xo(Do.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new xo(Do.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new xo(Do.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Yo(t)}static emptyPath(){return new Yo([])}}class Xo{constructor(e){this.path=e}static fromPath(e){return new Xo(Ho.fromString(e))}static fromName(e){return new Xo(Ho.fromString(e).popFirst(5))}static empty(){return new Xo(Ho.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Ho.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Ho.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Xo(new Ho(e.slice()))}}class Jo{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}Jo.UNKNOWN_ID=-1;class Zo{constructor(e,t){this.fieldPath=e,this.kind=t}}class ea{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new ea(0,ta.min())}}class ta{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new ta(Wo.min(),Xo.empty(),-1)}static max(){return new ta(Wo.max(),Xo.empty(),-1)}}const na="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ra{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}class ia{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&l(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ia(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ia?t:ia.resolve(t)}catch(e){return ia.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ia.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ia.reject(t)}static resolve(e){return new ia((t=>{t(e)}))}static reject(e){return new ia(((t,n)=>{n(e)}))}static waitFor(e){return new ia(((t,n)=>{let r=0,i=0,s=!1;e.forEach((e=>{++r,e.next((()=>{++i,s&&i===r&&t()}),(e=>n(e)))})),s=!0,i===r&&t()}))}static or(e){let t=ia.resolve(!1);for(const n of e)t=t.next((e=>e?ia.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new ia(((n,r)=>{const i=e.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const c=a;t(e[c]).next((e=>{s[c]=e,++o,o===i&&n(s)}),(e=>r(e)))}}))}static doWhile(e,t){return new ia(((n,r)=>{const i=()=>{!0===e()?t().next((()=>{i()}),r):n()};i()}))}}class sa{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.m=new Mo,this.transaction.oncomplete=()=>{this.m.resolve()},this.transaction.onabort=()=>{t.error?this.m.reject(new ca(e,t.error)):this.m.resolve()},this.transaction.onerror=t=>{const n=k(t.target.error);this.m.reject(new ca(e,n))}}static open(e,t,n,r){try{return new sa(t,e.transaction(r,n))}catch(e){throw new ca(t,e)}}get g(){return this.m.promise}abort(e){e&&this.m.reject(e),this.aborted||(o("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}p(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new ua(t)}}class oa{constructor(e,t,n){this.name=e,this.version=t,this.S=n,12.2===oa.D(Object(So.A)())&&a("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return o("SimpleDb","Removing database:",e),E(window.indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!Object(So.G)())return!1;if(oa.C())return!0;const e=Object(So.A)(),t=oa.D(e),n=0<t&&t<10,r=oa.F(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||i)}static C(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.M)}static O(e,t){return e.store(t)}static D(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static F(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async N(e){return this.db||(o("SimpleDb","Opening database:",this.name),this.db=await new Promise(((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{t(e.target.result)},r.onblocked=()=>{n(new ca(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{const r=t.target.error;n("VersionError"===r.name?new xo(Do.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===r.name?new xo(Do.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r):new ca(e,r))},r.onupgradeneeded=e=>{o("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);this.S.B(e.target.result,r.transaction,e.oldVersion,this.version).next((()=>{o("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.L&&(this.db.onversionchange=e=>this.L(e)),this.db}k(e){this.L=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,r){const i="readonly"===t;let s=0;for(;;){++s;try{this.db=await this.N(e);const t=sa.open(this.db,e,i?"readonly":"readwrite",n),s=r(t).next((e=>(t.p(),e))).catch((e=>(t.abort(e),ia.reject(e)))).toPromise();return s.catch((()=>{})),await t.g,s}catch(e){const t=e,n="FirebaseError"!==t.name&&s<3;if(o("SimpleDb","Transaction failed with error:",t.message,"Retrying:",n),this.close(),!n)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}class aa{constructor(e){this.q=e,this.K=!1,this.$=null}get isDone(){return this.K}get U(){return this.$}set cursor(e){this.q=e}done(){this.K=!0}W(e){this.$=e}delete(){return E(this.q.delete())}}class ca extends xo{constructor(e,t){super(Do.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}class ua{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(o("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(o("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),E(n)}add(e){return o("SimpleDb","ADD",this.store.name,e,e),E(this.store.add(e))}get(e){return E(this.store.get(e)).next((t=>(void 0===t&&(t=null),o("SimpleDb","GET",this.store.name,e,t),t)))}delete(e){return o("SimpleDb","DELETE",this.store.name,e),E(this.store.delete(e))}count(){return o("SimpleDb","COUNT",this.store.name),E(this.store.count())}G(e,t){const n=this.options(e,t);if(n.index||"function"!=typeof this.store.getAll){const e=this.cursor(n),t=[];return this.j(e,((e,n)=>{t.push(n)})).next((()=>t))}{const e=this.store.getAll(n.range);return new ia(((t,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{t(e.target.result)}}))}}H(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new ia(((e,t)=>{n.onerror=e=>{t(e.target.error)},n.onsuccess=t=>{e(t.target.result)}}))}J(e,t){o("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.Y=!1;const r=this.cursor(n);return this.j(r,((e,t,n)=>n.delete()))}Z(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.j(r,t)}X(e){const t=this.cursor({});return new ia(((n,r)=>{t.onerror=e=>{const t=k(e.target.error);r(t)},t.onsuccess=t=>{const r=t.target.result;r?e(r.primaryKey,r.value).next((e=>{e?r.continue():n()})):n()}}))}j(e,t){const n=[];return new ia(((r,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{const i=e.target.result;if(!i)return void r();const s=new aa(i),o=t(i.primaryKey,i.value,s);if(o instanceof ia){const e=o.catch((e=>(s.done(),ia.reject(e))));n.push(e)}s.isDone?r():null===s.U?i.continue():i.continue(s.U)}})).next((()=>ia.waitFor(n)))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.Y?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}let la=!1;class ha{constructor(e,t){this.asyncQueue=e,this.ee=t,this.task=null}start(){this.te(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}te(e){var t=this;o("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async function(){t.task=null;try{o("IndexBackiller",`Documents written: ${await t.ee.ne()}`)}catch(e){T(e)?o("IndexBackiller","Ignoring IndexedDB error during index backfill: ",e):await I(e)}await t.te(6e4)}))}}class da{constructor(e,t){this.localStore=e,this.persistence=t}async ne(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.re(t,e)))}re(e,t){const n=new Set;let r=t,i=!0;return ia.doWhile((()=>!0===i&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((t=>{if(null!==t&&!n.has(t))return o("IndexBackiller",`Processing collection: ${t}`),this.ie(e,t,r).next((e=>{r-=e,n.add(t)}));i=!1})))).next((()=>t-r))}ie(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next((n=>{const i=n.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next((()=>this.se(r,n))).next((n=>(o("IndexBackiller",`Updating offset: ${n}`),this.localStore.indexManager.updateCollectionGroup(e,t,n)))).next((()=>i.size))}))))}se(e,t){let n=e;return t.changes.forEach(((e,t)=>{const r=w(t);b(r,n)>0&&(n=r)})),new ta(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}class fa{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.oe(e),this._e=e=>t.writeSequenceNumber(e))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this._e&&this._e(e),e}}fa.ae=-1;const pa=["userId","batchId"],ga={},ma=["prefixPath","collectionGroup","readTime","documentId"],_a=["prefixPath","collectionGroup","documentId"],ya=["collectionGroup","readTime","prefixPath","documentId"],va=["canonicalId","targetId"],wa=["targetId","path"],ba=["path","targetId"],Ia=["collectionId","parent"],Ta=["indexId","uid"],Ea=["uid","sequenceNumber"],ka=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Ca=["indexId","uid","orderedDocumentKey"],Sa=["userId","collectionPath","documentId"],Oa=["userId","collectionPath","largestBatchId"],Aa=["userId","collectionGroup","largestBatchId"],Na=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Pa=[...Na,"documentOverlays"],Ra=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Da=Ra,xa=[...Da,"indexConfiguration","indexState","indexEntries"];class Ma extends ra{constructor(e,t){super(),this.ue=e,this.currentSequenceNumber=t}}class La{constructor(e,t){this.comparator=e,this.root=t||Fa.EMPTY}insert(e,t){return new La(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Fa.BLACK,null,null))}remove(e){return new La(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Fa.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ja(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ja(this.root,e,this.comparator,!1)}getReverseIterator(){return new ja(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ja(this.root,e,this.comparator,!0)}}class ja{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Fa{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Fa.RED,this.left=null!=r?r:Fa.EMPTY,this.right=null!=i?i:Fa.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new Fa(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Fa.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Fa.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Fa.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Fa.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw l();if(this.right.isRed())throw l();const e=this.left.check();if(e!==this.right.check())throw l();return e+(this.isRed()?0:1)}}Fa.EMPTY=null,Fa.RED=!0,Fa.BLACK=!1,Fa.EMPTY=new class{constructor(){this.size=0}get key(){throw l()}get value(){throw l()}get color(){throw l()}get left(){throw l()}get right(){throw l()}copy(e,t,n,r,i){return this}insert(e,t,n){return new Fa(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ua{constructor(e){this.comparator=e,this.data=new La(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Va(this.data.getIterator())}getIteratorFrom(e){return new Va(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof Ua))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Ua(this.comparator);return t.data=e,t}}class Va{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class qa{constructor(e){this.fields=e,e.sort(Yo.comparator)}static empty(){return new qa([])}unionWith(e){let t=new Ua(Yo.comparator);for(const e of this.fields)t=t.add(e);for(const n of e)t=t.add(n);return new qa(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return g(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class Ba extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class za{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Ba("Invalid base64 string: "+e):e}}(e);return new za(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new za(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return p(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}za.EMPTY_BYTE_STRING=new za("");const Ka=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);class $a{constructor(e,t,n,r,i,s,o,a,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=c}}class Wa{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Wa("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Wa&&e.projectId===this.projectId&&e.database===this.database}}const Ga={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Ha={nullValue:"NULL_VALUE"};class Qa{constructor(e){this.value=e}static empty(){return new Qa({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!se(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=oe(t)}setAll(e){let t=Yo.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=oe(e):r.push(i.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());se(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return H(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];se(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){j(t,((t,n)=>e[t]=n));for(const t of n)delete e[t]}clone(){return new Qa(oe(this.value))}}class Ya{constructor(e,t,n,r,i,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(e){return new Ya(e,0,Wo.min(),Wo.min(),Wo.min(),Qa.empty(),0)}static newFoundDocument(e,t,n,r){return new Ya(e,1,t,Wo.min(),n,r,0)}static newNoDocument(e,t){return new Ya(e,2,t,Wo.min(),Wo.min(),Qa.empty(),0)}static newUnknownDocument(e,t){return new Ya(e,3,t,Wo.min(),Wo.min(),Qa.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Wo.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Qa.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Qa.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Wo.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Ya&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ya(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Xa{constructor(e,t){this.position=e,this.inclusive=t}}class Ja{constructor(e,t="asc"){this.field=e,this.dir=t}}class Za{}class ec extends Za{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new nc(e,t,n):"array-contains"===t?new sc(e,n):"in"===t?new oc(e,n):"not-in"===t?new ac(e,n):"array-contains-any"===t?new cc(e,n):new ec(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new rc(e,n):new ic(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Y(t,this.value)):null!==t&&G(this.value)===G(t)&&this.matchesComparison(Y(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return l()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class tc extends Za{constructor(e,t){super(),this.filters=e,this.op=t,this.ce=null}static create(e,t){return new tc(e,t)}matches(e){return me(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ce||(this.ce=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ce}getFilters(){return r([],this.filters)}getFirstInequalityField(){const e=this.le((e=>e.isInequality()));return null!==e?e.field:null}le(e){for(const t of this.getFlattenedFilters())if(e(t))return t;return null}}class nc extends ec{constructor(e,t,n){super(e,t,n),this.key=Xo.fromName(n.referenceValue)}matches(e){const t=Xo.comparator(e.key,this.key);return this.matchesComparison(t)}}class rc extends ec{constructor(e,t){super(e,"in",t),this.keys=Ee(0,t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class ic extends ec{constructor(e,t){super(e,"not-in",t),this.keys=Ee(0,t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}class sc extends ec{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ne(t)&&Q(t.arrayValue,this.value)}}class oc extends ec{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Q(this.value.arrayValue,t)}}class ac extends ec{constructor(e,t){super(e,"not-in",t)}matches(e){if(Q(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Q(this.value.arrayValue,t)}}class cc extends ec{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ne(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>Q(this.value.arrayValue,e)))}}class uc{constructor(e,t=null,n=[],r=[],i=null,s=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.he=null}}class lc{constructor(e,t=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.Pe=null,this.Ie=null}}class hc{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[t,r]of n)if(this.equalsFn(t,e))return r}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return void(r[n]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){j(this.inner,((t,n)=>{for(const[t,r]of n)e(t,r)}))}isEmpty(){return F(this.inner)}size(){return this.innerSize}}const dc=new La(Xo.comparator),fc=new La(Xo.comparator),pc=new La(Xo.comparator),gc=new Ua(Xo.comparator),mc=new Ua(p);class _c{constructor(){this._=void 0}}class yc extends _c{}class vc extends _c{constructor(e){super(),this.elements=e}}class wc extends _c{constructor(e){super(),this.elements=e}}class bc extends _c{constructor(e,t){super(),this.serializer=e,this.Te=t}}class Ic{constructor(e,t){this.field=e,this.transform=t}}class Tc{constructor(e,t){this.version=e,this.transformResults=t}}class Ec{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ec}static exists(e){return new Ec(void 0,e)}static updateTime(e){return new Ec(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}class kc{}class Cc extends kc{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Sc extends kc{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}class Oc extends kc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ac extends kc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Nc{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){const r=this.mutations[t];r.key.isEqual(e.key)&&gt(r,e,n[t])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=mt(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=mt(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Ze();return this.mutations.forEach((r=>{const i=e.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=t.has(r.key)?null:o;const a=pt(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(Wo.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),tt())}isEqual(e){return this.batchId===e.batchId&&g(this.mutations,e.mutations,((e,t)=>yt(e,t)))&&g(this.baseMutations,e.baseMutations,((e,t)=>yt(e,t)))}}class Pc{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){h(e.mutations.length===n.length);let r=pc;const i=e.mutations;for(let e=0;e<i.length;e++)r=r.insert(i[e].key,n[e].version);return new Pc(e,t,n,r)}}class Rc{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Dc{constructor(e,t){this.count=e,this.unchangedNames=t}}var xc,Mc;(Mc=xc||(xc={}))[Mc.OK=0]="OK",Mc[Mc.CANCELLED=1]="CANCELLED",Mc[Mc.UNKNOWN=2]="UNKNOWN",Mc[Mc.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Mc[Mc.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Mc[Mc.NOT_FOUND=5]="NOT_FOUND",Mc[Mc.ALREADY_EXISTS=6]="ALREADY_EXISTS",Mc[Mc.PERMISSION_DENIED=7]="PERMISSION_DENIED",Mc[Mc.UNAUTHENTICATED=16]="UNAUTHENTICATED",Mc[Mc.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Mc[Mc.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Mc[Mc.ABORTED=10]="ABORTED",Mc[Mc.OUT_OF_RANGE=11]="OUT_OF_RANGE",Mc[Mc.UNIMPLEMENTED=12]="UNIMPLEMENTED",Mc[Mc.INTERNAL=13]="INTERNAL",Mc[Mc.UNAVAILABLE=14]="UNAVAILABLE",Mc[Mc.DATA_LOSS=15]="DATA_LOSS";class Lc{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return jc}static getOrCreateInstance(){return null===jc&&(jc=new Lc),jc}onExistenceFilterMismatch(e){const t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach((t=>t(e)))}}let jc=null;const Fc=new Oo.e([4294967295,4294967295],0);class Uc{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Vc(`Invalid padding: ${t}`);if(n<0)throw new Vc(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new Vc(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new Vc(`Invalid padding when bitmap length is 0: ${t}`);this.de=8*e.length-t,this.Ae=Oo.e.fromNumber(this.de)}Re(e,t,n){let r=e.add(t.multiply(Oo.e.fromNumber(n)));return 1===r.compare(Fc)&&(r=new Oo.e([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Ae).toNumber()}Ve(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.de)return!1;const t=kt(e),[n,r]=Ct(t);for(let e=0;e<this.hashCount;e++){const t=this.Re(n,r,e);if(!this.Ve(t))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new Uc(i,r,t);return n.forEach((e=>s.insert(e))),s}insert(e){if(0===this.de)return;const t=kt(e),[n,r]=Ct(t);for(let e=0;e<this.hashCount;e++){const t=this.Re(n,r,e);this.me(t)}}me(e){const t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class Vc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class qc{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,Bc.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new qc(Wo.min(),r,new La(p),Qe(),tt())}}class Bc{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Bc(n,t,tt(),tt(),tt())}}class zc{constructor(e,t,n,r){this.fe=e,this.removedTargetIds=t,this.key=n,this.ge=r}}class Kc{constructor(e,t){this.targetId=e,this.pe=t}}class $c{constructor(e,t,n=za.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Wc{constructor(){this.ye=0,this.we=Ot(),this.Se=za.EMPTY_BYTE_STRING,this.be=!1,this.De=!0}get current(){return this.be}get resumeToken(){return this.Se}get ve(){return 0!==this.ye}get Ce(){return this.De}Fe(e){e.approximateByteSize()>0&&(this.De=!0,this.Se=e)}Me(){let e=tt(),t=tt(),n=tt();return this.we.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:l()}})),new Bc(this.Se,this.be,e,t,n)}xe(){this.De=!1,this.we=Ot()}Oe(e,t){this.De=!0,this.we=this.we.insert(e,t)}Ne(e){this.De=!0,this.we=this.we.remove(e)}Be(){this.ye+=1}Le(){this.ye-=1}ke(){this.De=!0,this.be=!0}}class Gc{constructor(e){this.qe=e,this.Qe=new Map,this.Ke=Qe(),this.$e=St(),this.Ue=new La(p)}We(e){for(const t of e.fe)e.ge&&e.ge.isFoundDocument()?this.Ge(t,e.ge):this.ze(t,e.key,e.ge);for(const t of e.removedTargetIds)this.ze(t,e.key,e.ge)}je(e){this.forEachTarget(e,(t=>{const n=this.He(t);switch(e.state){case 0:this.Je(t)&&n.Fe(e.resumeToken);break;case 1:n.Le(),n.ve||n.xe(),n.Fe(e.resumeToken);break;case 2:n.Le(),n.ve||this.removeTarget(t);break;case 3:this.Je(t)&&(n.ke(),n.Fe(e.resumeToken));break;case 4:this.Je(t)&&(this.Ye(t),n.Fe(e.resumeToken));break;default:l()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Qe.forEach(((e,n)=>{this.Je(n)&&t(n)}))}Ze(e){var t,n;const r=e.targetId,i=e.pe.count,s=this.Xe(r);if(s){const o=s.target;if(Oe(o))if(0===i){const e=new Xo(o.path);this.ze(r,e,Ya.newNoDocument(e,Wo.min()))}else h(1===i);else{const s=this.et(r);if(s!==i){const i=this.tt(e,s);if(0!==i.status){this.Ye(r);this.Ue=this.Ue.insert(r,2===i.status?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch")}null===(t=Lc.instance)||void 0===t||t.notifyOnExistenceFilterMismatch(function(e,t,n,r){var i,s,o,a,c,u;const l={localCacheCount:n,existenceFilterCount:r.count},h=r.unchangedNames;return h&&(l.bloomFilter={applied:0===e,hashCount:null!==(i=null==h?void 0:h.hashCount)&&void 0!==i?i:0,bitmapLength:null!==(a=null===(o=null===(s=null==h?void 0:h.bits)||void 0===s?void 0:s.bitmap)||void 0===o?void 0:o.length)&&void 0!==a?a:0,padding:null!==(u=null===(c=null==h?void 0:h.bits)||void 0===c?void 0:c.padding)&&void 0!==u?u:0},t&&(l.bloomFilter.mightContain=t)),l}(i.status,null!==(n=i.nt)&&void 0!==n?n:null,s,e.pe))}}}}tt(e,t){const{unchangedNames:n,count:r}=e.pe;if(!n||!n.bits)return{status:1};const{bits:{bitmap:i="",padding:s=0},hashCount:o=0}=n;let a,u;try{a=z(i).toUint8Array()}catch(e){if(e instanceof Ba)return c("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),{status:1};throw e}try{u=new Uc(a,s,o)}catch(e){return c(e instanceof Vc?"BloomFilter error: ":"Applying bloom filter failed: ",e),{status:1}}const l=e=>{const t=this.qe.rt();return u.mightContain(`projects/${t.projectId}/databases/${t.database}/documents/${e}`)};return 0===u.de?{status:1}:{status:r===t-this.it(e.targetId,l)?0:2,nt:l}}it(e,t){const n=this.qe.getRemoteKeysForTarget(e);let r=0;return n.forEach((n=>{t(n.path.canonicalString())||(this.ze(e,n,null),r++)})),r}st(e){const t=new Map;this.Qe.forEach(((n,r)=>{const i=this.Xe(r);if(i){if(n.current&&Oe(i.target)){const t=new Xo(i.target.path);null!==this.Ke.get(t)||this.ot(r,t)||this.ze(r,t,Ya.newNoDocument(t,e))}n.Ce&&(t.set(r,n.Me()),n.xe())}}));let n=tt();this.$e.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.Xe(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.Ke.forEach(((t,n)=>n.setReadTime(e)));const r=new qc(e,t,this.Ue,this.Ke,n);return this.Ke=Qe(),this.$e=St(),this.Ue=new La(p),r}Ge(e,t){if(!this.Je(e))return;const n=this.ot(e,t.key)?2:0;this.He(e).Oe(t.key,n),this.Ke=this.Ke.insert(t.key,t),this.$e=this.$e.insert(t.key,this._t(t.key).add(e))}ze(e,t,n){if(!this.Je(e))return;const r=this.He(e);this.ot(e,t)?r.Oe(t,1):r.Ne(t),this.$e=this.$e.insert(t,this._t(t).delete(e)),n&&(this.Ke=this.Ke.insert(t,n))}removeTarget(e){this.Qe.delete(e)}et(e){const t=this.He(e).Me();return this.qe.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Be(e){this.He(e).Be()}He(e){let t=this.Qe.get(e);return t||(t=new Wc,this.Qe.set(e,t)),t}_t(e){let t=this.$e.get(e);return t||(t=new Ua(p),this.$e=this.$e.insert(e,t)),t}Je(e){const t=null!==this.Xe(e);return t||o("WatchChangeAggregator","Detected inactive target",e),t}Xe(e){const t=this.Qe.get(e);return t&&t.ve?null:this.qe.ut(e)}Ye(e){this.Qe.set(e,new Wc),this.qe.getRemoteKeysForTarget(e).forEach((t=>{this.ze(e,t,null)}))}ot(e,t){return this.qe.getRemoteKeysForTarget(e).has(t)}}const Hc={asc:"ASCENDING",desc:"DESCENDING"},Qc={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Yc={and:"AND",or:"OR"};class Xc{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}class Jc{constructor(e,t,n,r,i=Wo.min(),s=Wo.min(),o=za.EMPTY_BYTE_STRING,a=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new Jc(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Jc(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Jc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Jc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Zc{constructor(e){this.ct=e}}class eu{getBundleMetadata(e,t){return mn(e).get(t).next((e=>{if(e)return function(e){return{id:e.bundleId,createTime:cn(e.createTime),version:e.version}}(e)}))}saveBundleMetadata(e,t){return mn(e).put(function(e){return{bundleId:e.id,createTime:an(Dt(e.createTime)),version:e.version}}(t))}getNamedQuery(e,t){return _n(e).get(t).next((e=>{if(e)return function(e){return{name:e.name,query:dn(e.bundledQuery),readTime:cn(e.readTime)}}(e)}))}saveNamedQuery(e,t){return _n(e).put(function(e){return{name:e.name,readTime:an(Dt(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}class tu{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){return new tu(e,t.uid||"")}getOverlay(e,t){return yn(e).get(pn(this.userId,t)).next((e=>e?fn(this.serializer,e):null))}getOverlays(e,t){const n=Je();return ia.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){const r=[];return n.forEach(((n,i)=>{const s=new Rc(t,i);r.push(this.ht(e,s))})),ia.waitFor(r)}removeOverlaysForBatchId(e,t,n){const r=new Set;t.forEach((e=>r.add(A(e.getCollectionPath()))));const i=[];return r.forEach((t=>{const r=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,n+1],!1,!0);i.push(yn(e).J("collectionPathOverlayIndex",r))})),ia.waitFor(i)}getOverlaysForCollection(e,t,n){const r=Je(),i=A(t),s=IDBKeyRange.bound([this.userId,i,n],[this.userId,i,Number.POSITIVE_INFINITY],!0);return yn(e).G("collectionPathOverlayIndex",s).next((e=>{for(const t of e){const e=fn(this.serializer,t);r.set(e.getKey(),e)}return r}))}getOverlaysForCollectionGroup(e,t,n,r){const i=Je();let s;const o=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return yn(e).Z({index:"collectionGroupOverlayIndex",range:o},((e,t,n)=>{const o=fn(this.serializer,t);i.size()<r||o.largestBatchId===s?(i.set(o.getKey(),o),s=o.largestBatchId):n.done()})).next((()=>i))}ht(e,t){return yn(e).put(function(e,t,n){const[r,i,s]=pn(t,n.mutation.key);return{userId:t,collectionPath:i,documentId:s,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:Kt(e.ct,n.mutation)}}(this.serializer,this.userId,t))}}class nu{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(B(e.integerValue));else if("doubleValue"in e){const n=B(e.doubleValue);isNaN(n)?this.Et(t,13):(this.Et(t,15),S(n)?t.dt(0):t.dt(n))}else if("timestampValue"in e){const n=e.timestampValue;this.Et(t,20),"string"==typeof n?t.At(n):(t.At(`${n.seconds||""}`),t.dt(n.nanos||0))}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(z(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Et(t,45),t.dt(n.latitude||0),t.dt(n.longitude||0)}else"mapValue"in e?ae(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):l()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){const n=e.fields||{};this.Et(t,55);for(const e of Object.keys(n))this.Rt(e,t),this.It(n[e],t)}wt(e,t){const n=e.values||[];this.Et(t,50);for(const e of n)this.It(e,t)}gt(e,t){this.Et(t,37),Xo.fromName(e).path.forEach((e=>{this.Et(t,60),this.St(e,t)}))}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}}nu.bt=new nu;class ru{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.vt(n.value),n=t.next();this.Ct()}Ft(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Mt(n.value),n=t.next();this.xt()}Ot(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.vt(e);else if(e<2048)this.vt(960|e>>>6),this.vt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.vt(480|e>>>12),this.vt(128|63&e>>>6),this.vt(128|63&e);else{const e=t.codePointAt(0);this.vt(240|e>>>18),this.vt(128|63&e>>>12),this.vt(128|63&e>>>6),this.vt(128|63&e)}}this.Ct()}Nt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Mt(e);else if(e<2048)this.Mt(960|e>>>6),this.Mt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Mt(480|e>>>12),this.Mt(128|63&e>>>6),this.Mt(128|63&e);else{const e=t.codePointAt(0);this.Mt(240|e>>>18),this.Mt(128|63&e>>>12),this.Mt(128|63&e>>>6),this.Mt(128|63&e)}}this.xt()}Bt(e){const t=this.Lt(e),n=wn(t);this.kt(1+n),this.buffer[this.position++]=255&n;for(let e=t.length-n;e<t.length;++e)this.buffer[this.position++]=255&t[e]}qt(e){const t=this.Lt(e),n=wn(t);this.kt(1+n),this.buffer[this.position++]=~(255&n);for(let e=t.length-n;e<t.length;++e)this.buffer[this.position++]=~(255&t[e])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Lt(e){const t=function(e){const t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=0!=(128&t[0]);t[0]^=n?255:128;for(let e=1;e<t.length;++e)t[e]^=n?255:0;return t}vt(e){const t=255&e;0===t?(this.Kt(0),this.Kt(255)):255===t?(this.Kt(255),this.Kt(0)):this.Kt(t)}Mt(e){const t=255&e;0===t?(this.Ut(0),this.Ut(255)):255===t?(this.Ut(255),this.Ut(0)):this.Ut(e)}Ct(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}class iu{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Bt(e)}Tt(){this.Gt.Qt()}}class su{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}}class ou{constructor(){this.Gt=new ru,this.zt=new iu(this.Gt),this.jt=new su(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return 0===e?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}}class au{constructor(e,t,n,r){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=r}Jt(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new au(this.indexId,this.documentKey,this.arrayValue,n)}}class cu{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Yt=e.orderBy,this.Zt=[];for(const t of e.filters){const e=t;e.isInequality()?this.Xt=e:this.Zt.push(e)}}en(e){h(e.collectionGroup===this.collectionId);const t=_(e);if(void 0!==t&&!this.tn(t))return!1;const n=y(e);let r=new Set,i=0,s=0;for(;i<n.length&&this.tn(n[i]);++i)r=r.add(n[i].fieldPath.canonicalString());if(i===n.length)return!0;if(void 0!==this.Xt){if(!r.has(this.Xt.field.canonicalString())){const e=n[i];if(!this.nn(this.Xt,e)||!this.rn(this.Yt[s++],e))return!1}++i}for(;i<n.length;++i){if(s>=this.Yt.length||!this.rn(this.Yt[s++],n[i]))return!1}return!0}tn(e){for(const t of this.Zt)if(this.nn(t,e))return!0;return!1}nn(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;return 2===t.kind===("array-contains"===e.op||"array-contains-any"===e.op)}rn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}class uu{constructor(){this.sn=new lu}addToCollectionParentIndex(e,t){return this.sn.add(t),ia.resolve()}getCollectionParents(e,t){return ia.resolve(this.sn.getEntries(t))}addFieldIndex(e,t){return ia.resolve()}deleteFieldIndex(e,t){return ia.resolve()}getDocumentsMatchingTarget(e,t){return ia.resolve(null)}getIndexType(e,t){return ia.resolve(0)}getFieldIndexes(e,t){return ia.resolve([])}getNextCollectionGroupToUpdate(e){return ia.resolve(null)}getMinOffset(e,t){return ia.resolve(ta.min())}getMinOffsetFromCollectionGroup(e,t){return ia.resolve(ta.min())}updateCollectionGroup(e,t,n){return ia.resolve()}updateIndexEntries(e,t){return ia.resolve()}}class lu{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Ua(Ho.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Ua(Ho.comparator)).toArray()}}const hu=new Uint8Array(0);class du{constructor(e,t){this.user=e,this.databaseId=t,this.on=new lu,this._n=new hc((e=>Ce(e)),((e,t)=>Se(e,t))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.on.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.on.add(t)}));const i={collectionId:n,parent:A(r)};return Rn(e).put(i)}return ia.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[m(t),""],!1,!0);return Rn(e).G(r).next((e=>{for(const r of e){if(r.collectionId!==t)break;n.push(R(r.parent))}return n}))}addFieldIndex(e,t){const n=xn(e),r=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map((e=>[e.fieldPath.canonicalString(),e.kind]))}}(t);delete r.indexId;const i=n.add(r);if(t.indexState){const n=Mn(e);return i.next((e=>{n.put(gn(e,this.user,t.indexState.sequenceNumber,t.indexState.offset))}))}return i.next()}deleteFieldIndex(e,t){const n=xn(e),r=Mn(e),i=Dn(e);return n.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}getDocumentsMatchingTarget(e,t){const n=Dn(e);let r=!0;const i=new Map;return ia.forEach(this.an(t),(t=>this.un(e,t).next((e=>{r&&(r=!!e),i.set(t,e)})))).next((()=>{if(r){let e=tt();const r=[];return ia.forEach(i,((i,s)=>{o("IndexedDbIndexManager",`Using index ${function(e){return`id=${e.indexId}|cg=${e.collectionGroup}|f=${e.fields.map((e=>`${e.fieldPath}:${e.kind}`)).join(",")}`}(i)} to execute ${Ce(t)}`);const a=function(e,t){const n=_(t);if(void 0===n)return null;for(const t of Ae(e,n.fieldPath))switch(t.op){case"array-contains-any":return t.value.arrayValue.values||[];case"array-contains":return[t.value]}return null}(s,i),c=function(e,t){const n=new Map;for(const r of y(t))for(const t of Ae(e,r.fieldPath))switch(t.op){case"==":case"in":n.set(r.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return n.set(r.fieldPath.canonicalString(),t.value),Array.from(n.values())}return null}(s,i),u=function(e,t){const n=[];let r=!0;for(const i of y(t)){const t=0===i.kind?Ne(e,i.fieldPath,e.startAt):Pe(e,i.fieldPath,e.startAt);n.push(t.value),r&&(r=t.inclusive)}return new Xa(n,r)}(s,i),l=function(e,t){const n=[];let r=!0;for(const i of y(t)){const t=0===i.kind?Pe(e,i.fieldPath,e.endAt):Ne(e,i.fieldPath,e.endAt);n.push(t.value),r&&(r=t.inclusive)}return new Xa(n,r)}(s,i),h=this.cn(i,s,u),d=this.cn(i,s,l),f=this.ln(i,s,c),p=this.hn(i.indexId,a,h,u.inclusive,d,l.inclusive,f);return ia.forEach(p,(i=>n.H(i,t.limit).next((t=>{t.forEach((t=>{const n=Xo.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),r.push(n))}))}))))})).next((()=>r))}return ia.resolve(null)}))}an(e){let t=this._n.get(e);return t||(t=0===e.filters.length?[e]:En(tc.create(e.filters,"and")).map((t=>ke(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt))),this._n.set(e,t),t)}hn(e,t,n,r,i,s,o){const a=(null!=t?t.length:1)*Math.max(n.length,i.length),c=a/(null!=t?t.length:1),u=[];for(let l=0;l<a;++l){const a=t?this.Pn(t[l/c]):hu,h=this.In(e,a,n[l%c],r),d=this.Tn(e,a,i[l%c],s),f=o.map((t=>this.In(e,a,t,!0)));u.push(...this.createRange(h,d,f))}return u}In(e,t,n,r){const i=new au(e,Xo.empty(),t,n);return r?i:i.Jt()}Tn(e,t,n,r){const i=new au(e,Xo.empty(),t,n);return r?i.Jt():i}un(e,t){const n=new cu(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((e=>{let t=null;for(const r of e)n.en(r)&&(!t||r.fields.length>t.fields.length)&&(t=r);return t}))}getIndexType(e,t){let n=2;const r=this.an(t);return ia.forEach(r,(t=>this.un(e,t).next((e=>{e?0!==n&&e.fields.length<function(e){let t=new Ua(Yo.comparator),n=!1;for(const r of e.filters)for(const e of r.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?n=!0:t=t.add(e.field));for(const n of e.orderBy)n.field.isKeyField()||(t=t.add(n.field));return t.size+(n?1:0)}(t)&&(n=1):n=0})))).next((()=>function(e){return null!==e.limit}(t)&&r.length>1&&2===n?1:n))}En(e,t){const n=new ou;for(const r of y(e)){const e=t.data.field(r.fieldPath);if(null==e)return null;const i=n.Ht(r.kind);nu.bt.Pt(e,i)}return n.Wt()}Pn(e){const t=new ou;return nu.bt.Pt(e,t.Ht(0)),t.Wt()}dn(e,t){const n=new ou;return nu.bt.Pt(ee(this.databaseId,t),n.Ht(function(e){const t=y(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.Wt()}ln(e,t,n){if(null===n)return[];let r=[];r.push(new ou);let i=0;for(const s of y(e)){const e=n[i++];for(const n of r)if(this.An(t,s.fieldPath)&&ne(e))r=this.Rn(r,s,e);else{const t=n.Ht(s.kind);nu.bt.Pt(e,t)}}return this.Vn(r)}cn(e,t,n){return this.ln(e,t,n.position)}Vn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].Wt();return t}Rn(e,t,n){const r=[...e],i=[];for(const e of n.arrayValue.values||[])for(const n of r){const r=new ou;r.seed(n.Wt()),nu.bt.Pt(e,r.Ht(t.kind)),i.push(r)}return i}An(e,t){return!!e.filters.find((e=>e instanceof ec&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op)))}getFieldIndexes(e,t){const n=xn(e),r=Mn(e);return(t?n.G("collectionGroupIndex",IDBKeyRange.bound(t,t)):n.G()).next((e=>{const t=[];return ia.forEach(e,(e=>r.get([e.indexId,this.uid]).next((n=>{t.push(function(e,t){const n=t?new ea(t.sequenceNumber,new ta(cn(t.readTime),new Xo(R(t.documentKey)),t.largestBatchId)):ea.empty(),r=e.fields.map((([e,t])=>new Zo(Yo.fromServerFormat(e),t)));return new Jo(e.indexId,e.collectionGroup,r,n)}(e,n))})))).next((()=>t))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((e=>0===e.length?null:(e.sort(((e,t)=>{const n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:p(e.collectionGroup,t.collectionGroup)})),e[0].collectionGroup)))}updateCollectionGroup(e,t,n){const r=xn(e),i=Mn(e);return this.mn(e).next((e=>r.G("collectionGroupIndex",IDBKeyRange.bound(t,t)).next((t=>ia.forEach(t,(t=>i.put(gn(t.indexId,this.user,e,n))))))))}updateIndexEntries(e,t){const n=new Map;return ia.forEach(t,((t,r)=>{const i=n.get(t.collectionGroup);return(i?ia.resolve(i):this.getFieldIndexes(e,t.collectionGroup)).next((i=>(n.set(t.collectionGroup,i),ia.forEach(i,(n=>this.fn(e,t,n).next((t=>{const i=this.gn(r,n);return t.isEqual(i)?ia.resolve():this.pn(e,r,n,t,i)})))))))}))}yn(e,t,n,r){return Dn(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.dn(n,t.key),documentKey:t.key.path.toArray()})}wn(e,t,n,r){return Dn(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.dn(n,t.key),t.key.path.toArray()])}fn(e,t,n){const r=Dn(e);let i=new Ua(bn);return r.Z({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.dn(n,t)])},((e,r)=>{i=i.add(new au(n.indexId,t,r.arrayValue,r.directionalValue))})).next((()=>i))}gn(e,t){let n=new Ua(bn);const r=this.En(t,e);if(null==r)return n;const i=_(t);if(null!=i){const s=e.data.field(i.fieldPath);if(ne(s))for(const i of s.arrayValue.values||[])n=n.add(new au(t.indexId,e.key,this.Pn(i),r))}else n=n.add(new au(t.indexId,e.key,hu,r));return n}pn(e,t,n,r,i){o("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const s=[];return function(e,t,n,r,i){const s=e.getIterator(),o=t.getIterator();let a=U(s),c=U(o);for(;a||c;){let e=!1,t=!1;if(a&&c){const r=n(a,c);r<0?t=!0:r>0&&(e=!0)}else null!=a?t=!0:e=!0;e?(r(c),c=U(o)):t?(i(a),a=U(s)):(a=U(s),c=U(o))}}(r,i,bn,(r=>{s.push(this.yn(e,t,n,r))}),(r=>{s.push(this.wn(e,t,n,r))})),ia.waitFor(s)}mn(e){let t=1;return Mn(e).Z({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((e,n,r)=>{r.done(),t=n.sequenceNumber+1})).next((()=>t))}createRange(e,t,n){n=n.sort(((e,t)=>bn(e,t))).filter(((e,t,n)=>!t||0!==bn(e,n[t-1])));const r=[];r.push(e);for(const i of n){const n=bn(i,e),s=bn(i,t);if(0===n)r[0]=e.Jt();else if(n>0&&s<0)r.push(i),r.push(i.Jt());else if(s>0)break}r.push(t);const i=[];for(let e=0;e<r.length;e+=2){if(this.Sn(r[e],r[e+1]))return[];i.push(IDBKeyRange.bound([r[e].indexId,this.uid,r[e].arrayValue,r[e].directionalValue,hu,[]],[r[e+1].indexId,this.uid,r[e+1].arrayValue,r[e+1].directionalValue,hu,[]]))}return i}Sn(e,t){return bn(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Ln)}getMinOffset(e,t){return ia.mapArray(this.an(t),(t=>this.un(e,t).next((e=>e||l())))).next(Ln)}}const fu={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class pu{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new pu(e,pu.DEFAULT_COLLECTION_PERCENTILE,pu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}pu.DEFAULT_COLLECTION_PERCENTILE=10,pu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,pu.DEFAULT=new pu(41943040,pu.DEFAULT_COLLECTION_PERCENTILE,pu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),pu.DISABLED=new pu(-1,0,0);class gu{constructor(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.bn={}}static lt(e,t,n,r){h(""!==e.uid);const i=e.isAuthenticated()?e.uid:"";return new gu(i,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Vn(e).Z({index:"userMutationsIndex",range:n},((e,n,r)=>{t=!1,r.done()})).next((()=>t))}addMutationBatch(e,t,n,r){const i=qn(e),s=Vn(e);return s.add({}).next((o=>{h("number"==typeof o);const a=new Nc(o,t,n,r),c=function(e,t,n){const r=n.baseMutations.map((t=>Kt(e.ct,t))),i=n.mutations.map((t=>Kt(e.ct,t)));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(this.serializer,this.userId,a),u=[];let l=new Ua(((e,t)=>p(e.canonicalString(),t.canonicalString())));for(const e of r){const t=x(this.userId,e.key.path,o);l=l.add(e.key.path.popLast()),u.push(s.put(c)),u.push(i.put(t,ga))}return l.forEach((t=>{u.push(this.indexManager.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((()=>{this.bn[o]=a.keys()})),ia.waitFor(u).next((()=>a))}))}lookupMutationBatch(e,t){return Vn(e).get(t).next((e=>e?(h(e.userId===this.userId),un(this.serializer,e)):null))}Dn(e,t){return this.bn[t]?ia.resolve(this.bn[t]):this.lookupMutationBatch(e,t).next((e=>{if(e){const n=e.keys();return this.bn[t]=n,n}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let i=null;return Vn(e).Z({index:"userMutationsIndex",range:r},((e,t,r)=>{t.userId===this.userId&&(h(t.batchId>=n),i=un(this.serializer,t)),r.done()})).next((()=>i))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return Vn(e).Z({index:"userMutationsIndex",range:t,reverse:!0},((e,t,r)=>{n=t.batchId,r.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Vn(e).G("userMutationsIndex",t).next((e=>e.map((e=>un(this.serializer,e)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=D(this.userId,t.path),r=IDBKeyRange.lowerBound(n),i=[];return qn(e).Z({range:r},((n,r,s)=>{const[o,a,c]=n,u=R(a);if(o===this.userId&&t.path.isEqual(u))return Vn(e).get(c).next((e=>{if(!e)throw l();h(e.userId===this.userId),i.push(un(this.serializer,e))}));s.done()})).next((()=>i))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Ua(p);const r=[];return t.forEach((t=>{const i=D(this.userId,t.path),s=IDBKeyRange.lowerBound(i),o=qn(e).Z({range:s},((e,r,i)=>{const[s,o,a]=e,c=R(o);s===this.userId&&t.path.isEqual(c)?n=n.add(a):i.done()}));r.push(o)})),ia.waitFor(r).next((()=>this.vn(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,i=D(this.userId,n),s=IDBKeyRange.lowerBound(i);let o=new Ua(p);return qn(e).Z({range:s},((e,t,i)=>{const[s,a,c]=e,u=R(a);s===this.userId&&n.isPrefixOf(u)?u.length===r&&(o=o.add(c)):i.done()})).next((()=>this.vn(e,o)))}vn(e,t){const n=[],r=[];return t.forEach((t=>{r.push(Vn(e).get(t).next((e=>{if(null===e)throw l();h(e.userId===this.userId),n.push(un(this.serializer,e))})))})),ia.waitFor(r).next((()=>n))}removeMutationBatch(e,t){return jn(e.ue,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.Cn(t.batchId)})),ia.forEach(n,(t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))))}Cn(e){delete this.bn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return ia.resolve();const n=IDBKeyRange.lowerBound(function(e){return[e]}(this.userId)),r=[];return qn(e).Z({range:n},((e,t,n)=>{if(e[0]===this.userId){const t=R(e[1]);r.push(t)}else n.done()})).next((()=>{h(0===r.length)}))}))}containsKey(e,t){return Un(e,this.userId,t)}Fn(e){return Bn(e).get(this.userId).next((e=>e||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""}))}}class mu{constructor(e){this.Mn=e}next(){return this.Mn+=2,this.Mn}static xn(){return new mu(0)}static On(){return new mu(-1)}}class _u{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Nn(e).next((t=>{const n=new mu(t.highestTargetId);return t.highestTargetId=n.next(),this.Bn(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.Nn(e).next((e=>Wo.fromTimestamp(new $o(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.Nn(e).next((e=>e.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.Nn(e).next((r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.Bn(e,r))))}addTargetData(e,t){return this.Ln(e,t).next((()=>this.Nn(e).next((n=>(n.targetCount+=1,this.kn(t,n),this.Bn(e,n))))))}updateTargetData(e,t){return this.Ln(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>zn(e).delete(t.targetId))).next((()=>this.Nn(e))).next((t=>(h(t.targetCount>0),t.targetCount-=1,this.Bn(e,t))))}removeTargets(e,t,n){let r=0;const i=[];return zn(e).Z(((s,o)=>{const a=ln(o);a.sequenceNumber<=t&&null===n.get(a.targetId)&&(r++,i.push(this.removeTargetData(e,a)))})).next((()=>ia.waitFor(i))).next((()=>r))}forEachTarget(e,t){return zn(e).Z(((e,n)=>{const r=ln(n);t(r)}))}Nn(e){return Kn(e).get("targetGlobalKey").next((e=>(h(null!==e),e)))}Bn(e,t){return Kn(e).put("targetGlobalKey",t)}Ln(e,t){return zn(e).put(hn(this.serializer,t))}kn(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.Nn(e).next((e=>e.targetCount))}getTargetData(e,t){const n=Ce(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let i=null;return zn(e).Z({range:r,index:"queryTargetsIndex"},((e,n,r)=>{const s=ln(n);Se(t,s.target)&&(i=s,r.done())})).next((()=>i))}addMatchingKeys(e,t,n){const r=[],i=$n(e);return t.forEach((t=>{const s=A(t.path);r.push(i.put({targetId:n,path:s})),r.push(this.referenceDelegate.addReference(e,n,t))})),ia.waitFor(r)}removeMatchingKeys(e,t,n){const r=$n(e);return ia.forEach(t,(t=>{const i=A(t.path);return ia.waitFor([r.delete([n,i]),this.referenceDelegate.removeReference(e,n,t)])}))}removeMatchingKeysForTargetId(e,t){const n=$n(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=$n(e);let i=tt();return r.Z({range:n,Y:!0},(e=>{const t=R(e[1]),n=new Xo(t);i=i.add(n)})).next((()=>i))}containsKey(e,t){const n=A(t.path),r=IDBKeyRange.bound([n],[m(n)],!1,!0);let i=0;return $n(e).Z({index:"documentTargetsIndex",Y:!0,range:r},(([e,t],n,r)=>{0!==e&&(i++,r.done())})).next((()=>i>0))}ut(e,t){return zn(e).get(t).next((e=>e?ln(e):null))}}class yu{constructor(e){this.qn=e,this.buffer=new Ua(Wn),this.Qn=0}Kn(){return++this.Qn}$n(e){const t=[e,this.Kn()];if(this.buffer.size<this.qn)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();Wn(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class vu{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Un=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Wn(6e4)}stop(){this.Un&&(this.Un.cancel(),this.Un=null)}get started(){return null!==this.Un}Wn(e){var t=this;o("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Un=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async function(){t.Un=null;try{await t.localStore.collectGarbage(t.garbageCollector)}catch(e){T(e)?o("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e):await I(e)}await t.Wn(3e5)}))}}class wu{constructor(e,t){this.Gn=e,this.params=t}calculateTargetCount(e,t){return this.Gn.zn(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(0===t)return ia.resolve(fa.ae);const n=new yu(t);return this.Gn.forEachTarget(e,(e=>n.$n(e.sequenceNumber))).next((()=>this.Gn.jn(e,(e=>n.$n(e))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.Gn.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Gn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(o("LruGarbageCollector","Garbage collection skipped; disabled"),ia.resolve(fu)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(o("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),fu):this.Hn(e,t)))}getCacheSize(e){return this.Gn.getCacheSize(e)}Hn(e,t){let n,r,s,a,c,u,l;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(o("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,a=Date.now(),this.nthSequenceNumber(e,r)))).next((r=>(n=r,c=Date.now(),this.removeTargets(e,n,t)))).next((t=>(s=t,u=Date.now(),this.removeOrphanedDocuments(e,n)))).next((e=>(l=Date.now(),i()<=Co.a.DEBUG&&o("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${a-h}ms\n\tDetermined least recently used ${r} in `+(c-a)+"ms\n"+`\tRemoved ${s} targets in `+(u-c)+"ms\n"+`\tRemoved ${e} documents in `+(l-u)+"ms\n"+`Total Duration: ${l-h}ms`),ia.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:e}))))}}class bu{constructor(e,t){this.db=e,this.garbageCollector=Gn(this,t)}zn(e){const t=this.Jn(e);return this.db.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}Jn(e){let t=0;return this.jn(e,(()=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}jn(e,t){return this.Yn(e,((e,n)=>t(n)))}addReference(e,t,n){return Hn(e,n)}removeReference(e,t,n){return Hn(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return Hn(e,t)}Zn(e,t){return function(e,t){let n=!1;return Bn(e).X((r=>Un(e,r,t).next((e=>(e&&(n=!0),ia.resolve(!e)))))).next((()=>n))}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.Yn(e,((s,o)=>{if(o<=t){const t=this.Zn(e,s).next((t=>{if(!t)return i++,n.getEntry(e,s).next((()=>(n.removeEntry(s,Wo.min()),$n(e).delete(function(e){return[0,A(e.path)]}(s)))))}));r.push(t)}})).next((()=>ia.waitFor(r))).next((()=>n.apply(e))).next((()=>i))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return Hn(e,t)}Yn(e,t){const n=$n(e);let r,i=fa.ae;return n.Z({index:"documentTargetsIndex"},(([e,n],{path:s,sequenceNumber:o})=>{0===e?(i!==fa.ae&&t(new Xo(R(r)),i),i=o,r=s):i=fa.ae})).next((()=>{i!==fa.ae&&t(new Xo(R(r)),i)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}class Iu{constructor(){this.changes=new hc((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ya.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?ia.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Tu{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return Xn(e).put(n)}removeEntry(e,t,n){return Xn(e).delete(function(e,t){const n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],on(t),n[n.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.Xn(e,n))))}getEntry(e,t){let n=Ya.newInvalidDocument(t);return Xn(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(Jn(t))},((e,r)=>{n=this.er(t,r)})).next((()=>n))}tr(e,t){let n={size:0,document:Ya.newInvalidDocument(t)};return Xn(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(Jn(t))},((e,r)=>{n={document:this.er(t,r),size:Fn(r)}})).next((()=>n))}getEntries(e,t){let n=Qe();return this.nr(e,t,((e,t)=>{const r=this.er(e,t);n=n.insert(e,r)})).next((()=>n))}rr(e,t){let n=Qe(),r=new La(Xo.comparator);return this.nr(e,t,((e,t)=>{const i=this.er(e,t);n=n.insert(e,i),r=r.insert(e,Fn(t))})).next((()=>({documents:n,ir:r})))}nr(e,t,n){if(t.isEmpty())return ia.resolve();let r=new Ua(er);t.forEach((e=>r=r.add(e)));const i=IDBKeyRange.bound(Jn(r.first()),Jn(r.last())),s=r.getIterator();let o=s.getNext();return Xn(e).Z({index:"documentKeyIndex",range:i},((e,t,r)=>{const i=Xo.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;o&&er(o,i)<0;)n(o,null),o=s.getNext();o&&o.isEqual(i)&&(n(o,t),o=s.hasNext()?s.getNext():null),o?r.W(Jn(o)):r.done()})).next((()=>{for(;o;)n(o,null),o=s.hasNext()?s.getNext():null}))}getDocumentsMatchingQuery(e,t,n,r){const i=t.path,s=[i.popLast().toArray(),i.lastSegment(),on(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],o=[i.popLast().toArray(),i.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Xn(e).G(IDBKeyRange.bound(s,o,!0)).next((e=>{let n=Qe();for(const i of e){const e=this.er(Xo.fromSegments(i.prefixPath.concat(i.collectionGroup,i.documentId)),i);e.isFoundDocument()&&($e(t,e)||r.has(e.key))&&(n=n.insert(e.key,e))}return n}))}getAllFromCollectionGroup(e,t,n,r){let i=Qe();const s=Zn(t,n),o=Zn(t,ta.max());return Xn(e).Z({index:"collectionGroupIndex",range:IDBKeyRange.bound(s,o,!0)},((e,t,n)=>{const s=this.er(Xo.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);i=i.insert(s.key,s),i.size===r&&n.done()})).next((()=>i))}newChangeBuffer(e){return new Eu(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((e=>e.byteSize))}getMetadata(e){return Yn(e).get("remoteDocumentGlobalKey").next((e=>(h(!!e),e)))}Xn(e,t){return Yn(e).put("remoteDocumentGlobalKey",t)}er(e,t){if(t){const e=function(e,t){let n;if(t.document)n=zt(e.ct,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const e=Xo.fromSegments(t.noDocument.path),r=cn(t.noDocument.readTime);n=Ya.newNoDocument(e,r),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return l();{const e=Xo.fromSegments(t.unknownDocument.path),r=cn(t.unknownDocument.version);n=Ya.newUnknownDocument(e,r)}}return t.readTime&&n.setReadTime(function(e){const t=new $o(e[0],e[1]);return Wo.fromTimestamp(t)}(t.readTime)),n}(this.serializer,t);if(!e.isNoDocument()||!e.version.isEqual(Wo.min()))return e}return Ya.newInvalidDocument(e)}}class Eu extends Iu{constructor(e,t){super(),this.sr=e,this.trackRemovals=t,this._r=new hc((e=>e.toString()),((e,t)=>e.isEqual(t)))}applyChanges(e){const t=[];let n=0,r=new Ua(((e,t)=>p(e.canonicalString(),t.canonicalString())));return this.changes.forEach(((i,s)=>{const o=this._r.get(i);if(t.push(this.sr.removeEntry(e,i,o.readTime)),s.isValidDocument()){const a=sn(this.sr.serializer,s);r=r.add(i.path.popLast());const c=Fn(a);n+=c-o.size,t.push(this.sr.addEntry(e,i,a))}else if(n-=o.size,this.trackRemovals){const n=sn(this.sr.serializer,s.convertToNoDocument(Wo.min()));t.push(this.sr.addEntry(e,i,n))}})),r.forEach((n=>{t.push(this.sr.indexManager.addToCollectionParentIndex(e,n))})),t.push(this.sr.updateMetadata(e,n)),ia.waitFor(t)}getFromCache(e,t){return this.sr.tr(e,t).next((e=>(this._r.set(t,{size:e.size,readTime:e.document.readTime}),e.document)))}getAllFromCache(e,t){return this.sr.rr(e,t).next((({documents:e,ir:t})=>(t.forEach(((t,n)=>{this._r.set(t,{size:n,readTime:e.get(t).readTime})})),e)))}}class ku{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Cu{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&mt(n.mutation,e,qa.empty(),$o.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,tt()).next((()=>t))))}getLocalViewOfDocuments(e,t,n=tt()){const r=Je();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=Ye();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=Je();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,tt())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let i=Qe();const s=et(),o=et();return t.forEach(((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof Sc)?i=i.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),mt(o.mutation,t,o.mutation.getFieldMask(),$o.now())):s.set(t.key,qa.empty())})),this.recalculateAndSaveOverlays(e,i).next((e=>(e.forEach(((e,t)=>s.set(e,t))),t.forEach(((e,t)=>{var n;return o.set(e,new ku(t,null!==(n=s.get(e))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(e,t){const n=et();let r=new La(((e,t)=>e-t)),i=tt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const i of e)i.keys().forEach((e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||qa.empty();o=i.applyToLocalView(s,o),n.set(e,o);const a=(r.get(i.batchId)||tt()).add(e);r=r.insert(i.batchId,a)}))})).next((()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,c=r.value,u=Ze();c.forEach((e=>{if(!i.has(e)){const r=pt(t.get(e),n.get(e));null!==r&&u.set(e,r),i=i.add(e)}})),s.push(this.documentOverlayCache.saveOverlays(e,a,u))}return ia.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n){return function(e){return Xo.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):je(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):ia.resolve(Je());let o=-1,a=i;return s.next((t=>ia.forEach(t,((t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?ia.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{a=a.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,i))).next((()=>this.computeViews(e,a,t,tt()))).next((e=>({batchId:o,changes:Xe(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Xo(t)).next((e=>{let t=Ye();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n){const r=t.collectionGroup;let i=Ye();return this.indexManager.getCollectionParents(e,r).next((s=>ia.forEach(s,(s=>{const o=function(e,t){return new lc(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(r));return this.getDocumentsMatchingCollectionQuery(e,o,n).next((e=>{e.forEach(((e,t)=>{i=i.insert(e,t)}))}))})).next((()=>i))))}getDocumentsMatchingCollectionQuery(e,t,n){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((i=>(r=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,r)))).next((e=>{r.forEach(((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Ya.newInvalidDocument(r)))}));let n=Ye();return e.forEach(((e,i)=>{const s=r.get(e);void 0!==s&&mt(s.mutation,i,qa.empty(),$o.now()),$e(t,i)&&(n=n.insert(e,i))})),n}))}}class Su{constructor(e){this.serializer=e,this.ar=new Map,this.ur=new Map}getBundleMetadata(e,t){return ia.resolve(this.ar.get(t))}saveBundleMetadata(e,t){return this.ar.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Dt(e.createTime)}}(t)),ia.resolve()}getNamedQuery(e,t){return ia.resolve(this.ur.get(t))}saveNamedQuery(e,t){return this.ur.set(t.name,function(e){return{name:e.name,query:dn(e.bundledQuery),readTime:Dt(e.readTime)}}(t)),ia.resolve()}}class Ou{constructor(){this.overlays=new La(Xo.comparator),this.cr=new Map}getOverlay(e,t){return ia.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Je();return ia.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.ht(e,t,r)})),ia.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.cr.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.cr.delete(n)),ia.resolve()}getOverlaysForCollection(e,t,n){const r=Je(),i=t.length+1,s=new Xo(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return ia.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new La(((e,t)=>e-t));const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=Je(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=Je(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=r)););return ia.resolve(o)}ht(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.cr.get(r.largestBatchId).delete(n.key);this.cr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Rc(t,n));let i=this.cr.get(t);void 0===i&&(i=tt(),this.cr.set(t,i)),this.cr.set(t,i.add(n.key))}}class Au{constructor(){this.lr=new Ua(Nu.hr),this.Pr=new Ua(Nu.Ir)}isEmpty(){return this.lr.isEmpty()}addReference(e,t){const n=new Nu(e,t);this.lr=this.lr.add(n),this.Pr=this.Pr.add(n)}Tr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.Er(new Nu(e,t))}dr(e,t){e.forEach((e=>this.removeReference(e,t)))}Ar(e){const t=new Xo(new Ho([])),n=new Nu(t,e),r=new Nu(t,e+1),i=[];return this.Pr.forEachInRange([n,r],(e=>{this.Er(e),i.push(e.key)})),i}Rr(){this.lr.forEach((e=>this.Er(e)))}Er(e){this.lr=this.lr.delete(e),this.Pr=this.Pr.delete(e)}Vr(e){const t=new Xo(new Ho([])),n=new Nu(t,e),r=new Nu(t,e+1);let i=tt();return this.Pr.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){const t=new Nu(e,0),n=this.lr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Nu{constructor(e,t){this.key=e,this.mr=t}static hr(e,t){return Xo.comparator(e.key,t.key)||p(e.mr,t.mr)}static Ir(e,t){return p(e.mr,t.mr)||Xo.comparator(e.key,t.key)}}class Pu{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.gr=1,this.pr=new Ua(Nu.hr)}checkEmpty(e){return ia.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.gr;this.gr++;const s=new Nc(i,t,n,r);this.mutationQueue.push(s);for(const t of r)this.pr=this.pr.add(new Nu(t.key,i)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return ia.resolve(s)}lookupMutationBatch(e,t){return ia.resolve(this.yr(t))}getNextMutationBatchAfterBatchId(e,t){const n=this.wr(t+1),r=n<0?0:n;return ia.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return ia.resolve(0===this.mutationQueue.length?-1:this.gr-1)}getAllMutationBatches(e){return ia.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Nu(t,0),r=new Nu(t,Number.POSITIVE_INFINITY),i=[];return this.pr.forEachInRange([n,r],(e=>{const t=this.yr(e.mr);i.push(t)})),ia.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Ua(p);return t.forEach((e=>{const t=new Nu(e,0),r=new Nu(e,Number.POSITIVE_INFINITY);this.pr.forEachInRange([t,r],(e=>{n=n.add(e.mr)}))})),ia.resolve(this.Sr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;Xo.isDocumentKey(i)||(i=i.child(""));const s=new Nu(new Xo(i),0);let o=new Ua(p);return this.pr.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.mr)),!0)}),s),ia.resolve(this.Sr(o))}Sr(e){const t=[];return e.forEach((e=>{const n=this.yr(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){h(0===this.br(t.batchId,"removed")),this.mutationQueue.shift();let n=this.pr;return ia.forEach(t.mutations,(r=>{const i=new Nu(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.pr=n}))}Cn(e){}containsKey(e,t){const n=new Nu(t,0),r=this.pr.firstAfterOrEqual(n);return ia.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return ia.resolve()}br(e,t){return this.wr(e)}wr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}yr(e){const t=this.wr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Ru{constructor(e){this.Dr=e,this.docs=new La(Xo.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.Dr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ia.resolve(n?n.document.mutableCopy():Ya.newInvalidDocument(t))}getEntries(e,t){let n=Qe();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Ya.newInvalidDocument(e))})),ia.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=Qe();const s=t.path,o=new Xo(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||b(w(o),n)<=0||(r.has(o.key)||$e(t,o))&&(i=i.insert(o.key,o.mutableCopy()))}return ia.resolve(i)}getAllFromCollectionGroup(e,t,n,r){l()}vr(e,t){return ia.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new Du(this)}getSize(e){return ia.resolve(this.size)}}class Du extends Iu{constructor(e){super(),this.sr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.sr.addEntry(e,r)):this.sr.removeEntry(n)})),ia.waitFor(t)}getFromCache(e,t){return this.sr.getEntry(e,t)}getAllFromCache(e,t){return this.sr.getEntries(e,t)}}class xu{constructor(e){this.persistence=e,this.Cr=new hc((e=>Ce(e)),Se),this.lastRemoteSnapshotVersion=Wo.min(),this.highestTargetId=0,this.Fr=0,this.Mr=new Au,this.targetCount=0,this.Or=mu.xn()}forEachTarget(e,t){return this.Cr.forEach(((e,n)=>t(n))),ia.resolve()}getLastRemoteSnapshotVersion(e){return ia.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ia.resolve(this.Fr)}allocateTargetId(e){return this.highestTargetId=this.Or.next(),ia.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Fr&&(this.Fr=t),ia.resolve()}Ln(e){this.Cr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Or=new mu(t),this.highestTargetId=t),e.sequenceNumber>this.Fr&&(this.Fr=e.sequenceNumber)}addTargetData(e,t){return this.Ln(t),this.targetCount+=1,ia.resolve()}updateTargetData(e,t){return this.Ln(t),ia.resolve()}removeTargetData(e,t){return this.Cr.delete(t.target),this.Mr.Ar(t.targetId),this.targetCount-=1,ia.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Cr.forEach(((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Cr.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)})),ia.waitFor(i).next((()=>r))}getTargetCount(e){return ia.resolve(this.targetCount)}getTargetData(e,t){const n=this.Cr.get(t)||null;return ia.resolve(n)}addMatchingKeys(e,t,n){return this.Mr.Tr(t,n),ia.resolve()}removeMatchingKeys(e,t,n){this.Mr.dr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),ia.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Mr.Ar(t),ia.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Mr.Vr(t);return ia.resolve(n)}containsKey(e,t){return ia.resolve(this.Mr.containsKey(t))}}class Mu{constructor(e,t){this.Nr={},this.overlays={},this.Br=new fa(0),this.Lr=!1,this.Lr=!0,this.referenceDelegate=e(this),this.kr=new xu(this),this.indexManager=new uu,this.remoteDocumentCache=function(e){return new Ru(e)}((e=>this.referenceDelegate.qr(e))),this.serializer=new Zc(t),this.Qr=new Su(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Lr=!1,Promise.resolve()}get started(){return this.Lr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Ou,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Nr[e.toKey()];return n||(n=new Pu(t,this.referenceDelegate),this.Nr[e.toKey()]=n),n}getTargetCache(){return this.kr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Qr}runTransaction(e,t,n){o("MemoryPersistence","Starting transaction:",e);const r=new Lu(this.Br.next());return this.referenceDelegate.Kr(),n(r).next((e=>this.referenceDelegate.$r(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Ur(e,t){return ia.or(Object.values(this.Nr).map((n=>()=>n.containsKey(e,t))))}}class Lu extends ra{constructor(e){super(),this.currentSequenceNumber=e}}class ju{constructor(e){this.persistence=e,this.Wr=new Au,this.Gr=null}static zr(e){return new ju(e)}get jr(){if(this.Gr)return this.Gr;throw l()}addReference(e,t,n){return this.Wr.addReference(n,t),this.jr.delete(n.toString()),ia.resolve()}removeReference(e,t,n){return this.Wr.removeReference(n,t),this.jr.add(n.toString()),ia.resolve()}markPotentiallyOrphaned(e,t){return this.jr.add(t.toString()),ia.resolve()}removeTarget(e,t){this.Wr.Ar(t.targetId).forEach((e=>this.jr.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.jr.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Kr(){this.Gr=new Set}$r(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ia.forEach(this.jr,(n=>{const r=Xo.fromPath(n);return this.Hr(e,r).next((e=>{e||t.removeEntry(r,Wo.min())}))})).next((()=>(this.Gr=null,t.apply(e))))}updateLimboDocument(e,t){return this.Hr(e,t).next((e=>{e?this.jr.delete(t.toString()):this.jr.add(t.toString())}))}qr(e){return 0}Hr(e,t){return ia.or([()=>ia.resolve(this.Wr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ur(e,t)])}}class Fu{constructor(e){this.serializer=e}B(e,t,n,r){const i=new sa("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore("owner")}(e),function(e){e.createObjectStore("mutationQueues",{keyPath:"userId"}),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",pa,{unique:!0}),e.createObjectStore("documentMutations")}(e),tr(e),function(e){e.createObjectStore("remoteDocuments")}(e));let s=ia.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore("targetDocuments"),e.deleteObjectStore("targets"),e.deleteObjectStore("targetGlobal")}(e),tr(e)),s=s.next((()=>function(e){const t=e.store("targetGlobal"),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Wo.min().toTimestamp(),targetCount:0};return t.put("targetGlobalKey",n)}(i)))),n<4&&r>=4&&(0!==n&&(s=s.next((()=>function(e,t){return t.store("mutations").G().next((n=>{e.deleteObjectStore("mutations"),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",pa,{unique:!0});const r=t.store("mutations"),i=n.map((e=>r.put(e)));return ia.waitFor(i)}))}(e,i)))),s=s.next((()=>{!function(e){e.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)}))),n<5&&r>=5&&(s=s.next((()=>this.Yr(i)))),n<6&&r>=6&&(s=s.next((()=>(function(e){e.createObjectStore("remoteDocumentGlobal")}(e),this.Zr(i))))),n<7&&r>=7&&(s=s.next((()=>this.Xr(i)))),n<8&&r>=8&&(s=s.next((()=>this.ei(e,i)))),n<9&&r>=9&&(s=s.next((()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)}))),n<10&&r>=10&&(s=s.next((()=>this.ti(i)))),n<11&&r>=11&&(s=s.next((()=>{!function(e){e.createObjectStore("bundles",{keyPath:"bundleId"})}(e),function(e){e.createObjectStore("namedQueries",{keyPath:"name"})}(e)}))),n<12&&r>=12&&(s=s.next((()=>{!function(e){const t=e.createObjectStore("documentOverlays",{keyPath:Sa});t.createIndex("collectionPathOverlayIndex",Oa,{unique:!1}),t.createIndex("collectionGroupOverlayIndex",Aa,{unique:!1})}(e)}))),n<13&&r>=13&&(s=s.next((()=>function(e){const t=e.createObjectStore("remoteDocumentsV14",{keyPath:ma});t.createIndex("documentKeyIndex",_a),t.createIndex("collectionGroupIndex",ya)}(e))).next((()=>this.ni(e,i))).next((()=>e.deleteObjectStore("remoteDocuments")))),n<14&&r>=14&&(s=s.next((()=>this.ri(e,i)))),n<15&&r>=15&&(s=s.next((()=>function(e){e.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:Ta}).createIndex("sequenceNumberIndex",Ea,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:ka}).createIndex("documentKeyIndex",Ca,{unique:!1})}(e)))),s}Zr(e){let t=0;return e.store("remoteDocuments").Z(((e,n)=>{t+=Fn(n)})).next((()=>{const n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)}))}Yr(e){const t=e.store("mutationQueues"),n=e.store("mutations");return t.G().next((t=>ia.forEach(t,(t=>{const r=IDBKeyRange.bound([t.userId,-1],[t.userId,t.lastAcknowledgedBatchId]);return n.G("userMutationsIndex",r).next((n=>ia.forEach(n,(n=>{h(n.userId===t.userId);const r=un(this.serializer,n);return jn(e,t.userId,r).next((()=>{}))}))))}))))}Xr(e){const t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next((e=>{const r=[];return n.Z((n=>{const i=new Ho(n),s=function(e){return[0,A(e)]}(i);r.push(t.get(s).next((n=>n?ia.resolve():(n=>t.put({targetId:0,path:A(n),sequenceNumber:e.highestListenSequenceNumber}))(i))))})).next((()=>ia.waitFor(r)))}))}ei(e,t){e.createObjectStore("collectionParents",{keyPath:Ia});const n=t.store("collectionParents"),r=new lu,i=e=>{if(r.add(e)){const t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:A(r)})}};return t.store("remoteDocuments").Z({Y:!0},(e=>{const t=new Ho(e);return i(t.popLast())})).next((()=>t.store("documentMutations").Z({Y:!0},(([e,t,n])=>{const r=R(t);return i(r.popLast())}))))}ti(e){const t=e.store("targets");return t.Z(((e,n)=>{const r=ln(n),i=hn(this.serializer,r);return t.put(i)}))}ni(e,t){const n=t.store("remoteDocuments"),r=[];return n.Z(((e,n)=>{const i=t.store("remoteDocumentsV14"),s=function(e){return e.document?new Xo(Ho.fromString(e.document.name).popFirst(5)):e.noDocument?Xo.fromSegments(e.noDocument.path):e.unknownDocument?Xo.fromSegments(e.unknownDocument.path):l()}(n).path.toArray(),o={prefixPath:s.slice(0,s.length-2),collectionGroup:s[s.length-2],documentId:s[s.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(i.put(o))})).next((()=>ia.waitFor(r)))}ri(e,t){const n=t.store("mutations"),r=Qn(this.serializer),i=new Mu(ju.zr,this.serializer.ct);return n.G().next((e=>{const n=new Map;return e.forEach((e=>{var t;let r=null!==(t=n.get(e.userId))&&void 0!==t?t:tt();un(this.serializer,e).keys().forEach((e=>r=r.add(e))),n.set(e.userId,r)})),ia.forEach(n,((e,n)=>{const s=new No(n),o=tu.lt(this.serializer,s),a=i.getIndexManager(s),c=gu.lt(s,this.serializer,a,i.referenceDelegate);return new Cu(r,c,o,a).recalculateAndSaveOverlaysForDocumentKeys(new Ma(t,fa.ae),e).next()}))}))}}const Uu="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Vu{constructor(e,t,n,r,i,s,o,c,u,l,h=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.ii=i,this.window=s,this.document=o,this.si=u,this.oi=l,this._i=h,this.Br=null,this.Lr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ai=null,this.inForeground=!1,this.ui=null,this.ci=null,this.li=Number.NEGATIVE_INFINITY,this.hi=()=>Promise.resolve(),!Vu.v())throw new xo(Do.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new bu(this,r),this.Pi=t+"main",this.serializer=new Zc(c),this.Ii=new oa(this.Pi,this._i,new Fu(this.serializer)),this.kr=new _u(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Qn(this.serializer),this.Qr=new eu,this.window&&this.window.localStorage?this.Ti=this.window.localStorage:(this.Ti=null,!1===l&&a("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ei().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new xo(Do.FAILED_PRECONDITION,Uu);return this.di(),this.Ai(),this.Ri(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.kr.getHighestSequenceNumber(e)))})).then((e=>{this.Br=new fa(e,this.si)})).then((()=>{this.Lr=!0})).catch((e=>(this.Ii&&this.Ii.close(),Promise.reject(e))))}Vi(e){var t=this;return this.hi=async function(n){if(t.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ii.k((async function(t){null===t.newVersion&&await e()}))}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.ii.enqueueAndForget((async function(){t.started&&await t.Ei()})))}Ei(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>rr(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.mi(e).next((e=>{e||(this.isPrimary=!1,this.ii.enqueueRetryable((()=>this.hi(!1))))}))})).next((()=>this.fi(e))).next((t=>this.isPrimary&&!t?this.gi(e).next((()=>!1)):!!t&&this.pi(e).next((()=>!0)))))).catch((e=>{if(T(e))return o("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return o("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.ii.enqueueRetryable((()=>this.hi(e))),this.isPrimary=e}))}mi(e){return nr(e).get("owner").next((e=>ia.resolve(this.yi(e))))}wi(e){return rr(e).delete(this.clientId)}async Si(){if(this.isPrimary&&!this.bi(this.li,18e5)){this.li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(e=>{const t=M(e,"clientMetadata");return t.G().next((e=>{const n=this.Di(e,18e5),r=e.filter((e=>-1===n.indexOf(e)));return ia.forEach(r,(e=>t.delete(e.clientId))).next((()=>r))}))})).catch((()=>[]));if(this.Ti)for(const t of e)this.Ti.removeItem(this.vi(t.clientId))}}Ri(){this.ci=this.ii.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Ei().then((()=>this.Si())).then((()=>this.Ri()))))}yi(e){return!!e&&e.ownerId===this.clientId}fi(e){return this.oi?ia.resolve(!0):nr(e).get("owner").next((t=>{if(null!==t&&this.bi(t.leaseTimestampMs,5e3)&&!this.Ci(t.ownerId)){if(this.yi(t)&&this.networkEnabled)return!0;if(!this.yi(t)){if(!t.allowTabSynchronization)throw new xo(Do.FAILED_PRECONDITION,Uu);return!1}}return!(!this.networkEnabled||!this.inForeground)||rr(e).G().next((e=>void 0===this.Di(e,5e3).find((e=>{if(this.clientId!==e.clientId){if(!this.networkEnabled&&e.networkEnabled||!this.inForeground&&e.inForeground&&this.networkEnabled===e.networkEnabled)return!0}return!1}))))})).next((e=>(this.isPrimary!==e&&o("IndexedDbPersistence",`Client ${e?"is":"is not"} eligible for a primary lease.`),e)))}async shutdown(){this.Lr=!1,this.Fi(),this.ci&&(this.ci.cancel(),this.ci=null),this.Mi(),this.xi(),await this.Ii.runTransaction("shutdown","readwrite",["owner","clientMetadata"],(e=>{const t=new Ma(e,fa.ae);return this.gi(t).next((()=>this.wi(t)))})),this.Ii.close(),this.Oi()}Di(e,t){return e.filter((e=>this.bi(e.updateTimeMs,t)&&!this.Ci(e.clientId)))}Ni(){return this.runTransaction("getActiveClients","readonly",(e=>rr(e).G().next((e=>this.Di(e,18e5).map((e=>e.clientId))))))}get started(){return this.Lr}getMutationQueue(e,t){return gu.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.kr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new du(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return tu.lt(this.serializer,e)}getBundleCache(){return this.Qr}runTransaction(e,t,n){o("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",i=function(e){return 15===e?xa:14===e?Da:13===e?Ra:12===e?Pa:11===e?Na:void l()}(this._i);let s;return this.Ii.runTransaction(e,r,i,(r=>(s=new Ma(r,this.Br?this.Br.next():fa.ae),"readwrite-primary"===t?this.mi(s).next((e=>!!e||this.fi(s))).next((t=>{if(!t)throw a(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ii.enqueueRetryable((()=>this.hi(!1))),new xo(Do.FAILED_PRECONDITION,na);return n(s)})).next((e=>this.pi(s).next((()=>e)))):this.Bi(s).next((()=>n(s)))))).then((e=>(s.raiseOnCommittedEvent(),e)))}Bi(e){return nr(e).get("owner").next((e=>{if(null!==e&&this.bi(e.leaseTimestampMs,5e3)&&!this.Ci(e.ownerId)&&!this.yi(e)&&!(this.oi||this.allowTabSynchronization&&e.allowTabSynchronization))throw new xo(Do.FAILED_PRECONDITION,Uu)}))}pi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return nr(e).put("owner",t)}static v(){return oa.v()}gi(e){const t=nr(e);return t.get("owner").next((e=>this.yi(e)?(o("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):ia.resolve()))}bi(e,t){const n=Date.now();return!(e<n-t||e>n&&(a(`Detected an update time that is in the future: ${e} > ${n}`),1))}di(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ui=()=>{this.ii.enqueueAndForget((()=>(this.inForeground="visible"===this.document.visibilityState,this.Ei())))},this.document.addEventListener("visibilitychange",this.ui),this.inForeground="visible"===this.document.visibilityState)}Mi(){this.ui&&(this.document.removeEventListener("visibilitychange",this.ui),this.ui=null)}Ai(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ai=()=>{this.Fi();const e=/(?:Version|Mobile)\/1[456]/;Object(So.L)()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.ii.enterRestrictedMode(!0),this.ii.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.ai))}xi(){this.ai&&(this.window.removeEventListener("pagehide",this.ai),this.ai=null)}Ci(e){var t;try{const n=null!==(null===(t=this.Ti)||void 0===t?void 0:t.getItem(this.vi(e)));return o("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(e){return a("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}Fi(){if(this.Ti)try{this.Ti.setItem(this.vi(this.clientId),String(Date.now()))}catch(e){a("Failed to set zombie client id.",e)}}Oi(){if(this.Ti)try{this.Ti.removeItem(this.vi(this.clientId))}catch(e){}}vi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}class qu{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Li=n,this.ki=r}static qi(e,t){let n=tt(),r=tt();for(const e of t.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:r=r.add(e.doc.key)}return new qu(e,t.fromCache,n,r)}}class Bu{constructor(){this.Qi=!1}initialize(e,t){this.Ki=e,this.indexManager=t,this.Qi=!0}getDocumentsMatchingQuery(e,t,n,r){return this.$i(e,t).next((i=>i||this.Ui(e,t,r,n))).next((n=>n||this.Wi(e,t)))}$i(e,t){if(xe(t))return ia.resolve(null);let n=Ue(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=qe(t,null,"F"),n=Ue(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const i=tt(...r);return this.Ki.getDocuments(e,i).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const s=this.Gi(t,r);return this.zi(t,s,i,n.readTime)?this.$i(e,qe(t,null,"F")):this.ji(e,s,t,n)}))))})))))}Ui(e,t,n,r){return xe(t)||r.isEqual(Wo.min())?this.Wi(e,t):this.Ki.getDocuments(e,n).next((s=>{const a=this.Gi(t,s);return this.zi(t,a,n,r)?this.Wi(e,t):(i()<=Co.a.DEBUG&&o("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Ke(t)),this.ji(e,a,t,v(r,-1)))}))}Gi(e,t){let n=new Ua(Ge(e));return t.forEach(((t,r)=>{$e(e,r)&&(n=n.add(r))})),n}zi(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Wi(e,t){return i()<=Co.a.DEBUG&&o("QueryEngine","Using full collection scan to execute query:",Ke(t)),this.Ki.getDocumentsMatchingQuery(e,t,ta.min())}ji(e,t,n,r){return this.Ki.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class zu{constructor(e,t,n,r){this.persistence=e,this.Hi=t,this.serializer=r,this.Ji=new La(p),this.Yi=new hc((e=>Ce(e)),Se),this.Zi=new Map,this.Xi=e.getRemoteDocumentCache(),this.kr=e.getTargetCache(),this.Qr=e.getBundleCache(),this.es(n)}es(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Cu(this.Xi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Xi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ji)))}}class Ku{constructor(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}static cs(e,t,n){const r=JSON.parse(n);let i,s="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new xo(r.error.code,r.error.message))),s?new Ku(e,t,r.state,i):(a("SharedClientState",`Failed to parse mutation state for ID '${t}': ${n}`),null)}ls(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class $u{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static cs(e,t){const n=JSON.parse(t);let r,i="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return i&&n.error&&(i="string"==typeof n.error.message&&"string"==typeof n.error.code,i&&(r=new xo(n.error.code,n.error.message))),i?new $u(e,n.state,r):(a("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}ls(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Wu{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static cs(e,t){const n=JSON.parse(t);let r="object"==typeof n&&n.activeTargetIds instanceof Array,i=nt();for(let e=0;r&&e<n.activeTargetIds.length;++e)r=O(n.activeTargetIds[e]),i=i.add(n.activeTargetIds[e]);return r?new Wu(e,i):(a("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Gu{constructor(e,t){this.clientId=e,this.onlineState=t}static cs(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new Gu(t.clientId,t.onlineState):(a("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Hu{constructor(){this.activeTargetIds=nt()}hs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Ps(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ls(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Qu{constructor(e,t,n,r,i){this.window=e,this.ii=t,this.persistenceKey=n,this.Is=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Ts=this.Es.bind(this),this.ds=new La(p),this.started=!1,this.As=[];const s=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Rs=_r(this.persistenceKey,this.Is),this.Vs=function(e){return`firestore_sequence_number_${e}`}(this.persistenceKey),this.ds=this.ds.insert(this.Is,new Hu),this.fs=new RegExp(`^firestore_clients_${s}_([^_]*)$`),this.gs=new RegExp(`^firestore_mutations_${s}_(\\d+)(?:_(.*))?$`),this.ps=new RegExp(`^firestore_targets_${s}_(\\d+)$`),this.ys=function(e){return`firestore_online_state_${e}`}(this.persistenceKey),this.ws=function(e){return`firestore_bundle_loaded_v2_${e}`}(this.persistenceKey),this.window.addEventListener("storage",this.Ts)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ni();for(const t of e){if(t===this.Is)continue;const e=this.getItem(_r(this.persistenceKey,t));if(e){const n=Wu.cs(t,e);n&&(this.ds=this.ds.insert(n.clientId,n))}}this.Ss();const t=this.storage.getItem(this.ys);if(t){const e=this.bs(t);e&&this.Ds(e)}for(const e of this.As)this.Es(e);this.As=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.Vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.vs(this.ds)}isActiveQueryTarget(e){let t=!1;return this.ds.forEach(((n,r)=>{r.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.Cs(e,"pending")}updateMutationState(e,t,n){this.Cs(e,t,n),this.Fs(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const n=this.storage.getItem(vr(this.persistenceKey,e));if(n){const r=$u.cs(e,n);r&&(t=r.state)}}return this.Ms.hs(e),this.Ss(),t}removeLocalQueryTarget(e){this.Ms.Ps(e),this.Ss()}isLocalQueryTarget(e){return this.Ms.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(vr(this.persistenceKey,e))}updateQueryState(e,t,n){this.xs(e,t,n)}handleUserChange(e,t,n){t.forEach((e=>{this.Fs(e)})),this.currentUser=e,n.forEach((e=>{this.addPendingMutation(e)}))}setOnlineState(e){this.Os(e)}notifyBundleLoaded(e){this.Ns(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Ts),this.removeItem(this.Rs),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return o("SharedClientState","READ",e,t),t}setItem(e,t){o("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){o("SharedClientState","REMOVE",e),this.storage.removeItem(e)}Es(e){var t=this;const n=e;if(n.storageArea===this.storage){if(o("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Rs)return void a("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ii.enqueueRetryable((async function(){if(t.started){if(null!==n.key)if(t.fs.test(n.key)){if(null==n.newValue){const e=t.Bs(n.key);return t.Ls(e,null)}{const e=t.ks(n.key,n.newValue);if(e)return t.Ls(e.clientId,e)}}else if(t.gs.test(n.key)){if(null!==n.newValue){const e=t.qs(n.key,n.newValue);if(e)return t.Qs(e)}}else if(t.ps.test(n.key)){if(null!==n.newValue){const e=t.Ks(n.key,n.newValue);if(e)return t.$s(e)}}else if(n.key===t.ys){if(null!==n.newValue){const e=t.bs(n.newValue);if(e)return t.Ds(e)}}else if(n.key===t.Vs){const e=function(e){let t=fa.ae;if(null!=e)try{const n=JSON.parse(e);h("number"==typeof n),t=n}catch(e){a("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(n.newValue);e!==fa.ae&&t.sequenceNumberHandler(e)}else if(n.key===t.ws){const e=t.Us(n.newValue);await Promise.all(e.map((e=>t.syncEngine.Ws(e))))}}else t.As.push(n)}))}}get Ms(){return this.ds.get(this.Is)}Ss(){this.setItem(this.Rs,this.Ms.ls())}Cs(e,t,n){const r=new Ku(this.currentUser,e,t,n),i=yr(this.persistenceKey,this.currentUser,e);this.setItem(i,r.ls())}Fs(e){const t=yr(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Os(e){this.storage.setItem(this.ys,JSON.stringify({clientId:this.Is,onlineState:e}))}xs(e,t,n){const r=vr(this.persistenceKey,e),i=new $u(e,t,n);this.setItem(r,i.ls())}Ns(e){const t=JSON.stringify(Array.from(e));this.setItem(this.ws,t)}Bs(e){const t=this.fs.exec(e);return t?t[1]:null}ks(e,t){const n=this.Bs(e);return Wu.cs(n,t)}qs(e,t){const n=this.gs.exec(e),r=Number(n[1]);return Ku.cs(new No(void 0!==n[2]?n[2]:null),r,t)}Ks(e,t){const n=this.ps.exec(e),r=Number(n[1]);return $u.cs(r,t)}bs(e){return Gu.cs(e)}Us(e){return JSON.parse(e)}async Qs(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Gs(e.batchId,e.state,e.error);o("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}$s(e){return this.syncEngine.zs(e.targetId,e.state,e.error)}Ls(e,t){const n=t?this.ds.insert(e,t):this.ds.remove(e),r=this.vs(this.ds),i=this.vs(n),s=[],o=[];return i.forEach((e=>{r.has(e)||s.push(e)})),r.forEach((e=>{i.has(e)||o.push(e)})),this.syncEngine.js(s,o).then((()=>{this.ds=n}))}Ds(e){this.ds.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}vs(e){let t=nt();return e.forEach(((e,n)=>{t=t.unionWith(n.activeTargetIds)})),t}}class Yu{constructor(){this.Hs=new Hu,this.Js={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Hs.hs(e),this.Js[e]||"not-current"}updateQueryState(e,t,n){this.Js[e]=t}removeLocalQueryTarget(e){this.Hs.Ps(e)}isLocalQueryTarget(e){return this.Hs.activeTargetIds.has(e)}clearQueryState(e){delete this.Js[e]}getAllActiveQueryTargets(){return this.Hs.activeTargetIds}isActiveQueryTarget(e){return this.Hs.activeTargetIds.has(e)}start(){return this.Hs=new Hu,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Xu{Ys(e){}shutdown(){}}class Ju{constructor(){this.Zs=()=>this.Xs(),this.eo=()=>this.no(),this.ro=[],this.io()}Ys(e){this.ro.push(e)}shutdown(){window.removeEventListener("online",this.Zs),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Zs),window.addEventListener("offline",this.eo)}Xs(){o("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ro)e(0)}no(){o("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ro)e(1)}static v(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Zu=null;const el={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class tl{constructor(e){this.so=e.so,this.oo=e.oo}_o(e){this.ao=e}uo(e){this.co=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.so(e)}ho(){this.ao()}Po(e){this.co(e)}Io(e){this.lo(e)}}const nl="WebChannelConnection";class rl extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.To=t+"://"+e.host,this.Eo=`projects/${n}/databases/${r}`,this.Ao="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${r}`}get Ro(){return!1}Vo(e,t,n,r,i){const s=wr(),a=this.mo(e,t);o("RestConnection",`Sending RPC '${e}' ${s}:`,a,n);const u={"google-cloud-resource-prefix":this.Eo,"x-goog-request-params":this.Ao};return this.fo(u,r,i),this.po(e,a,u,n).then((t=>(o("RestConnection",`Received RPC '${e}' ${s}: `,t),t)),(t=>{throw c("RestConnection",`RPC '${e}' ${s} failed with error: `,t,"url: ",a,"request:",n),t}))}yo(e,t,n,r,i,s){return this.Vo(e,t,n,r,i)}fo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Po,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}mo(e,t){return`${this.To}/v1/${t}:${el[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}po(e,t,n,r){const i=wr();return new Promise(((s,a)=>{const c=new Oo.i;c.setWithCredentials(!0),c.listenOnce(Oo.c.COMPLETE,(()=>{try{switch(c.getLastErrorCode()){case Oo.a.NO_ERROR:const t=c.getResponseJson();o(nl,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(t)),s(t);break;case Oo.a.TIMEOUT:o(nl,`RPC '${e}' ${i} timed out`),a(new xo(Do.DEADLINE_EXCEEDED,"Request time out"));break;case Oo.a.HTTP_ERROR:const n=c.getStatus();if(o(nl,`RPC '${e}' ${i} failed with status:`,n,"response text:",c.getResponseText()),n>0){let e=c.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Do).indexOf(t)>=0?t:Do.UNKNOWN}(t.status);a(new xo(e,t.message))}else a(new xo(Do.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new xo(Do.UNAVAILABLE,"Connection failed."));break;default:l()}}finally{o(nl,`RPC '${e}' ${i} completed.`)}}));const u=JSON.stringify(r);o(nl,`RPC '${e}' ${i} sending request:`,r),c.send(t,"POST",u,n,15)}))}wo(e,t,n){const r=wr(),i=[this.To,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=Object(Oo.j)(),a=Object(Oo.k)(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(u.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(u.xmlHttpFactory=new Oo.d({})),this.fo(u.initMessageHeaders,t,n),u.encodeInitMessageHeaders=!0;const d=i.join("");o(nl,`Creating RPC '${e}' stream ${r}: ${d}`,u);const f=s.createWebChannel(d,u);let p=!1,g=!1;const m=new tl({so:t=>{g?o(nl,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(p||(o(nl,`Opening RPC '${e}' stream ${r} transport.`),f.open(),p=!0),o(nl,`RPC '${e}' stream ${r} sending:`,t),f.send(t))},oo:()=>f.close()}),_=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return _(f,Oo.h.EventType.OPEN,(()=>{g||o(nl,`RPC '${e}' stream ${r} transport opened.`)})),_(f,Oo.h.EventType.CLOSE,(()=>{g||(g=!0,o(nl,`RPC '${e}' stream ${r} transport closed`),m.Po())})),_(f,Oo.h.EventType.ERROR,(t=>{g||(g=!0,c(nl,`RPC '${e}' stream ${r} transport errored:`,t),m.Po(new xo(Do.UNAVAILABLE,"The operation could not be completed")))})),_(f,Oo.h.EventType.MESSAGE,(t=>{var n;if(!g){const i=t.data[0];h(!!i);const s=i.error||(null===(n=i[0])||void 0===n?void 0:n.error);if(s){o(nl,`RPC '${e}' stream ${r} received error:`,s);const t=s.status;let n=function(e){const t=xc[e];if(void 0!==t)return Tt(t)}(t),i=s.message;void 0===n&&(n=Do.INTERNAL,i="Unknown error status: "+t+" with message "+s.message),g=!0,m.Po(new xo(n,i)),f.close()}else o(nl,`RPC '${e}' stream ${r} received:`,i),m.Io(i)}})),_(a,Oo.b.STAT_EVENT,(t=>{t.stat===Oo.g.PROXY?o(nl,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===Oo.g.NOPROXY&&o(nl,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{m.ho()}),0),m}}class il{constructor(e,t,n=1e3,r=1.5,i=6e4){this.ii=e,this.timerId=t,this.So=n,this.bo=r,this.Do=i,this.vo=0,this.Co=null,this.Fo=Date.now(),this.reset()}reset(){this.vo=0}Mo(){this.vo=this.Do}xo(e){this.cancel();const t=Math.floor(this.vo+this.Oo()),n=Math.max(0,Date.now()-this.Fo),r=Math.max(0,t-n);r>0&&o("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.vo} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Co=this.ii.enqueueAfterDelay(this.timerId,r,(()=>(this.Fo=Date.now(),e()))),this.vo*=this.bo,this.vo<this.So&&(this.vo=this.So),this.vo>this.Do&&(this.vo=this.Do)}No(){null!==this.Co&&(this.Co.skipDelay(),this.Co=null)}cancel(){null!==this.Co&&(this.Co.cancel(),this.Co=null)}Oo(){return(Math.random()-.5)*this.vo}}class sl{constructor(e,t,n,r,i,s,o,a){this.ii=e,this.Bo=n,this.Lo=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.ko=0,this.qo=null,this.Qo=null,this.stream=null,this.Ko=new il(e,t)}$o(){return 1===this.state||5===this.state||this.Uo()}Uo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Wo()}async stop(){this.$o()&&await this.close(0)}Go(){this.state=0,this.Ko.reset()}zo(){this.Uo()&&null===this.qo&&(this.qo=this.ii.enqueueAfterDelay(this.Bo,6e4,(()=>this.jo())))}Ho(e){this.Jo(),this.stream.send(e)}async jo(){if(this.Uo())return this.close(0)}Jo(){this.qo&&(this.qo.cancel(),this.qo=null)}Yo(){this.Qo&&(this.Qo.cancel(),this.Qo=null)}async close(e,t){this.Jo(),this.Yo(),this.Ko.cancel(),this.ko++,4!==e?this.Ko.reset():t&&t.code===Do.RESOURCE_EXHAUSTED?(a(t.toString()),a("Using maximum backoff delay to prevent overloading the backend."),this.Ko.Mo()):t&&t.code===Do.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Zo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.uo(t)}Zo(){}auth(){this.state=1;const e=this.Xo(this.ko),t=this.ko;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([e,n])=>{this.ko===t&&this.e_(e,n)}),(t=>{e((()=>{const e=new xo(Do.UNKNOWN,"Fetching auth token failed: "+t.message);return this.t_(e)}))}))}e_(e,t){const n=this.Xo(this.ko);this.stream=this.n_(e,t),this.stream._o((()=>{n((()=>(this.state=2,this.Qo=this.ii.enqueueAfterDelay(this.Lo,1e4,(()=>(this.Uo()&&(this.state=3),Promise.resolve()))),this.listener._o())))})),this.stream.uo((e=>{n((()=>this.t_(e)))})),this.stream.onMessage((e=>{n((()=>this.onMessage(e)))}))}Wo(){var e=this;this.state=5,this.Ko.xo((async function(){e.state=0,e.start()}))}t_(e){return o("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return t=>{this.ii.enqueueAndForget((()=>this.ko===e?t():(o("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class ol extends sl{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}n_(e,t){return this.connection.wo("Listen",e,t)}onMessage(e){this.Ko.reset();const t=function(e,t){let n;if("targetChange"in t){const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:l()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(h(void 0===t||"string"==typeof t),za.fromBase64String(t||"")):(h(void 0===t||t instanceof Uint8Array),za.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?Do.UNKNOWN:Tt(e.code);return new xo(t,e.message||"")}(o);n=new $c(r,i,s,a||null)}else if("documentChange"in t){const r=t.documentChange,i=jt(e,r.document.name),s=Dt(r.document.updateTime),o=r.document.createTime?Dt(r.document.createTime):Wo.min(),a=new Qa({mapValue:{fields:r.document.fields}}),c=Ya.newFoundDocument(i,s,o,a);n=new zc(r.targetIds||[],r.removedTargetIds||[],c.key,c)}else if("documentDelete"in t){const r=t.documentDelete,i=jt(e,r.document),s=r.readTime?Dt(r.readTime):Wo.min(),o=Ya.newNoDocument(i,s);n=new zc([],r.removedTargetIds||[],o.key,o)}else if("documentRemove"in t){const r=t.documentRemove,i=jt(e,r.document);n=new zc([],r.removedTargetIds||[],i,null)}else{if(!("filter"in t))return l();{const e=t.filter,{count:r=0,unchangedNames:i}=e,s=new Dc(r,i);n=new Kc(e.targetId,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return Wo.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?Wo.min():t.readTime?Dt(t.readTime):Wo.min()}(e);return this.listener.r_(t,n)}i_(e){const t={};t.database=Vt(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=Oe(r)?{documents:Wt(e,r)}:{query:Gt(e,r)},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Pt(e,t.resumeToken);const r=At(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(Wo.min())>0){n.readTime=Nt(e,t.snapshotVersion.toTimestamp());const r=At(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return l()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(0,e);n&&(t.labels=n),this.Ho(t)}s_(e){const t={};t.database=Vt(this.serializer),t.removeTarget=e,this.Ho(t)}}class al extends sl{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i,this.o_=!1}get __(){return this.o_}start(){this.o_=!1,this.lastStreamToken=void 0,super.start()}Zo(){this.o_&&this.a_([])}n_(e,t){return this.connection.wo("Write",e,t)}onMessage(e){if(h(!!e.streamToken),this.lastStreamToken=e.streamToken,this.o_){this.Ko.reset();const t=function(e,t){return e&&e.length>0?(h(void 0!==t),e.map((e=>function(e,t){let n=Dt(e.updateTime?e.updateTime:t);return n.isEqual(Wo.min())&&(n=Dt(t)),new Tc(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=Dt(e.commitTime);return this.listener.u_(n,t)}return h(!e.writeResults||0===e.writeResults.length),this.o_=!0,this.listener.c_()}l_(){const e={};e.database=Vt(this.serializer),this.Ho(e)}a_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>Kt(this.serializer,e)))};this.Ho(t)}}class cl extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.h_=!1}P_(){if(this.h_)throw new xo(Do.FAILED_PRECONDITION,"The client has already been terminated.")}Vo(e,t,n){return this.P_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,i])=>this.connection.Vo(e,t,n,r,i))).catch((e=>{throw"FirebaseError"===e.name?(e.code===Do.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new xo(Do.UNKNOWN,e.toString())}))}yo(e,t,n,r){return this.P_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,s])=>this.connection.yo(e,t,n,i,s,r))).catch((e=>{throw"FirebaseError"===e.name?(e.code===Do.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new xo(Do.UNKNOWN,e.toString())}))}terminate(){this.h_=!0}}class ul{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.T_=0,this.E_=null,this.d_=!0}A_(){0===this.T_&&(this.R_("Unknown"),this.E_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.E_=null,this.V_("Backend didn't respond within 10 seconds."),this.R_("Offline"),Promise.resolve()))))}m_(e){"Online"===this.state?this.R_("Unknown"):(this.T_++,this.T_>=1&&(this.f_(),this.V_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.R_("Offline")))}set(e){this.f_(),this.T_=0,"Online"===e&&(this.d_=!1),this.R_(e)}R_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}V_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.d_?(a(t),this.d_=!1):o("OnlineStateTracker",t)}f_(){null!==this.E_&&(this.E_.cancel(),this.E_=null)}}class ll{constructor(e,t,n,r,i){var s=this;this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.g_=[],this.p_=new Map,this.y_=new Set,this.w_=[],this.S_=i,this.S_.Ys((()=>{n.enqueueAndForget((async function(){Rr(s)&&(o("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=e;t.y_.add(4),await kr(t),t.b_.set("Unknown"),t.y_.delete(4),await Er(t)}(s))}))})),this.b_=new ul(n,r)}}class hl{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Mo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((()=>{}))}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new hl(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new xo(Do.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}class dl{constructor(e){this.comparator=e?(t,n)=>e(t,n)||Xo.comparator(t.key,n.key):(e,t)=>Xo.comparator(e.key,t.key),this.keyedMap=Ye(),this.sortedSet=new La(this.comparator)}static emptySet(e){return new dl(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof dl))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new dl;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class fl{constructor(){this.F_=new La(Xo.comparator)}track(e){const t=e.doc.key,n=this.F_.get(t);n?0!==e.type&&3===n.type?this.F_=this.F_.insert(t,e):3===e.type&&1!==n.type?this.F_=this.F_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.F_=this.F_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.F_=this.F_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.F_=this.F_.remove(t):1===e.type&&2===n.type?this.F_=this.F_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.F_=this.F_.insert(t,{type:2,doc:e.doc}):l():this.F_=this.F_.insert(t,e)}M_(){const e=[];return this.F_.inorderTraversal(((t,n)=>{e.push(n)})),e}}class pl{constructor(e,t,n,r,i,s,o,a,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=c}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach((e=>{s.push({type:0,doc:e})})),new pl(e,t,dl.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Be(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==n[e].type||!t[e].doc.isEqual(n[e].doc))return!1;return!0}}class gl{constructor(){this.x_=void 0,this.listeners=[]}}class ml{constructor(){this.queries=new hc((e=>ze(e)),Be),this.onlineState="Unknown",this.O_=new Set}}class _l{constructor(e,t,n){this.query=e,this.L_=t,this.k_=!1,this.q_=null,this.onlineState="Unknown",this.options=n||{}}B_(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new pl(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.k_?this.Q_(e)&&(this.L_.next(e),t=!0):this.K_(e,this.onlineState)&&(this.U_(e),t=!0),this.q_=e,t}onError(e){this.L_.error(e)}N_(e){this.onlineState=e;let t=!1;return this.q_&&!this.k_&&this.K_(this.q_,e)&&(this.U_(this.q_),t=!0),t}K_(e,t){if(!e.fromCache)return!0;return(!this.options.W_||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Q_(e){if(e.docChanges.length>0)return!0;return!(!e.syncStateChanged&&!(this.q_&&this.q_.hasPendingWrites!==e.hasPendingWrites))&&!0===this.options.includeMetadataChanges}U_(e){e=pl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.k_=!0,this.L_.next(e)}}class yl{constructor(e,t){this.G_=e,this.byteLength=t}z_(){return"metadata"in this.G_}}class vl{constructor(e){this.serializer=e}os(e){return jt(this.serializer,e)}_s(e){return e.metadata.exists?zt(this.serializer,e.document,!1):Ya.newNoDocument(this.os(e.metadata.name),this.us(e.metadata.readTime))}us(e){return Dt(e)}}class wl{constructor(e,t,n){this.j_=e,this.localStore=t,this.serializer=n,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=ii(e)}H_(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.G_.namedQuery)this.queries.push(e.G_.namedQuery);else if(e.G_.documentMetadata){this.documents.push({metadata:e.G_.documentMetadata}),e.G_.documentMetadata.exists||++t;const n=Ho.fromString(e.G_.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.G_.document&&(this.documents[this.documents.length-1].document=e.G_.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,r({},this.progress)):null}J_(e){const t=new Map,n=new vl(this.serializer);for(const r of e)if(r.metadata.queries){const e=n.os(r.metadata.name);for(const n of r.metadata.queries){const r=(t.get(n)||tt()).add(e);t.set(n,r)}}return t}async complete(){const e=await async function(e,t,n,r){const i=e;let s=tt(),o=Qe();for(const e of n){const n=t.os(e.metadata.name);e.document&&(s=s.add(n));const r=t._s(e);r.setReadTime(t.us(e.metadata.readTime)),o=o.insert(n,r)}const a=i.Xi.newChangeBuffer({trackRemovals:!0}),c=await lr(i,function(e){return Ue(De(Ho.fromString(`__bundle__/docs/${e}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",(e=>cr(e,a,o).next((t=>(a.apply(e),t))).next((t=>i.kr.removeMatchingKeysForTargetId(e,c.targetId).next((()=>i.kr.addMatchingKeys(e,s,c.targetId))).next((()=>i.localDocuments.getLocalViewOfDocuments(e,t.ns,t.rs))).next((()=>t.ns))))))}(this.localStore,new vl(this.serializer),this.documents,this.j_.id),t=this.J_(this.documents);for(const e of this.queries)await mr(this.localStore,e,t.get(e.name));return this.progress.taskState="Success",{progress:this.progress,Y_:this.collectionGroups,Z_:e}}}class bl{constructor(e){this.key=e}}class Il{constructor(e){this.key=e}}class Tl{constructor(e,t){this.query=e,this.X_=t,this.ea=null,this.hasCachedResults=!1,this.current=!1,this.ta=tt(),this.mutatedKeys=tt(),this.na=Ge(e),this.ra=new dl(this.na)}get ia(){return this.X_}sa(e,t){const n=t?t.oa:new fl,r=t?t.ra:this.ra;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,c="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const u=r.get(e),l=$e(this.query,t)?t:null,h=!!u&&this.mutatedKeys.has(u.key),d=!!l&&(l.hasLocalMutations||this.mutatedKeys.has(l.key)&&l.hasCommittedMutations);let f=!1;u&&l?u.data.isEqual(l.data)?h!==d&&(n.track({type:3,doc:l}),f=!0):this._a(u,l)||(n.track({type:2,doc:l}),f=!0,(a&&this.na(l,a)>0||c&&this.na(l,c)<0)&&(o=!0)):!u&&l?(n.track({type:0,doc:l}),f=!0):u&&!l&&(n.track({type:1,doc:u}),f=!0,(a||c)&&(o=!0)),f&&(l?(s=s.add(l),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))})),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{ra:s,oa:n,zi:o,mutatedKeys:i}}_a(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const r=this.ra;this.ra=e.ra,this.mutatedKeys=e.mutatedKeys;const i=e.oa.M_();i.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return l()}};return n(e)-n(t)}(e.type,t.type)||this.na(e.doc,t.doc))),this.aa(n);const s=t?this.ua():[],o=0===this.ta.size&&this.current?1:0,a=o!==this.ea;return this.ea=o,0!==i.length||a?{snapshot:new pl(this.query,e.ra,r,i,e.mutatedKeys,0===o,a,!1,!!n&&n.resumeToken.approximateByteSize()>0),ca:s}:{ca:s}}N_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ra:this.ra,oa:new fl,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{ca:[]}}la(e){return!this.X_.has(e)&&!!this.ra.has(e)&&!this.ra.get(e).hasLocalMutations}aa(e){e&&(e.addedDocuments.forEach((e=>this.X_=this.X_.add(e))),e.modifiedDocuments.forEach((()=>{})),e.removedDocuments.forEach((e=>this.X_=this.X_.delete(e))),this.current=e.current)}ua(){if(!this.current)return[];const e=this.ta;this.ta=tt(),this.ra.forEach((e=>{this.la(e.key)&&(this.ta=this.ta.add(e.key))}));const t=[];return e.forEach((e=>{this.ta.has(e)||t.push(new Il(e))})),this.ta.forEach((n=>{e.has(n)||t.push(new bl(n))})),t}ha(e){this.X_=e.ss,this.ta=tt();const t=this.sa(e.documents);return this.applyChanges(t,!0)}Pa(){return pl.fromInitialDocuments(this.query,this.ra,this.mutatedKeys,0===this.ea,this.hasCachedResults)}}class El{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class kl{constructor(e){this.key=e,this.Ia=!1}}class Cl{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Ta={},this.Ea=new hc((e=>ze(e)),Be),this.da=new Map,this.Aa=new Set,this.Ra=new La(Xo.comparator),this.Va=new Map,this.ma=new Au,this.fa={},this.ga=new Map,this.pa=mu.On(),this.onlineState="Unknown",this.ya=void 0}get isPrimaryClient(){return!0===this.ya}}class Sl{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=Tr(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return sr(this.persistence,new Bu,e.initialUser,this.serializer)}createPersistence(e){return new Mu(ju.zr,this.serializer)}createSharedClientState(e){return new Yu}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Ol extends Sl{constructor(e,t,n){super(),this.Da=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Da.initialize(this,e),await Ri(this.Da.syncEngine),await Ur(this.Da.remoteStore),await this.persistence.Vi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}createLocalStore(e){return sr(this.persistence,new Bu,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){return new vu(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const n=new da(t,this.persistence);return new ha(e.asyncQueue,n)}createPersistence(e){const t=ir(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?pu.withCacheSize(this.cacheSizeBytes):pu.DEFAULT;return new Vu(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,br(),Ir(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new Yu}}class Al extends Ol{constructor(e,t){super(e,t,!1),this.Da=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){var t=this;await super.initialize(e);const n=this.Da.syncEngine;this.sharedClientState instanceof Qu&&(this.sharedClientState.syncEngine={Gs:ki.bind(null,n),zs:Ai.bind(null,n),js:Ni.bind(null,n),Ni:Oi.bind(null,n),Ws:Ei.bind(null,n)},await this.sharedClientState.start()),await this.persistence.Vi((async function(e){await async function(e,t){const n=e;if(Pi(n),Ri(n),!0===t&&!0!==n.ya){const e=n.sharedClientState.getAllActiveQueryTargets(),t=await Ci(n,e.toArray());n.ya=!0,await Qr(n.remoteStore,!0);for(const e of t)Cr(n.remoteStore,e)}else if(!1===t&&!1!==n.ya){const e=[];let t=Promise.resolve();n.da.forEach(((r,i)=>{n.sharedClientState.isLocalQueryTarget(i)?e.push(i):t=t.then((()=>(gi(n,i),hr(n.localStore,i,!0)))),Sr(n.remoteStore,i)})),await t,await Ci(n,e),function(e){const t=e;t.Va.forEach(((e,n)=>{Sr(t.remoteStore,n)})),t.ma.Rr(),t.Va=new Map,t.Ra=new La(Xo.comparator)}(n),n.ya=!1,await Qr(n.remoteStore,!1)}}(t.Da.syncEngine,e),t.gcScheduler&&(e&&!t.gcScheduler.started?t.gcScheduler.start():e||t.gcScheduler.stop()),t.indexBackfillerScheduler&&(e&&!t.indexBackfillerScheduler.started?t.indexBackfillerScheduler.start():e||t.indexBackfillerScheduler.stop())}))}createSharedClientState(e){const t=br();if(!Qu.v(t))throw new xo(Do.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=ir(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Qu(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class Nl{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>ui(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=bi.bind(null,this.syncEngine),await Qr(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new ml}createDatastore(e){const t=Tr(e.databaseInfo.databaseId),n=function(e){return new rl(e)}(e.databaseInfo);return function(e,t,n,r){return new cl(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new ll(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,(e=>ui(this.syncEngine,e,0)),Ju.v()?new Ju:new Xu)}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new Cl(e,t,n,r,i,s);return o&&(a.ya=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=e;o("RemoteStore","RemoteStore shutting down."),t.y_.add(5),await kr(t),t.S_.shutdown(),t.b_.set("Unknown")}(this.remoteStore)}}class Pl{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.va(this.observer.next,e)}error(e){this.observer.error?this.va(this.observer.error,e):a("Uncaught Error in snapshot listener:",e.toString())}Ca(){this.muted=!0}va(e,t){this.muted||setTimeout((()=>{this.muted||e(t)}),0)}}class Rl{constructor(e,t){this.Fa=e,this.serializer=t,this.metadata=new Mo,this.buffer=new Uint8Array,this.Ma=new TextDecoder("utf-8"),this.xa().then((e=>{e&&e.z_()?this.metadata.resolve(e.G_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==e?void 0:e.G_)}`))}),(e=>this.metadata.reject(e)))}close(){return this.Fa.cancel()}async getMetadata(){return this.metadata.promise}async ba(){return await this.getMetadata(),this.xa()}async xa(){const e=await this.Oa();if(null===e)return null;const t=this.Ma.decode(e),n=Number(t);isNaN(n)&&this.Na(`length string (${t}) is not valid number`);const r=await this.Ba(n);return new yl(JSON.parse(r),e.length+n)}La(){return this.buffer.findIndex((e=>e==="{".charCodeAt(0)))}async Oa(){for(;this.La()<0&&!await this.ka(););if(0===this.buffer.length)return null;const e=this.La();e<0&&this.Na("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Ba(e){for(;this.buffer.length<e;)await this.ka()&&this.Na("Reached the end of bundle when more is expected.");const t=this.Ma.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Na(e){throw this.Fa.cancel(),new Error(`Invalid bundle format: ${e}`)}async ka(){const e=await this.Fa.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class Dl{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new xo(Do.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const t=await async function(e,t){const n=e,r=Vt(n.serializer)+"/documents",i={documents:t.map((e=>Lt(n.serializer,e)))},s=await n.yo("BatchGetDocuments",r,i,t.length),o=new Map;s.forEach((e=>{const t=function(e,t){return"found"in t?function(e,t){h(!!t.found);const n=jt(e,t.found.name),r=Dt(t.found.updateTime),i=t.found.createTime?Dt(t.found.createTime):Wo.min(),s=new Qa({mapValue:{fields:t.found.fields}});return Ya.newFoundDocument(n,r,i,s)}(e,t):"missing"in t?function(e,t){h(!!t.missing),h(!!t.readTime);const n=jt(e,t.missing),r=Dt(t.readTime);return Ya.newNoDocument(n,r)}(e,t):l()}(n.serializer,e);o.set(t.key.toString(),t)}));const a=[];return t.forEach((e=>{const t=o.get(e.toString());h(!!t),a.push(t)})),a}(this.datastore,e);return t.forEach((e=>this.recordVersion(e))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new Oc(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((e,t)=>{const n=Xo.fromPath(t);this.mutations.push(new Ac(n,this.precondition(n)))})),await async function(e,t){const n=e,r=Vt(n.serializer)+"/documents",i={writes:t.map((e=>Kt(n.serializer,e)))};await n.Vo("Commit",r,i)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw l();t=Wo.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new xo(Do.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Wo.min())?Ec.exists(!1):Ec.updateTime(t):Ec.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Wo.min()))throw new xo(Do.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ec.updateTime(t)}return Ec.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class xl{constructor(e,t,n,r,i){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=r,this.deferred=i,this.qa=n.maxAttempts,this.Ko=new il(this.asyncQueue,"transaction_retry")}run(){this.qa-=1,this.Qa()}Qa(){var e=this;this.Ko.xo((async function(){const t=new Dl(e.datastore),n=e.Ka(t);n&&n.then((n=>{e.asyncQueue.enqueueAndForget((()=>t.commit().then((()=>{e.deferred.resolve(n)})).catch((t=>{e.$a(t)}))))})).catch((t=>{e.$a(t)}))}))}Ka(e){try{const t=this.updateFunction(e);return!C(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}$a(e){this.qa>0&&this.Ua(e)?(this.qa-=1,this.asyncQueue.enqueueAndForget((()=>(this.Qa(),Promise.resolve())))):this.deferred.reject(e)}Ua(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!It(t)}return!1}}class Ml{constructor(e,t,n,r){var i=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=No.UNAUTHENTICATED,this.clientId=Ko.V(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async function(e){o("FirestoreClient","Received user=",e.uid),await i.authCredentialListener(e),i.user=e})),this.appCheckCredentials.start(n,(e=>(o("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new xo(Do.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new Mo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async function(){try{e._onlineComponents&&await e._onlineComponents.terminate(),e._offlineComponents&&await e._offlineComponents.terminate(),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=Jr(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}const Ll=new Map;class jl{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new xo(Do.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new xo(Do.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Yi("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!this.experimentalForceLongPolling&&(void 0===e.experimentalAutoDetectLongPolling||!!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=Hi(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new xo(Do.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new xo(Do.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new xo(Do.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Fl{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new jl({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new xo(Do.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new xo(Do.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new jl(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new jo;switch(e.type){case"firstParty":return new qo(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new xo(Do.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Ll.get(e);t&&(o("ComponentProvider","Removing Datastore"),Ll.delete(e),t.terminate())}(this),Promise.resolve()}}class Ul{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Ul(this.firestore,e,this._query)}}class Vl{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ql(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Vl(this.firestore,e,this._key)}}class ql extends Ul{constructor(e,t,n){super(e,t,De(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Vl(this.firestore,null,new Xo(e))}withConverter(e){return new ql(this.firestore,e,this._path)}}class Bl{constructor(){this.Wa=Promise.resolve(),this.Ga=[],this.za=!1,this.ja=[],this.Ha=null,this.Ja=!1,this.Ya=!1,this.Za=[],this.Ko=new il(this,"async_queue_retry"),this.Xa=()=>{const e=Ir();e&&o("AsyncQueue","Visibility state changed to "+e.visibilityState),this.Ko.No()};const e=Ir();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Xa)}get isShuttingDown(){return this.za}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.eu(),this.tu(e)}enterRestrictedMode(e){if(!this.za){this.za=!0,this.Ya=e||!1;const t=Ir();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Xa)}}enqueue(e){if(this.eu(),this.za)return new Promise((()=>{}));const t=new Mo;return this.tu((()=>this.za&&this.Ya?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Ga.push(e),this.nu())))}async nu(){if(0!==this.Ga.length){try{await this.Ga[0](),this.Ga.shift(),this.Ko.reset()}catch(e){if(!T(e))throw e;o("AsyncQueue","Operation failed with retryable error: "+e)}this.Ga.length>0&&this.Ko.xo((()=>this.nu()))}}tu(e){const t=this.Wa.then((()=>(this.Ja=!0,e().catch((e=>{this.Ha=e,this.Ja=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw a("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.Ja=!1,e))))));return this.Wa=t,t}enqueueAfterDelay(e,t,n){this.eu(),this.Za.indexOf(e)>-1&&(t=0);const r=hl.createAndSchedule(this,e,t,n,(e=>this.ru(e)));return this.ja.push(r),r}eu(){this.Ha&&l()}verifyOperationInProgress(){}async iu(){let e;do{e=this.Wa,await e}while(e!==this.Wa)}su(e){for(const t of this.ja)if(t.timerId===e)return!0;return!1}ou(e){return this.iu().then((()=>{this.ja.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.ja)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.iu()}))}_u(e){this.Za.push(e)}ru(e){const t=this.ja.indexOf(e);this.ja.splice(t,1)}}class zl{constructor(){this._progressObserver={},this._taskCompletionResolver=new Mo,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}const Kl=-1;class $l extends Fl{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Bl,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||hs(this),this._firestoreClient.terminate()}}class Wl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Wl(za.fromBase64String(e))}catch(e){throw new xo(Do.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Wl(za.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Gl{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new xo(Do.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Yo(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Hl{constructor(e){this._methodName=e}}class Ql{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new xo(Do.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new xo(Do.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return p(this._lat,e._lat)||p(this._long,e._long)}}const Yl=/^__.*__$/;class Xl{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Sc(e,this.data,this.fieldMask,t,this.fieldTransforms):new Cc(e,this.data,t,this.fieldTransforms)}}class Jl{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Sc(e,this.data,this.fieldMask,t,this.fieldTransforms)}}class Zl{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.au(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get uu(){return this.settings.uu}cu(e){return new Zl(r(r({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}lu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.cu({path:n,hu:!1});return r.Pu(e),r}Iu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.cu({path:n,hu:!1});return r.au(),r}Tu(e){return this.cu({path:void 0,hu:!0})}Eu(e){return Ms(e,this.settings.methodName,this.settings.du||!1,this.path,this.settings.Au)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}au(){if(this.path)for(let e=0;e<this.path.length;e++)this.Pu(this.path.get(e))}Pu(e){if(0===e.length)throw this.Eu("Document fields must not be empty");if(Is(this.uu)&&Yl.test(e))throw this.Eu('Document fields cannot begin and end with "__"')}}class eh{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Tr(e)}Ru(e,t,n,r=!1){return new Zl({uu:e,methodName:t,Au:n,path:Yo.emptyPath(),hu:!1,du:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}class th extends Hl{_toFieldTransform(e){if(2!==e.uu)throw e.Eu(1===e.uu?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof th}}class nh extends Hl{_toFieldTransform(e){return new Ic(e.path,new yc)}isEqual(e){return e instanceof nh}}class rh extends Hl{constructor(e,t){super(e),this.Vu=t}_toFieldTransform(e){const t=ks(this,e,!0),n=this.Vu.map((e=>As(e,t))),r=new vc(n);return new Ic(e.path,r)}isEqual(e){return this===e}}class ih extends Hl{constructor(e,t){super(e),this.Vu=t}_toFieldTransform(e){const t=ks(this,e,!0),n=this.Vu.map((e=>As(e,t))),r=new wc(n);return new Ic(e.path,r)}isEqual(e){return this===e}}class sh extends Hl{constructor(e,t){super(e),this.mu=t}_toFieldTransform(e){const t=new bc(e.serializer,st(e.serializer,this.mu));return new Ic(e.path,t)}isEqual(e){return this===e}}const oh=new RegExp("[~\\*/\\[\\]]");class ah{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Vl(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new ch(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(js("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class ch extends ah{data(){return super.data()}}class uh{}class lh extends uh{}class hh extends lh{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new hh(e,t,n)}_apply(e){const t=this._parse(e);return Xs(e._query,t),new Ul(e.firestore,e.converter,Ve(e._query,t))}_parse(e){const t=Ts(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new xo(Do.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){Ys(o,s);const t=[];for(const n of o)t.push(Qs(r,e,n));a={arrayValue:{values:t}}}else a=Qs(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||Ys(o,s),a=Os(n,t,o,"in"===s||"not-in"===s);return ec.create(i,s,a)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class dh extends uh{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new dh(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:tc.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const e of r)Xs(n,e),n=Ve(n,e)}(e._query,t),new Ul(e.firestore,e.converter,Ve(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class fh extends lh{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new fh(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new xo(Do.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new xo(Do.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const r=new Ja(t,n);return function(e,t){if(null===Me(e)){const n=Le(e);null!==n&&Js(0,n,t.field)}}(e,r),r}(e._query,this._field,this._direction);return new Ul(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new lc(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}class ph extends lh{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new ph(e,t,n)}_apply(e){return new Ul(e.firestore,e.converter,qe(e._query,this._limit,this._limitType))}}class gh extends lh{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new gh(e,t,n)}_apply(e){const t=Hs(e,this.type,this._docOrFields,this._inclusive);return new Ul(e.firestore,e.converter,function(e,t){return new lc(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}class mh extends lh{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new mh(e,t,n)}_apply(e){const t=Hs(e,this.type,this._docOrFields,this._inclusive);return new Ul(e.firestore,e.converter,function(e,t){return new lc(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))}}class _h{convertValue(e,t="none"){switch(G(e)){case 0:return null;case 1:return e.booleanValue;case 2:return B(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(z(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw l()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return j(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertGeoPoint(e){return new Ql(B(e.latitude),B(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=$(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(W(e));default:return null}}convertTimestamp(e){const t=q(e);return new $o(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Ho.fromString(e);h(rn(n));const r=new Wa(n.get(1),n.get(3)),i=new Xo(n.popFirst(5));return r.isEqual(t)||a(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}class yh extends _h{constructor(e){super(),this.firestore=e}convertBytes(e){return new Wl(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Vl(this.firestore,null,t)}}class vh{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class wh extends ah{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new bh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(js("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class bh extends wh{data(e={}){return super.data(e)}}class Ih{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new vh(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new bh(this._firestore,this._userDataWriter,n.key,n,new vh(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new xo(Do.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>({type:"added",doc:new bh(e._firestore,e._userDataWriter,n.doc.key,n.doc,new vh(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter),oldIndex:-1,newIndex:t++})))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new bh(e._firestore,e._userDataWriter,t.doc.key,t.doc,new vh(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:eo(t.type),doc:r,oldIndex:i,newIndex:s}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}class Th extends _h{constructor(e){super(),this.firestore=e}convertBytes(e){return new Wl(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Vl(this.firestore,null,t)}}const Eh={maxAttempts:5};class kh{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Ts(e)}set(e,t,n){this._verifyNotCommitted();const r=_o(e,this._firestore),i=Zs(r.converter,t,n),s=Es(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(s.toMutation(r._key,Ec.none())),this}update(e,t,n,...r){this._verifyNotCommitted();const i=_o(e,this._firestore);let s;return s="string"==typeof(t=Object(So.z)(t))||t instanceof Gl?Ss(this._dataReader,"WriteBatch.update",i._key,t,n,r):Cs(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(s.toMutation(i._key,Ec.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=_o(e,this._firestore);return this._mutations=this._mutations.concat(new Oc(t._key,Ec.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new xo(Do.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}class Ch extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Ts(e)}get(e){const t=_o(e,this._firestore),n=new yh(this._firestore);return this._transaction.lookup([t._key]).then((e=>{if(!e||1!==e.length)return l();const r=e[0];if(r.isFoundDocument())return new ah(this._firestore,n,r.key,r,t.converter);if(r.isNoDocument())return new ah(this._firestore,n,t._key,null,t.converter);throw l()}))}set(e,t,n){const r=_o(e,this._firestore),i=Zs(r.converter,t,n),s=Es(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,s),this}update(e,t,n,...r){const i=_o(e,this._firestore);let s;return s="string"==typeof(t=Object(So.z)(t))||t instanceof Gl?Ss(this._dataReader,"Transaction.update",i._key,t,n,r):Cs(this._dataReader,"Transaction.update",i._key,t),this._transaction.update(i._key,s),this}delete(e){const t=_o(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=_o(e,this._firestore),n=new Th(this._firestore);return super.get(e).then((e=>new wh(this._firestore,n,t._key,e._document,new vh(!1,!1),t.converter)))}}!function(e,t=!0){!function(e){Po=e}(Eo.SDK_VERSION),Object(Eo._registerComponent)(new ko.a("firestore",((e,{instanceIdentifier:n,options:i})=>{const s=e.getProvider("app").getImmediate(),o=new $l(new Uo(e.getProvider("auth-internal")),new zo(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new xo(Do.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Wa(e.options.projectId,t)}(s,n),s);return i=r({useFetchStreams:t},i),o._setSettings(i),o}),"PUBLIC").setMultipleInstances(!0)),Object(Eo.registerVersion)(Ao,"4.1.0",e),Object(Eo.registerVersion)(Ao,"4.1.0","esm2017")}()}});
//# sourceMappingURL=bundle.a19ec.esm.js.map